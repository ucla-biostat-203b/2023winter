<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Hua Zhou @ UCLA">
<meta name="dcterms.date" content="2022-12-30">

<title>Linux Basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="linux_files/libs/clipboard/clipboard.min.js"></script>
<script src="linux_files/libs/quarto-html/quarto.js"></script>
<script src="linux_files/libs/quarto-html/popper.min.js"></script>
<script src="linux_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="linux_files/libs/quarto-html/anchor.min.js"></script>
<link href="linux_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="linux_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="linux_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="linux_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="linux_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#preface" id="toc-preface" class="nav-link active" data-scroll-target="#preface"><span class="toc-section-number">1</span>  Preface</a></li>
  <li><a href="#why-linux" id="toc-why-linux" class="nav-link" data-scroll-target="#why-linux"><span class="toc-section-number">2</span>  Why Linux</a></li>
  <li><a href="#distributions-of-linux" id="toc-distributions-of-linux" class="nav-link" data-scroll-target="#distributions-of-linux"><span class="toc-section-number">3</span>  Distributions of Linux</a></li>
  <li><a href="#linux-shells" id="toc-linux-shells" class="nav-link" data-scroll-target="#linux-shells"><span class="toc-section-number">4</span>  Linux shells</a>
  <ul>
  <li><a href="#shells" id="toc-shells" class="nav-link" data-scroll-target="#shells"><span class="toc-section-number">4.1</span>  Shells</a></li>
  <li><a href="#command-history-and-bash-completion" id="toc-command-history-and-bash-completion" class="nav-link" data-scroll-target="#command-history-and-bash-completion"><span class="toc-section-number">4.2</span>  Command history and bash completion</a></li>
  <li><a href="#man-is-mans-best-friend" id="toc-man-is-mans-best-friend" class="nav-link" data-scroll-target="#man-is-mans-best-friend"><span class="toc-section-number">4.3</span>  <code>man</code> is manâ€™s best friend</a></li>
  </ul></li>
  <li><a href="#navigate-file-system" id="toc-navigate-file-system" class="nav-link" data-scroll-target="#navigate-file-system"><span class="toc-section-number">5</span>  Navigate file system</a>
  <ul>
  <li><a href="#linux-directory-structure" id="toc-linux-directory-structure" class="nav-link" data-scroll-target="#linux-directory-structure"><span class="toc-section-number">5.1</span>  Linux directory structure</a></li>
  <li><a href="#move-around-the-file-system" id="toc-move-around-the-file-system" class="nav-link" data-scroll-target="#move-around-the-file-system"><span class="toc-section-number">5.2</span>  Move around the file system</a></li>
  <li><a href="#file-permissions" id="toc-file-permissions" class="nav-link" data-scroll-target="#file-permissions"><span class="toc-section-number">5.3</span>  File permissions</a></li>
  <li><a href="#manipulate-files-and-directories" id="toc-manipulate-files-and-directories" class="nav-link" data-scroll-target="#manipulate-files-and-directories"><span class="toc-section-number">5.4</span>  Manipulate files and directories</a></li>
  <li><a href="#find-files" id="toc-find-files" class="nav-link" data-scroll-target="#find-files"><span class="toc-section-number">5.5</span>  Find files</a></li>
  <li><a href="#wildcard-characters" id="toc-wildcard-characters" class="nav-link" data-scroll-target="#wildcard-characters"><span class="toc-section-number">5.6</span>  Wildcard characters</a></li>
  <li><a href="#regular-expression" id="toc-regular-expression" class="nav-link" data-scroll-target="#regular-expression"><span class="toc-section-number">5.7</span>  Regular expression</a></li>
  </ul></li>
  <li><a href="#work-with-text-files" id="toc-work-with-text-files" class="nav-link" data-scroll-target="#work-with-text-files"><span class="toc-section-number">6</span>  Work with text files</a>
  <ul>
  <li><a href="#viewpeek-text-files" id="toc-viewpeek-text-files" class="nav-link" data-scroll-target="#viewpeek-text-files"><span class="toc-section-number">6.1</span>  View/peek text files</a></li>
  <li><a href="#piping-and-redirection" id="toc-piping-and-redirection" class="nav-link" data-scroll-target="#piping-and-redirection"><span class="toc-section-number">6.2</span>  Piping and redirection</a></li>
  <li><a href="#less-is-more-more-is-less" id="toc-less-is-more-more-is-less" class="nav-link" data-scroll-target="#less-is-more-more-is-less"><span class="toc-section-number">6.3</span>  <code>less</code> is more; <code>more</code> is less</a></li>
  <li><a href="#grep" id="toc-grep" class="nav-link" data-scroll-target="#grep"><span class="toc-section-number">6.4</span>  <code>grep</code></a></li>
  <li><a href="#sed" id="toc-sed" class="nav-link" data-scroll-target="#sed"><span class="toc-section-number">6.5</span>  <code>sed</code></a></li>
  <li><a href="#awk" id="toc-awk" class="nav-link" data-scroll-target="#awk"><span class="toc-section-number">6.6</span>  <code>awk</code></a></li>
  <li><a href="#text-editors" id="toc-text-editors" class="nav-link" data-scroll-target="#text-editors"><span class="toc-section-number">6.7</span>  Text editors</a>
  <ul class="collapse">
  <li><a href="#emacs" id="toc-emacs" class="nav-link" data-scroll-target="#emacs"><span class="toc-section-number">6.7.1</span>  Emacs</a></li>
  <li><a href="#vi" id="toc-vi" class="nav-link" data-scroll-target="#vi"><span class="toc-section-number">6.7.2</span>  Vi</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#ide-integrated-development-environment" id="toc-ide-integrated-development-environment" class="nav-link" data-scroll-target="#ide-integrated-development-environment"><span class="toc-section-number">7</span>  IDE (Integrated Development Environment)</a></li>
  <li><a href="#processes" id="toc-processes" class="nav-link" data-scroll-target="#processes"><span class="toc-section-number">8</span>  Processes</a>
  <ul>
  <li><a href="#cancel-a-non-responding-program" id="toc-cancel-a-non-responding-program" class="nav-link" data-scroll-target="#cancel-a-non-responding-program"><span class="toc-section-number">8.1</span>  Cancel a non-responding program</a></li>
  <li><a href="#processes-1" id="toc-processes-1" class="nav-link" data-scroll-target="#processes-1"><span class="toc-section-number">8.2</span>  Processes</a></li>
  <li><a href="#kill-processes" id="toc-kill-processes" class="nav-link" data-scroll-target="#kill-processes"><span class="toc-section-number">8.3</span>  Kill processes</a></li>
  <li><a href="#top" id="toc-top" class="nav-link" data-scroll-target="#top"><span class="toc-section-number">8.4</span>  <code>top</code></a></li>
  </ul></li>
  <li><a href="#secure-shell-ssh" id="toc-secure-shell-ssh" class="nav-link" data-scroll-target="#secure-shell-ssh"><span class="toc-section-number">9</span>  Secure shell (SSH)</a>
  <ul>
  <li><a href="#ssh" id="toc-ssh" class="nav-link" data-scroll-target="#ssh"><span class="toc-section-number">9.1</span>  SSH</a></li>
  <li><a href="#advantages-of-keys-over-password" id="toc-advantages-of-keys-over-password" class="nav-link" data-scroll-target="#advantages-of-keys-over-password"><span class="toc-section-number">9.2</span>  Advantages of keys over password</a></li>
  <li><a href="#key-authentication" id="toc-key-authentication" class="nav-link" data-scroll-target="#key-authentication"><span class="toc-section-number">9.3</span>  Key authentication</a></li>
  <li><a href="#steps-to-generate-keys" id="toc-steps-to-generate-keys" class="nav-link" data-scroll-target="#steps-to-generate-keys"><span class="toc-section-number">9.4</span>  Steps to generate keys</a></li>
  <li><a href="#transfer-files-between-machines" id="toc-transfer-files-between-machines" class="nav-link" data-scroll-target="#transfer-files-between-machines"><span class="toc-section-number">9.5</span>  Transfer files between machines</a></li>
  <li><a href="#line-breaks-in-text-files" id="toc-line-breaks-in-text-files" class="nav-link" data-scroll-target="#line-breaks-in-text-files"><span class="toc-section-number">9.6</span>  Line breaks in text files</a></li>
  </ul></li>
  <li><a href="#run-r-in-linux" id="toc-run-r-in-linux" class="nav-link" data-scroll-target="#run-r-in-linux"><span class="toc-section-number">10</span>  Run R in Linux</a>
  <ul>
  <li><a href="#interactive-mode" id="toc-interactive-mode" class="nav-link" data-scroll-target="#interactive-mode"><span class="toc-section-number">10.1</span>  Interactive mode</a></li>
  <li><a href="#batch-mode" id="toc-batch-mode" class="nav-link" data-scroll-target="#batch-mode"><span class="toc-section-number">10.2</span>  Batch mode</a></li>
  <li><a href="#pass-arguments-to-r-scripts" id="toc-pass-arguments-to-r-scripts" class="nav-link" data-scroll-target="#pass-arguments-to-r-scripts"><span class="toc-section-number">10.3</span>  Pass arguments to R scripts</a></li>
  <li><a href="#run-long-jobs" id="toc-run-long-jobs" class="nav-link" data-scroll-target="#run-long-jobs"><span class="toc-section-number">10.4</span>  Run long jobs</a></li>
  <li><a href="#screen" id="toc-screen" class="nav-link" data-scroll-target="#screen"><span class="toc-section-number">10.5</span>  screen</a></li>
  <li><a href="#use-r-to-call-r" id="toc-use-r-to-call-r" class="nav-link" data-scroll-target="#use-r-to-call-r"><span class="toc-section-number">10.6</span>  Use R to call R</a></li>
  </ul></li>
  <li><a href="#some-other-linux-commands" id="toc-some-other-linux-commands" class="nav-link" data-scroll-target="#some-other-linux-commands"><span class="toc-section-number">11</span>  Some other Linux commands</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Linux Basics</h1>
<p class="subtitle lead">Biostat 203B</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr.&nbsp;Hua Zhou @ UCLA </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 30, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>Display machine information for reproducibility:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
 [1] digest_0.6.31     lifecycle_1.0.3   jsonlite_1.8.4    magrittr_2.0.3   
 [5] evaluate_0.19     rlang_1.0.6       stringi_1.7.8     cli_3.5.0        
 [9] rstudioapi_0.14   vctrs_0.5.1       rmarkdown_2.19    tools_4.2.2      
[13] stringr_1.5.0     glue_1.6.2        htmlwidgets_1.6.0 xfun_0.35        
[17] yaml_2.3.6        fastmap_1.1.0     compiler_4.2.2    htmltools_0.5.4  
[21] knitr_1.41       </code></pre>
</div>
</div>
<section id="preface" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="preface"><span class="header-section-number">1</span> Preface</h2>
<ul>
<li>This html is rendered from <code>linux.qmd</code> on Linux Ubuntu 22.04 (jammy).
<ul>
<li><p>Mac users can render <code>linux.qmd</code> directly. Some tools such as <code>tree</code> and <code>locate</code> need to be installed (follow the error messages).</p></li>
<li><p>Windows users need to install WSL (Windows Subsystem for Linux) to render <code>linux.qmd</code> using Ubuntu. Some tools such as <code>tree</code> and <code>locate</code> need to be installed (follow the error messages).</p></li>
<li><p>Both Mac and Windows users can also use Docker to render <code>linux.qmd</code> within a Ubuntu container.</p></li>
</ul></li>
<li>In this lecture, most code chunks are <code>bash</code> commands instead of R code.</li>
</ul>
</section>
<section id="why-linux" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="why-linux"><span class="header-section-number">2</span> Why Linux</h2>
<p>Linux is <em>the</em> most common platform for scientific computing and deployment of data science tools.</p>
<ul>
<li><p>Open source and community support.</p></li>
<li><p>Things break; when they break using Linux, itâ€™s easy to fix.</p></li>
<li><p>Scalability: portable devices (Android, iOS), laptops, servers, clusters, and super computers.</p>
<ul>
<li>E.g. UCLA Hoffmann2 cluster runs on Linux; most machines in cloud (AWS, Azure, GCP) run on Linux.<br>
</li>
</ul></li>
<li><p>Cost: itâ€™s free!</p></li>
</ul>
</section>
<section id="distributions-of-linux" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="distributions-of-linux"><span class="header-section-number">3</span> <a href="http://upload.wikimedia.org/wikipedia/commons/1/1b/Linux_Distribution_Timeline.svg">Distributions of Linux</a></h2>
<ul>
<li><p>Debian/Ubuntu is a popular choice for personal computers.</p></li>
<li><p>RHEL/CentOS is popular on servers. (In December 2020, Red Hat terminated the development of CentOS Linux distribution.)</p></li>
</ul>
<p align="center">
<img src="./redhat_kills_centos.png" height="200" width="300">
</p>
<ul>
<li><p>UCLA Hoffman2 cluster runs CentOS 7.9.2009 (as of 2023-01-01).</p></li>
<li><p>MacOS was originally derived from Unix/Linux (Darwin kernel). It is POSIX compliant. Most shell commands we review here apply to MacOS terminal as well. Windows/DOS, unfortunately, is a totally different breed.</p></li>
<li><p>Show operating system (OS) type:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$OSTYPE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>linux-gnu</code></pre>
</div>
</div>
<ul>
<li>Show distribution/version on Linux:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only on Linux terminal</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> /etc/<span class="pp">*</span>-release</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=22.04
DISTRIB_CODENAME=jammy
DISTRIB_DESCRIPTION="Ubuntu 22.04.1 LTS"
PRETTY_NAME="Ubuntu 22.04.1 LTS"
NAME="Ubuntu"
VERSION_ID="22.04"
VERSION="22.04.1 LTS (Jammy Jellyfish)"
VERSION_CODENAME=jammy
ID=ubuntu
ID_LIKE=debian
HOME_URL="https://www.ubuntu.com/"
SUPPORT_URL="https://help.ubuntu.com/"
BUG_REPORT_URL="https://bugs.launchpad.net/ubuntu/"
PRIVACY_POLICY_URL="https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"
UBUNTU_CODENAME=jammy</code></pre>
</div>
</div>
<ul>
<li>Show distribution/version on MacOS:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only on Mac terminal</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">sw_vers</span> <span class="at">-productVersion</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># only on Mac terminal</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">system_profiler</span> SPSoftwareDataType</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="linux-shells" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="linux-shells"><span class="header-section-number">4</span> Linux shells</h2>
<section id="shells" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="shells"><span class="header-section-number">4.1</span> Shells</h3>
<ul>
<li><p>A shell translates commands to OS instructions.</p></li>
<li><p>Most commonly used shells include <code>bash</code>, <code>csh</code>, <code>tcsh</code>, <code>zsh</code>, etc.</p></li>
<li><p>The default shell in MacOS changed from <code>bash</code> to <code>zsh</code> since MacOS v10.15.</p></li>
<li><p>Sometimes a command and a script does not run simply because itâ€™s written for another shell.</p></li>
<li><p>We mostly use <code>bash</code> shell commands in this class.</p></li>
<li><p>Determine the current shell:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$SHELL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/bin/bash</code></pre>
</div>
</div>
<ul>
<li>List available shells:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> /etc/shells</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># /etc/shells: valid login shells
/bin/sh
/bin/bash
/usr/bin/bash
/bin/rbash
/usr/bin/rbash
/usr/bin/sh
/bin/dash
/usr/bin/dash</code></pre>
</div>
</div>
<ul>
<li>Change to another shell:</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{bash}</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span> bash <span class="at">-l</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>-l</code> option indicates it should be a login shell.</p>
<ul>
<li>Change your login shell permanently:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chsh</span> <span class="at">-s</span> /bin/bash [USERNAME]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then log out and log in.</p>
</section>
<section id="command-history-and-bash-completion" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="command-history-and-bash-completion"><span class="header-section-number">4.2</span> Command history and bash completion</h3>
<p>We can navigate to previous/next commands by the upper and lower keys, or maintain a command history stack using <code>pushd</code> and <code>popd</code> commands.</p>
<p>Bash provides the following standard completion for the Linux users by default. Much less typing errors and time!</p>
<ul>
<li><p>Pathname completion.</p></li>
<li><p>Filename completion.</p></li>
<li><p>Variablename completion: <code>echo $[TAB][TAB]</code>.</p></li>
<li><p>Username completion: <code>cd ~[TAB][TAB]</code>.</p></li>
<li><p>Hostname completion <code>ssh huazhou@[TAB][TAB]</code>.</p></li>
<li><p>It can also be customized to auto-complete other stuff such as options and commandâ€™s arguments. Google <code>bash completion</code> for more information.</p></li>
</ul>
</section>
<section id="man-is-mans-best-friend" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="man-is-mans-best-friend"><span class="header-section-number">4.3</span> <code>man</code> is manâ€™s best friend</h3>
<p>Online help for shell commands: <code>man [COMMANDNAME]</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display the first 30 lines of documentation for the ls command</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">man</span> ls <span class="kw">|</span> <span class="fu">head</span> <span class="at">-30</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, including manpages, you can run the 'unminimize'
command. You will still need to ensure the 'man-db' package is installed.</code></pre>
</div>
</div>
</section>
</section>
<section id="navigate-file-system" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="navigate-file-system"><span class="header-section-number">5</span> Navigate file system</h2>
<section id="linux-directory-structure" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="linux-directory-structure"><span class="header-section-number">5.1</span> Linux directory structure</h3>
<p align="center">
<img src="./linux_directory_structure.png" height="400" width="600">
</p>
<ul>
<li><p>Upon log in, user is at his/her home directory.</p></li>
<li><p><code>tree</code> command (if installed) displays directory structure.<br>
<code>tree -L levels</code> display levels directories deep.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display only directories in levels 1, 2 from root directory</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="ex">tree</span> <span class="at">-d</span> <span class="at">-L</span> 1 /</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[01;34m/[0m
â”œâ”€â”€ [01;36mbin[0m -&gt; [01;34musr/bin[0m
â”œâ”€â”€ [01;34mboot[0m
â”œâ”€â”€ [01;34mdev[0m
â”œâ”€â”€ [01;34metc[0m
â”œâ”€â”€ [01;34mhome[0m
â”œâ”€â”€ [01;36mlib[0m -&gt; [01;34musr/lib[0m
â”œâ”€â”€ [01;36mlib32[0m -&gt; [01;34musr/lib32[0m
â”œâ”€â”€ [01;36mlib64[0m -&gt; [01;34musr/lib64[0m
â”œâ”€â”€ [01;34mlibexec[0m
â”œâ”€â”€ [01;36mlibx32[0m -&gt; [01;34musr/libx32[0m
â”œâ”€â”€ [01;34mmedia[0m
â”œâ”€â”€ [01;34mmnt[0m
â”œâ”€â”€ [01;34mopt[0m
â”œâ”€â”€ [01;34mproc[0m
â”œâ”€â”€ [01;34mrocker_scripts[0m
â”œâ”€â”€ [01;34mroot[0m
â”œâ”€â”€ [01;34mrun[0m
â”œâ”€â”€ [01;36msbin[0m -&gt; [01;34musr/sbin[0m
â”œâ”€â”€ [01;34msrv[0m
â”œâ”€â”€ [01;34msys[0m
â”œâ”€â”€ [01;34mtmp[0m
â”œâ”€â”€ [01;34musr[0m
â””â”€â”€ [01;34mvar[0m

23 directories</code></pre>
</div>
</div>
</section>
<section id="move-around-the-file-system" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="move-around-the-file-system"><span class="header-section-number">5.2</span> Move around the file system</h3>
<ul>
<li>Where am I? <code>pwd</code> prints absolute path to the current working directory:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">pwd</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/home/rstudio/203b-lecture/slides/02-linux</code></pre>
</div>
</div>
<ul>
<li>Whatâ€™s in the current director? <code>ls</code> lists contents of a directory:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>autoSim.R
Emacs_Reference_Card.pdf
IDRE_Winter_2019_Workshops.pdf
key_authentication_1.png
key_authentication_2.png
linux_directory_structure.png
linux_filepermission_oct.png
linux_filepermission.png
linux_files
linux.html
linux.qmd
linux.rmarkdown
linux.Rmd
meanEst.R
redhat_kills_centos.png
Richard_Stallman_2013.png
runSim.R
screenshot_top.png
Vi_Cheat_Sheet.pdf</code></pre>
</div>
</div>
<ul>
<li><code>ls -l</code> lists detailed contents of a directory:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-l</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>total 2636
-rw-r--r-- 1 rstudio rstudio    258 Jan 16  2020 autoSim.R
-rw-r--r-- 1 rstudio rstudio 110345 Jan 11  2015 Emacs_Reference_Card.pdf
-rw-r--r-- 1 rstudio rstudio 157353 Jan  4  2019 IDRE_Winter_2019_Workshops.pdf
-rw-r--r-- 1 rstudio rstudio 321281 Jan 10  2018 key_authentication_1.png
-rw-r--r-- 1 rstudio rstudio  96119 Jan  9  2018 key_authentication_2.png
-rw-r--r-- 1 rstudio rstudio  11662 Jan  8  2018 linux_directory_structure.png
-rw-r--r-- 1 rstudio rstudio  42472 Jan  7  2015 linux_filepermission_oct.png
-rw-r--r-- 1 rstudio rstudio 102188 Jan  9  2018 linux_filepermission.png
drwxr-xr-x 3 rstudio rstudio     96 Dec 30 08:16 linux_files
-rw-r--r-- 1 rstudio rstudio 285980 Dec 30 08:16 linux.html
-rw-r--r-- 1 rstudio rstudio  24072 Dec 30 08:17 linux.qmd
-rw-r--r-- 1 rstudio rstudio  24209 Dec 30 08:17 linux.rmarkdown
-rw-r--r-- 1 rstudio rstudio  24684 Dec 11 06:29 linux.Rmd
-rw-r--r-- 1 rstudio rstudio    381 Jan 15  2019 meanEst.R
-rw-r--r-- 1 rstudio rstudio 437112 Jan  5  2021 redhat_kills_centos.png
-rw-r--r-- 1 rstudio rstudio 141962 Jan  6  2015 Richard_Stallman_2013.png
-rw-r--r-- 1 rstudio rstudio    498 Jan 11  2018 runSim.R
-rw-r--r-- 1 rstudio rstudio 685657 Jan 12  2022 screenshot_top.png
-rw-r--r-- 1 rstudio rstudio 199492 Jan 11  2015 Vi_Cheat_Sheet.pdf</code></pre>
</div>
</div>
<ul>
<li><code>ls -al</code> lists all contents of a directory, including those start with <code>.</code> (hidden folders):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-al</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>total 2652
drwxr-xr-x 24 rstudio rstudio    768 Dec 30 08:17 .
drwxr-xr-x 22 rstudio rstudio    704 Mar  9  2022 ..
-rw-r--r--  1 rstudio rstudio    258 Jan 16  2020 autoSim.R
-rw-r--r--  1 rstudio rstudio   8196 Dec 11 06:31 .DS_Store
-rw-r--r--  1 rstudio rstudio 110345 Jan 11  2015 Emacs_Reference_Card.pdf
-rw-r--r--  1 rstudio rstudio 157353 Jan  4  2019 IDRE_Winter_2019_Workshops.pdf
-rw-r--r--  1 rstudio rstudio 321281 Jan 10  2018 key_authentication_1.png
-rw-r--r--  1 rstudio rstudio  96119 Jan  9  2018 key_authentication_2.png
-rw-r--r--  1 rstudio rstudio  11662 Jan  8  2018 linux_directory_structure.png
-rw-r--r--  1 rstudio rstudio  42472 Jan  7  2015 linux_filepermission_oct.png
-rw-r--r--  1 rstudio rstudio 102188 Jan  9  2018 linux_filepermission.png
drwxr-xr-x  3 rstudio rstudio     96 Dec 30 08:16 linux_files
-rw-r--r--  1 rstudio rstudio 285980 Dec 30 08:16 linux.html
-rw-r--r--  1 rstudio rstudio  24072 Dec 30 08:17 linux.qmd
-rw-r--r--  1 rstudio rstudio  24209 Dec 30 08:17 linux.rmarkdown
-rw-r--r--  1 rstudio rstudio  24684 Dec 11 06:29 linux.Rmd
-rw-r--r--  1 rstudio rstudio    381 Jan 15  2019 meanEst.R
-rw-r--r--  1 rstudio rstudio   4084 Dec 30 08:16 .RData
-rw-r--r--  1 rstudio rstudio 437112 Jan  5  2021 redhat_kills_centos.png
-rw-r--r--  1 rstudio rstudio      0 Jan  8  2019 .Rhistory
-rw-r--r--  1 rstudio rstudio 141962 Jan  6  2015 Richard_Stallman_2013.png
-rw-r--r--  1 rstudio rstudio    498 Jan 11  2018 runSim.R
-rw-r--r--  1 rstudio rstudio 685657 Jan 12  2022 screenshot_top.png
-rw-r--r--  1 rstudio rstudio 199492 Jan 11  2015 Vi_Cheat_Sheet.pdf</code></pre>
</div>
</div>
<ul>
<li><p><code>..</code> denotes the parent of current working directory.</p></li>
<li><p><code>.</code> denotes the current working directory.</p></li>
<li><p><code>~</code> denotes userâ€™s home directory.</p></li>
<li><p><code>/</code> denotes the root directory.</p></li>
<li><p><code>cd ..</code> changes to parent directory.</p></li>
<li><p><code>cd</code> or <code>cd ~</code> changes to home directory.</p></li>
<li><p><code>cd /</code> changes to root directory.</p></li>
</ul>
<!-- 
- `pushd` changes the working directory but pushes the current directory into a stack.

- `popd` changes the working directory to the last directory added to the stack.
-->
</section>
<section id="file-permissions" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="file-permissions"><span class="header-section-number">5.3</span> File permissions</h3>
<p align="center">
<img src="./linux_filepermission.png" height="125">
</p>
<p align="center">
<img src="./linux_filepermission_oct.png" height="250">
</p>
<ul>
<li><p><code>chmod g+x file</code> makes a file executable to group members.</p></li>
<li><p><code>chmod 751 file</code> sets permission <code>rwxr-x--x</code> to a file.</p></li>
<li><p><code>groups [USERNAME]</code> shows which group(s) a user belongs to:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">groups</span> <span class="va">$USER</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rstudio : rstudio sudo staff</code></pre>
</div>
</div>
</section>
<section id="manipulate-files-and-directories" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="manipulate-files-and-directories"><span class="header-section-number">5.4</span> Manipulate files and directories</h3>
<ul>
<li><p><code>cp</code> copies file to a new location.</p></li>
<li><p><code>mv</code> moves file to a new location.</p></li>
<li><p><code>touch</code> creates a text file; if file already exists, itâ€™s left unchanged.</p></li>
<li><p><code>rm</code> deletes a file.</p></li>
<li><p><code>mkdir</code> creates a new directory.</p></li>
<li><p><code>rmdir</code> deletes an <em>empty</em> directory.</p></li>
<li><p><code>rm -rf</code> deletes a directory and all contents in that directory (be cautious using the <code>-f</code> option â€¦).</p></li>
</ul>
</section>
<section id="find-files" class="level3" data-number="5.5">
<h3 data-number="5.5" class="anchored" data-anchor-id="find-files"><span class="header-section-number">5.5</span> Find files</h3>
<ul>
<li><code>locate</code> locates a file by name (need <code>mlocate</code> program installed):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">locate</span> linux.qmd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>find</code> is similar to <code>locate</code> but has more functionalities, e.g., select files by age, size, permissions, â€¦. , and is ubiquitous.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># search within current folder</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span> linux.qmd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>linux.qmd</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># search within the parent folder</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span> .. <span class="at">-name</span> linux.qmd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>../02-linux/linux.qmd</code></pre>
</div>
</div>
<ul>
<li><code>which</code> locates a program (executable file):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span> R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/usr/local/bin/R</code></pre>
</div>
</div>
</section>
<section id="wildcard-characters" class="level3" data-number="5.6">
<h3 data-number="5.6" class="anchored" data-anchor-id="wildcard-characters"><span class="header-section-number">5.6</span> Wildcard characters</h3>
<table class="table">
<thead>
<tr class="header">
<th>Wildcard</th>
<th>Matches</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>?</code></td>
<td>any single character</td>
</tr>
<tr class="even">
<td><code>*</code></td>
<td>any character 0 or more times</td>
</tr>
<tr class="odd">
<td><code>+</code></td>
<td>one or more preceding pattern</td>
</tr>
<tr class="even">
<td><code>^</code></td>
<td>beginning of the line</td>
</tr>
<tr class="odd">
<td><code>$</code></td>
<td>end of the line</td>
</tr>
<tr class="even">
<td><code>[set]</code></td>
<td>any character in set</td>
</tr>
<tr class="odd">
<td><code>[!set]</code></td>
<td>any character not in set</td>
</tr>
<tr class="even">
<td><code>[a-z]</code></td>
<td>any lowercase letter</td>
</tr>
<tr class="odd">
<td><code>[0-9]</code></td>
<td>any number (same as <code>[0123456789]</code>)</td>
</tr>
</tbody>
</table>
<ul>
<li></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all png files in current folder</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-l</span> <span class="pp">*</span>.png</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-rw-r--r-- 1 rstudio rstudio 321281 Jan 10  2018 key_authentication_1.png
-rw-r--r-- 1 rstudio rstudio  96119 Jan  9  2018 key_authentication_2.png
-rw-r--r-- 1 rstudio rstudio  11662 Jan  8  2018 linux_directory_structure.png
-rw-r--r-- 1 rstudio rstudio  42472 Jan  7  2015 linux_filepermission_oct.png
-rw-r--r-- 1 rstudio rstudio 102188 Jan  9  2018 linux_filepermission.png
-rw-r--r-- 1 rstudio rstudio 437112 Jan  5  2021 redhat_kills_centos.png
-rw-r--r-- 1 rstudio rstudio 141962 Jan  6  2015 Richard_Stallman_2013.png
-rw-r--r-- 1 rstudio rstudio 685657 Jan 12  2022 screenshot_top.png</code></pre>
</div>
</div>
</section>
<section id="regular-expression" class="level3" data-number="5.7">
<h3 data-number="5.7" class="anchored" data-anchor-id="regular-expression"><span class="header-section-number">5.7</span> Regular expression</h3>
<ul>
<li><p>Wildcards are examples of <em>regular expressions</em>.</p></li>
<li><p>Regular expressions are a powerful tool to efficiently sift through large amounts of text: record linking, data cleaning, scraping data from website or other data-feed.</p></li>
<li><p>Google <code>regular expressions</code> to learn.</p></li>
</ul>
</section>
</section>
<section id="work-with-text-files" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="work-with-text-files"><span class="header-section-number">6</span> Work with text files</h2>
<section id="viewpeek-text-files" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="viewpeek-text-files"><span class="header-section-number">6.1</span> View/peek text files</h3>
<ul>
<li><code>cat</code> prints the contents of a file:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> runSim.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## parsing command arguments
for (arg in commandArgs(TRUE)) {
  eval(parse(text=arg))
}

## check if a given integer is prime
isPrime = function(n) {
  if (n &lt;= 3) {
    return (TRUE)
  }
  if (any((n %% 2:floor(sqrt(n))) == 0)) {
    return (FALSE)
  }
  return (TRUE)
}

## estimate mean only using observation with prime indices
estMeanPrimes = function (x) {
  n = length(x)
  ind = sapply(1:n, isPrime)
  return (mean(x[ind]))
}

# simulate data
x = rnorm(n)

# estimate mean
estMeanPrimes(x)</code></pre>
</div>
</div>
<ul>
<li><code>head</code> prints the first 10 lines of a file:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> runSim.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## parsing command arguments
for (arg in commandArgs(TRUE)) {
  eval(parse(text=arg))
}

## check if a given integer is prime
isPrime = function(n) {
  if (n &lt;= 3) {
    return (TRUE)
  }</code></pre>
</div>
</div>
<p><code>head -l</code> prints the first <span class="math inline">\(l\)</span> lines of a file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> <span class="at">-15</span> runSim.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## parsing command arguments
for (arg in commandArgs(TRUE)) {
  eval(parse(text=arg))
}

## check if a given integer is prime
isPrime = function(n) {
  if (n &lt;= 3) {
    return (TRUE)
  }
  if (any((n %% 2:floor(sqrt(n))) == 0)) {
    return (FALSE)
  }
  return (TRUE)
}</code></pre>
</div>
</div>
<ul>
<li><code>tail</code> prints the last 10 lines of a file:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span> runSim.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  n = length(x)
  ind = sapply(1:n, isPrime)
  return (mean(x[ind]))
}

# simulate data
x = rnorm(n)

# estimate mean
estMeanPrimes(x)</code></pre>
</div>
</div>
<p><code>tail -l</code> prints the last <span class="math inline">\(l\)</span> lines of a file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span> <span class="at">-15</span> runSim.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  return (TRUE)
}

## estimate mean only using observation with prime indices
estMeanPrimes = function (x) {
  n = length(x)
  ind = sapply(1:n, isPrime)
  return (mean(x[ind]))
}

# simulate data
x = rnorm(n)

# estimate mean
estMeanPrimes(x)</code></pre>
</div>
</div>
<ul>
<li>Questions:
<ul>
<li>How to see the 11th line of the file and nothing else?<br>
</li>
<li>What about the 11th to the last line?</li>
</ul></li>
</ul>
</section>
<section id="piping-and-redirection" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="piping-and-redirection"><span class="header-section-number">6.2</span> Piping and redirection</h3>
<ul>
<li><code>|</code> sends output from one command as input of another command.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-l</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>total 2636
-rw-r--r-- 1 rstudio rstudio    258 Jan 16  2020 autoSim.R
-rw-r--r-- 1 rstudio rstudio 110345 Jan 11  2015 Emacs_Reference_Card.pdf
-rw-r--r-- 1 rstudio rstudio 157353 Jan  4  2019 IDRE_Winter_2019_Workshops.pdf
-rw-r--r-- 1 rstudio rstudio 321281 Jan 10  2018 key_authentication_1.png</code></pre>
</div>
</div>
<ul>
<li><p><code>&gt;</code> directs output from one command to a file.</p></li>
<li><p><code>&gt;&gt;</code> appends output from one command to a file.</p></li>
<li><p><code>&lt;</code> reads input from a file.</p></li>
<li><p>Combinations of shell commands (<code>grep</code>, <code>sed</code>, <code>awk</code>, â€¦), piping and redirection, and regular expressions allow us pre-process and reformat huge text files efficiently.</p></li>
<li><p>See HW1.</p></li>
</ul>
</section>
<section id="less-is-more-more-is-less" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="less-is-more-more-is-less"><span class="header-section-number">6.3</span> <code>less</code> is more; <code>more</code> is less</h3>
<ul>
<li><p><code>more</code> browses a text file screen by screen (only downwards). Scroll down one page (paging) by pressing the spacebar; exit by pressing the <code>q</code> key.</p></li>
<li><p><code>less</code> is also a pager, but has more functionalities, e.g., scroll upwards and downwards through the input.</p></li>
<li><p><code>less</code> doesnâ€™t need to read the whole file, i.e., it loads files faster than <code>more</code>.</p></li>
</ul>
</section>
<section id="grep" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="grep"><span class="header-section-number">6.4</span> <code>grep</code></h3>
<p><code>grep</code> prints lines that match an expression:</p>
<ul>
<li>Show lines that contain string <code>CentOS</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quotes not necessary if not a regular expression</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="st">'CentOS'</span> linux.qmd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- RHEL/CentOS is popular on servers. (In December 2020, Red Hat terminated the development of CentOS Linux distribution.)
- UCLA Hoffman2 cluster runs CentOS 7.9.2009 (as of 2023-01-01).
- Show lines that contain string `CentOS`:
grep 'CentOS' linux.qmd
grep 'CentOS' *.qmd
grep -n 'CentOS' linux.qmd
- Replace `CentOS` by `RHEL` in a text file:
sed 's/CentOS/RHEL/' linux.qmd | grep RHEL</code></pre>
</div>
</div>
<ul>
<li>Search multiple text files:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="st">'CentOS'</span> <span class="pp">*</span>.qmd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- RHEL/CentOS is popular on servers. (In December 2020, Red Hat terminated the development of CentOS Linux distribution.)
- UCLA Hoffman2 cluster runs CentOS 7.9.2009 (as of 2023-01-01).
- Show lines that contain string `CentOS`:
grep 'CentOS' linux.qmd
grep 'CentOS' *.qmd
grep -n 'CentOS' linux.qmd
- Replace `CentOS` by `RHEL` in a text file:
sed 's/CentOS/RHEL/' linux.qmd | grep RHEL</code></pre>
</div>
</div>
<ul>
<li>Show matching line numbers:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-n</span> <span class="st">'CentOS'</span> linux.qmd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>50:- RHEL/CentOS is popular on servers. (In December 2020, Red Hat terminated the development of CentOS Linux distribution.)
56:- UCLA Hoffman2 cluster runs CentOS 7.9.2009 (as of 2023-01-01).
352:- Show lines that contain string `CentOS`:
355:grep 'CentOS' linux.qmd
360:grep 'CentOS' *.qmd
365:grep -n 'CentOS' linux.qmd
382:- Replace `CentOS` by `RHEL` in a text file:
384:sed 's/CentOS/RHEL/' linux.qmd | grep RHEL</code></pre>
</div>
</div>
<ul>
<li>Find all files in current directory with <code>.png</code> extension:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">'.png$'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>key_authentication_1.png
key_authentication_2.png
linux_directory_structure.png
linux_filepermission_oct.png
linux_filepermission.png
redhat_kills_centos.png
Richard_Stallman_2013.png
screenshot_top.png</code></pre>
</div>
</div>
<ul>
<li>Find all directories in the current directory:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-al</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">'^d'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>drwxr-xr-x 24 rstudio rstudio    768 Dec 30 08:17 .
drwxr-xr-x 22 rstudio rstudio    704 Mar  9  2022 ..
drwxr-xr-x  3 rstudio rstudio     96 Dec 30 08:16 linux_files</code></pre>
</div>
</div>
</section>
<section id="sed" class="level3" data-number="6.5">
<h3 data-number="6.5" class="anchored" data-anchor-id="sed"><span class="header-section-number">6.5</span> <code>sed</code></h3>
<ul>
<li><p><code>sed</code> is a stream editor.</p></li>
<li><p>Replace <code>CentOS</code> by <code>RHEL</code> in a text file:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="st">'s/CentOS/RHEL/'</span> linux.qmd <span class="kw">|</span> <span class="fu">grep</span> RHEL</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- RHEL/RHEL is popular on servers. (In December 2020, Red Hat terminated the development of CentOS Linux distribution.)
- UCLA Hoffman2 cluster runs RHEL 7.9.2009 (as of 2023-01-01).
- Show lines that contain string `RHEL`:
grep 'RHEL' linux.qmd
grep 'RHEL' *.qmd
grep -n 'RHEL' linux.qmd
- Replace `RHEL` by `RHEL` in a text file:
sed 's/RHEL/RHEL/' linux.qmd | grep RHEL</code></pre>
</div>
</div>
</section>
<section id="awk" class="level3" data-number="6.6">
<h3 data-number="6.6" class="anchored" data-anchor-id="awk"><span class="header-section-number">6.6</span> <code>awk</code></h3>
<ul>
<li><p><code>awk</code> is a filter and report writer.</p></li>
<li><p>First letâ€™s display the content of the file <code>/etc/passwd</code>:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> /etc/passwd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
rstudio-server:x:999:999::/home/rstudio-server:/bin/sh
rstudio:x:1000:1000::/home/rstudio:/bin/bash
systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:104::/nonexistent:/usr/sbin/nologin</code></pre>
</div>
</div>
<p>Each line contains fields (1) user name, (2) password, (3) user ID, (4) group ID, (5) user ID info, (6) home directory, and (7) command shell, separated by <code>:</code>.</p>
<ul>
<li>Print sorted list of login names:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-F:</span> <span class="st">'{ print $1 }'</span> /etc/passwd <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>_apt
backup
bin
daemon
games
gnats
irc
list
lp
mail</code></pre>
</div>
</div>
<ul>
<li>Print number of lines in a file, as <code>NR</code> stands for Number of Rows:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">'END { print NR }'</span> /etc/passwd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>24</code></pre>
</div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wc</span> <span class="at">-l</span> /etc/passwd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>24 /etc/passwd</code></pre>
</div>
</div>
<p>or (not displaying file name)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wc</span> <span class="at">-l</span> <span class="op">&lt;</span> /etc/passwd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>24</code></pre>
</div>
</div>
<ul>
<li>Print login names with UID in range <code>1000-1035</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-F:</span> <span class="st">'{if ($3 &gt;= 1000 &amp;&amp; $3 &lt;= 1047) print}'</span> /etc/passwd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rstudio:x:1000:1000::/home/rstudio:/bin/bash</code></pre>
</div>
</div>
<ul>
<li>Print login names and log-in shells in comma-separated format:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-F:</span> <span class="st">'{OFS = ","} {print $1, $7}'</span> /etc/passwd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>root,/bin/bash
daemon,/usr/sbin/nologin
bin,/usr/sbin/nologin
sys,/usr/sbin/nologin
sync,/bin/sync
games,/usr/sbin/nologin
man,/usr/sbin/nologin
lp,/usr/sbin/nologin
mail,/usr/sbin/nologin
news,/usr/sbin/nologin
uucp,/usr/sbin/nologin
proxy,/usr/sbin/nologin
www-data,/usr/sbin/nologin
backup,/usr/sbin/nologin
list,/usr/sbin/nologin
irc,/usr/sbin/nologin
gnats,/usr/sbin/nologin
nobody,/usr/sbin/nologin
_apt,/usr/sbin/nologin
rstudio-server,/bin/sh
rstudio,/bin/bash
systemd-network,/usr/sbin/nologin
systemd-resolve,/usr/sbin/nologin
messagebus,/usr/sbin/nologin</code></pre>
</div>
</div>
<ul>
<li>Print login names and indicate those with UID&gt;1000 as <code>vip</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="at">-F:</span> <span class="at">-v</span> status=<span class="st">""</span> <span class="st">'{OFS = ","} </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="st">{if ($3 &gt;= 1000) status="vip"; else status="regular"} </span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="st">{print $1, status}'</span> /etc/passwd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>root,regular
daemon,regular
bin,regular
sys,regular
sync,regular
games,regular
man,regular
lp,regular
mail,regular
news,regular
uucp,regular
proxy,regular
www-data,regular
backup,regular
list,regular
irc,regular
gnats,regular
nobody,vip
_apt,regular
rstudio-server,regular
rstudio,vip
systemd-network,regular
systemd-resolve,regular
messagebus,regular</code></pre>
</div>
</div>
</section>
<section id="text-editors" class="level3" data-number="6.7">
<h3 data-number="6.7" class="anchored" data-anchor-id="text-editors"><span class="header-section-number">6.7</span> Text editors</h3>
<p align="center">
<img src="./Richard_Stallman_2013.png" height="400">
</p>
<p>Source: <a href="http://en.wikipedia.org/wiki/Editor_war">Editor War</a> on Wikipedia.</p>
<section id="emacs" class="level4" data-number="6.7.1">
<h4 data-number="6.7.1" class="anchored" data-anchor-id="emacs"><span class="header-section-number">6.7.1</span> Emacs</h4>
<ul>
<li><p><code>Emacs</code> is a powerful text editor with extensive support for many languages including <code>R</code>, <span class="math inline">\(\LaTeX\)</span>, <code>python</code>, and <code>C/C++</code>; however itâ€™s <em>not</em> installed by default on many Linux distributions.</p></li>
<li><p>Basic survival commands:</p>
<ul>
<li><code>emacs filename</code> to open a file with emacs.<br>
</li>
<li><code>CTRL-x CTRL-f</code> to open an existing or new file.<br>
</li>
<li><code>CTRL-x CTRX-s</code> to save.<br>
</li>
<li><code>CTRL-x CTRL-w</code> to save as.<br>
</li>
<li><code>CTRL-x CTRL-c</code> to quit.</li>
</ul></li>
<li><p>Google <code>emacs cheatsheet</code></p></li>
</ul>
<p align="center">
<img src="./Emacs_Reference_Card.pdf" height="400">
</p>
<p><code>C-&lt;key&gt;</code> means hold the <code>control</code> key, and press <code>&lt;key&gt;</code>.<br>
<code>M-&lt;key&gt;</code> means press the <code>Esc</code> key once, and press <code>&lt;key&gt;</code>.</p>
</section>
<section id="vi" class="level4" data-number="6.7.2">
<h4 data-number="6.7.2" class="anchored" data-anchor-id="vi"><span class="header-section-number">6.7.2</span> Vi</h4>
<ul>
<li><p><code>Vi</code> is ubiquitous (POSIX standard). Learn at least its basics; otherwise you can edit nothing on some clusters.</p></li>
<li><p>Basic survival commands:</p>
<ul>
<li><code>vi filename</code> to start editing a file.</li>
<li><code>vi</code> is a <em>modal</em> editor: <em>insert</em> mode and <em>normal</em> mode. Pressing <code>i</code> switches from the normal mode to insert mode. Pressing <code>ESC</code> switches from the insert mode to normal mode.<br>
</li>
<li><code>:x&lt;Return&gt;</code> quits <code>vi</code> and saves changes.<br>
</li>
<li><code>:q!&lt;Return&gt;</code> quits vi without saving latest changes.<br>
</li>
<li><code>:w&lt;Return&gt;</code> saves changes.</li>
<li><code>:wq&lt;Return&gt;</code> quits <code>vi</code> and saves changes.</li>
</ul></li>
<li><p>Google <code>vi cheatsheet</code></p></li>
</ul>
<p align="center">
<img src="./Vi_Cheat_Sheet.pdf" height="500">
</p>
</section>
</section>
</section>
<section id="ide-integrated-development-environment" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="ide-integrated-development-environment"><span class="header-section-number">7</span> IDE (Integrated Development Environment)</h2>
<ul>
<li><p>Statisticians/data scientists write a lot of code. Critical to adopt a good IDE that goes beyond code editing: syntax highlighting, executing code within editor, debugging, profiling, version control, etc.</p></li>
<li><p><strong>RStudio</strong>, Eclipse, Emacs, Matlab, Visual Studio, etc.</p></li>
</ul>
</section>
<section id="processes" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="processes"><span class="header-section-number">8</span> Processes</h2>
<section id="cancel-a-non-responding-program" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="cancel-a-non-responding-program"><span class="header-section-number">8.1</span> Cancel a non-responding program</h3>
<ul>
<li>Press <code>Ctrl+C</code> to cancel a non-responding or long-running program.</li>
</ul>
</section>
<section id="processes-1" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="processes-1"><span class="header-section-number">8.2</span> Processes</h3>
<ul>
<li><p>OS runs processes on behalf of user.</p></li>
<li><p>Each process has Process ID (PID), Username (UID), Parent process ID (PPID), Time and data process started (STIME), time running (TIME), etc.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ps</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  PID TTY          TIME CMD
  297 ?        00:00:04 rsession
  418 ?        00:00:00 quarto
  425 ?        00:00:02 deno
  431 ?        00:00:01 R
  544 ?        00:00:00 sh
  545 ?        00:00:00 ps</code></pre>
</div>
</div>
<ul>
<li>All current running processes:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ps</span> <span class="at">-eaf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>UID        PID  PPID  C STIME TTY          TIME CMD
root         1     0  0 08:16 ?        00:00:00 s6-svscan -t0 /var/run/s6/services
root        38     1  0 08:16 ?        00:00:00 s6-supervise s6-fdholderd
root       252     1  0 08:16 ?        00:00:00 s6-supervise rstudio
rstudio+   255   252  1 08:16 ?        00:00:00 /usr/lib/rstudio-server/bin/rserver --server-daemonize 0
rstudio    297   255 11 08:16 ?        00:00:04 /usr/lib/rstudio-server/bin/rsession -u rstudio --session-use-secure-cookies 0 --session-root-path / --session-same-site 0 --session-use-file-storage 1 --launcher-token B98BF8DC --r-restore-workspace 2 --r-run-rprofile 2
rstudio    418   297  0 08:17 ?        00:00:00 /bin/bash /usr/lib/rstudio-server/bin/quarto/bin/quarto preview linux.qmd --to html --no-watch-inputs --no-browse
rstudio    425   418 68 08:17 ?        00:00:02 /usr/lib/rstudio-server/bin/quarto/bin/tools/deno-x86_64-unknown-linux-gnu/deno run --unstable --no-config --cached-only --allow-read --allow-write --allow-run --allow-env --allow-net --allow-ffi --no-check --importmap=/usr/lib/rstudio-server/bin/quarto/bin/vendor/import_map.json /usr/lib/rstudio-server/bin/quarto/bin/quarto.js preview linux.qmd --to html --no-watch-inputs --no-browse
rstudio    431   425 69 08:17 ?        00:00:01 /usr/local/lib/R/bin/exec/R --no-save --no-restore --no-echo --no-restore --file=/usr/lib/rstudio-server/bin/quarto/share/rmd/rmd.R
rstudio    546   431  0 08:17 ?        00:00:00 sh -c 'bash'  -c 'ps -eaf' 2&gt;&amp;1
rstudio    547   546  0 08:17 ?        00:00:00 ps -eaf</code></pre>
</div>
</div>
<ul>
<li>All Python processes:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ps</span> <span class="at">-eaf</span> <span class="kw">|</span> <span class="fu">grep</span> python</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rstudio    548   431  0 08:17 ?        00:00:00 sh -c 'bash'  -c 'ps -eaf | grep python' 2&gt;&amp;1
rstudio    549   548  0 08:17 ?        00:00:00 bash -c ps -eaf | grep python
rstudio    551   549  0 08:17 ?        00:00:00 grep python</code></pre>
</div>
</div>
<ul>
<li>Process with PID=1:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ps</span> <span class="at">-fp</span> 1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>UID        PID  PPID  C STIME TTY          TIME CMD
root         1     0  0 08:16 ?        00:00:00 s6-svscan -t0 /var/run/s6/services</code></pre>
</div>
</div>
<ul>
<li>All processes owned by a user:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ps</span> <span class="at">-fu</span> <span class="va">$USER</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>UID        PID  PPID  C STIME TTY          TIME CMD
rstudio    297   255 11 08:16 ?        00:00:04 /usr/lib/rstudio-server/bin/rsession -u rstudio --session-use-secure-cookies 0 --session-root-path / --session-same-site 0 --session-use-file-storage 1 --launcher-token B98BF8DC --r-restore-workspace 2 --r-run-rprofile 2
rstudio    418   297  0 08:17 ?        00:00:00 /bin/bash /usr/lib/rstudio-server/bin/quarto/bin/quarto preview linux.qmd --to html --no-watch-inputs --no-browse
rstudio    425   418 69 08:17 ?        00:00:02 /usr/lib/rstudio-server/bin/quarto/bin/tools/deno-x86_64-unknown-linux-gnu/deno run --unstable --no-config --cached-only --allow-read --allow-write --allow-run --allow-env --allow-net --allow-ffi --no-check --importmap=/usr/lib/rstudio-server/bin/quarto/bin/vendor/import_map.json /usr/lib/rstudio-server/bin/quarto/bin/quarto.js preview linux.qmd --to html --no-watch-inputs --no-browse
rstudio    431   425 70 08:17 ?        00:00:01 /usr/local/lib/R/bin/exec/R --no-save --no-restore --no-echo --no-restore --file=/usr/lib/rstudio-server/bin/quarto/share/rmd/rmd.R
rstudio    554   431  0 08:17 ?        00:00:00 sh -c 'bash'  -c 'ps -fu $USER' 2&gt;&amp;1
rstudio    555   554  0 08:17 ?        00:00:00 ps -fu rstudio</code></pre>
</div>
</div>
</section>
<section id="kill-processes" class="level3" data-number="8.3">
<h3 data-number="8.3" class="anchored" data-anchor-id="kill-processes"><span class="header-section-number">8.3</span> Kill processes</h3>
<ul>
<li>Kill process with PID=1001:</li>
</ul>
<div class="sourceCode" id="cb88"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{bash}</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="bu">kill</span> 1001</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Kill all R processes.</li>
</ul>
<div class="sourceCode" id="cb89"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{bash}</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">killall</span> <span class="at">-r</span> R</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="top" class="level3" data-number="8.4">
<h3 data-number="8.4" class="anchored" data-anchor-id="top"><span class="header-section-number">8.4</span> <code>top</code></h3>
<ul>
<li><code>top</code> prints realtime process information (very useful).</li>
</ul>
<div class="sourceCode" id="cb90"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{bash}</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="ex">top</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p align="center">
<img src="./screenshot_top.png" height="400">
</p>
<ul>
<li>Exit the <code>top</code> program by pressing the <code>q</code> key.</li>
</ul>
</section>
</section>
<section id="secure-shell-ssh" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="secure-shell-ssh"><span class="header-section-number">9</span> Secure shell (SSH)</h2>
<section id="ssh" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="ssh"><span class="header-section-number">9.1</span> SSH</h3>
<p>SSH (secure shell) is the dominant cryptographic network protocol for secure network connection via an insecure network.</p>
<ul>
<li>On Linux or Mac terminal, access a Linux machine by</li>
</ul>
<div class="sourceCode" id="cb91"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{bash}</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh</span> [USERNAME]@[IP_ADDRESS]</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Replace above <code>[USERNAME]</code> by your account user name on the Linux machine and <code>[IP_ADDRESS]</code> by the machineâ€™s ip address. For example, to connect to the Hoffman2 cluster at UCLA</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{bash}</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh</span> huazhou@hoffman2.idre.ucla.edu</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>For Windows users, there are at least three ways: (1) (highly recommended) <a href="https://git-scm.com/download/win">Git Bash</a> which is included in Git for Windows, (2) (not recommended) <a href="http://www.putty.org">PuTTY</a> program (free), or (3) (may be an overkill for this class) use WSL for Windows to install a full fledged Linux system within Windows.</li>
</ul>
</section>
<section id="advantages-of-keys-over-password" class="level3" data-number="9.2">
<h3 data-number="9.2" class="anchored" data-anchor-id="advantages-of-keys-over-password"><span class="header-section-number">9.2</span> Advantages of keys over password</h3>
<ul>
<li><p>Key authentication is more secure than password. Most passwords are weak.</p></li>
<li><p>Script or a program may need to systematically SSH into other machines.</p></li>
<li><p>Log into multiple machines using the same key.</p></li>
<li><p>Seamless use of many services: Git/GitHub, AWS or Google cloud service, parallel computing on multiple hosts, Travis CI (continuous integration) etc.</p></li>
<li><p>Many servers only allow key authentication and do not accept password authentication.</p></li>
</ul>
</section>
<section id="key-authentication" class="level3" data-number="9.3">
<h3 data-number="9.3" class="anchored" data-anchor-id="key-authentication"><span class="header-section-number">9.3</span> Key authentication</h3>
<p align="center">
<img src="./key_authentication_1.png" height="200">
</p>
<p align="center">
<img src="./key_authentication_2.png" height="250">
</p>
<ul>
<li><p><em>Public key</em>. Put on the machine(s) you want to log in.</p></li>
<li><p><em>Private key</em>. Put on your own computer. Consider this as the actual key in your pocket; <strong>never give private key to others</strong>. For fun:</p></li>
</ul>
<div class="quarto-video ratio ratio-16x9"><iframe src="https://www.youtube.com/embed/S8K464ImU0c" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<ul>
<li><p>Messages from server to your computer is encrypted with your public key. It can only be decrypted using your private key.</p></li>
<li><p>Messages from your computer to server is signed with your private key (digital signatures) and can be verified by anyone who has your public key (authentication).</p></li>
</ul>
</section>
<section id="steps-to-generate-keys" class="level3" data-number="9.4">
<h3 data-number="9.4" class="anchored" data-anchor-id="steps-to-generate-keys"><span class="header-section-number">9.4</span> Steps to generate keys</h3>
<ul>
<li>On Linux, Mac, or Windows Git Bash, to generate a key pair:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh-keygen</span> <span class="at">-t</span> rsa <span class="at">-f</span> ~/.ssh/[KEY_FILENAME] <span class="at">-C</span> [USERNAME]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>- `[KEY_FILENAME]` is the name that you want to use for your SSH key files. For example, a filename of `id_rsa` generates a private key file named `id_rsa` and a public key file named `id_rsa.pub`.  

- `[USERNAME]` is the user for whom you will apply this SSH key.   

- Use a (**optional**) paraphrase different from password.  </code></pre>
<ul>
<li><p>Set correct permissions on the <code>.ssh</code> folder and key files.</p>
<ul>
<li>The permission for the <code>~/.ssh</code> folder should be <code>700 (drwx------)</code>.</li>
<li>The permission of the private key <code>~/.ssh/id_rsa</code> should be <code>600 (-rw-------)</code>.</li>
<li>The permission of the public key <code>~/.ssh/id_rsa.pub</code> should be <code>644 (-rw-r--r--)</code>.</li>
</ul>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 700 ~/.ssh</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 600 ~/.ssh/[KEY_FILENAME]</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 644 ~/.ssh/[KEY_FILENAME].pub</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<p>Note Windows is different, it doesnâ€™t allow change of permissions.</p></li>
<li><p>Append the public key to the <code>~/.ssh/authorized_keys</code> file of any Linux machine we want to SSH to, e.g.,</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ssh-copy-id</span> <span class="at">-i</span> ~/.ssh/[KEY_FILENAME] [USERNAME]@[IP_ADDRESS]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Make sure the permission of the <code>authorized_keys</code> file is <code>600 (-rw-------)</code>.</p>
<ul>
<li>Test your new key.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh</span> <span class="at">-i</span> ~/.ssh/[KEY_FILENAME] [USERNAME]@[IP_ADDRESS]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>From now on, you donâ€™t need password each time you connect from your machine to the teaching server.</p></li>
<li><p>If you set paraphrase when generating keys, youâ€™ll be prompted for the paraphrase each time the private key is used. Avoid repeatedly entering the paraphrase by using <code>ssh-agent</code> on Linux/Mac or Pagent on Windows.</p></li>
<li><p>Same key pair can be used between any two machines. We donâ€™t need to regenerate keys for each new connection.</p></li>
</ul>
</section>
<section id="transfer-files-between-machines" class="level3" data-number="9.5">
<h3 data-number="9.5" class="anchored" data-anchor-id="transfer-files-between-machines"><span class="header-section-number">9.5</span> Transfer files between machines</h3>
<ul>
<li><code>scp</code> securely transfers files between machines using SSH.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">## copy file from local to remote</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scp</span> [LOCALFILE] [USERNAME]@[IP_ADDRESS]:/[PATH_TO_FOLDER]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">## copy file from remote to local</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scp</span> [USERNAME]@[IP_ADDRESS]:/[PATH_TO_FILE] [PATH_TO_LOCAL_FOLDER]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p><code>sftp</code> is FTP via SSH.</p></li>
<li><p><code>Globus</code> is GUI program for securely transferring files between machines. To use Globus you will have to go to <a href="https://www.globus.org/" class="uri">https://www.globus.org/</a> and login through UCLA by selecting your existing organizational login as UCLA. Then you will need to download their Globus Connect Personal software, then set your laptop as an endpoint. Very detailed instructions can be found at <a href="https://www.hoffman2.idre.ucla.edu/file-transfer/globus/" class="uri">https://www.hoffman2.idre.ucla.edu/file-transfer/globus/</a>.</p></li>
<li><p>GUIs for Windows (WinSCP) or Mac (Cyberduck).</p></li>
<li><p>You can even use RStudio to upload files to a remote machine with RStudio Server installed.</p></li>
<li><p>(<strong>Preferred way</strong>) Use a <strong>version control system</strong> (git, svn, cvs, â€¦) to sync project files between different machines and systems.</p></li>
</ul>
</section>
<section id="line-breaks-in-text-files" class="level3" data-number="9.6">
<h3 data-number="9.6" class="anchored" data-anchor-id="line-breaks-in-text-files"><span class="header-section-number">9.6</span> Line breaks in text files</h3>
<ul>
<li><p>Windows uses a pair of <code>CR</code> and <code>LF</code> for line breaks.</p></li>
<li><p>Linux/Unix uses an <code>LF</code> character only.</p></li>
<li><p>MacOS X also uses a single <code>LF</code> character. But old Mac OS used a single <code>CR</code> character for line breaks.</p></li>
<li><p>If transferred in binary mode (bit by bit) between OSs, a text file could look a mess.</p></li>
<li><p>Most transfer programs automatically switch to text mode when transferring text files and perform conversion of line breaks between different OSs; but I used to run into problems using WinSCP. Sometimes you have to tell WinSCP explicitly a text file is being transferred.</p></li>
</ul>
</section>
</section>
<section id="run-r-in-linux" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="run-r-in-linux"><span class="header-section-number">10</span> Run R in Linux</h2>
<section id="interactive-mode" class="level3" data-number="10.1">
<h3 data-number="10.1" class="anchored" data-anchor-id="interactive-mode"><span class="header-section-number">10.1</span> Interactive mode</h3>
<ul>
<li><p>Start R in the interactive mode by typing <code>R</code> in shell.</p></li>
<li><p>Then run R script by</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"script.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="batch-mode" class="level3" data-number="10.2">
<h3 data-number="10.2" class="anchored" data-anchor-id="batch-mode"><span class="header-section-number">10.2</span> Batch mode</h3>
<ul>
<li>Demo script <a href="https://raw.githubusercontent.com/ucla-biostat-203b/2022winter/main/slides/02-linux/meanEst.R"><code>meanEst.R</code></a> implements an (terrible) estimator of mean <span class="math display">\[
{\widehat \mu}_n = \frac{\sum_{i=1}^n x_i 1_{i \text{ is prime}}}{\sum_{i=1}^n 1_{i \text{ is prime}}}.
\]</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> meanEst.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>To run your R code non-interactively aka in batch mode, we have at least two options:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># default output to meanEst.Rout</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span> CMD BATCH meanEst.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># output to stdout</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Rscript</span> meanEst.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Typically automate batch calls using a scripting language, e.g., Python, Perl, and shell script.</li>
</ul>
</section>
<section id="pass-arguments-to-r-scripts" class="level3" data-number="10.3">
<h3 data-number="10.3" class="anchored" data-anchor-id="pass-arguments-to-r-scripts"><span class="header-section-number">10.3</span> Pass arguments to R scripts</h3>
<ul>
<li>Specify arguments in <code>R CMD BATCH</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span> CMD BATCH <span class="st">'--args mu=1 sig=2 kap=3'</span> script.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Specify arguments in <code>Rscript</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Rscript</span> script.R mu=1 sig=2 kap=3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Parse command line arguments using magic formula</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (arg <span class="cf">in</span> <span class="fu">commandArgs</span>(<span class="cn">TRUE</span>)) {</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text=</span>arg))</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>in R script. After calling the above code, all command line arguments will be available in the global namespace.</p>
<ul>
<li>To understand the magic formula <code>commandArgs</code>, run R by:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span> <span class="st">'--args mu=1 sig=2 kap=3'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and then issue commands in R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">commandArgs</span>()</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">commandArgs</span>(<span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Understand the magic formula <code>parse</code> and <code>eval</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">parse</span>(<span class="at">text =</span> <span class="st">"x=3"</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> <span class="st">"x=3"</span>))</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><a href="https://raw.githubusercontent.com/ucla-biostat-203b/2022winter/main/slides/02-linux/runSim.R"><code>runSim.R</code></a> has components: (1) <strong>command argument parser</strong>, (2) method implementation, (3) data generator with unspecified parameter <code>n</code>, and (4) estimation based on generated data.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>## parsing command arguments
for (arg in commandArgs(TRUE)) {
  eval(parse(text=arg))
}

## check if a given integer is prime
isPrime = function(n) {
  if (n &lt;= 3) {
    return (TRUE)
  }
  if (any((n %% 2:floor(sqrt(n))) == 0)) {
    return (FALSE)
  }
  return (TRUE)
}

## estimate mean only using observation with prime indices
estMeanPrimes = function (x) {
  n = length(x)
  ind = sapply(1:n, isPrime)
  return (mean(x[ind]))
}

# simulate data
x = rnorm(n)

# estimate mean
estMeanPrimes(x)</code></pre>
</div>
</div>
<ul>
<li>Call <code>runSim.R</code> with sample size <code>n=100</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="ex">R</span> CMD BATCH <span class="st">'--args n=100'</span> runSim.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Rscript</span> runSim.R n=100</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.3604002</code></pre>
</div>
</div>
</section>
<section id="run-long-jobs" class="level3" data-number="10.4">
<h3 data-number="10.4" class="anchored" data-anchor-id="run-long-jobs"><span class="header-section-number">10.4</span> Run long jobs</h3>
<ul>
<li><p>Many statistical computing tasks take long: simulation, MCMC, etc. If we exit Linux when the job is unfinished, the job is killed.</p></li>
<li><p><code>nohup</code> command in Linux runs program(s) immune to hangups and writes output to <code>nohup.out</code> by default. Logging out will <em>not</em> kill the process; we can log in later to check status and results.</p></li>
<li><p><code>nohup</code> is POSIX standard thus available on Linux and MacOS.</p></li>
<li><p>Run <code>runSim.R</code> in background and writes output to <code>nohup.out</code>:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nohup</span> Rscript runSim.R n=100 <span class="kw">&amp;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2461959</code></pre>
</div>
</div>
<p>The <code>&amp;</code> at the end of the command instructs Linux to run this command in background, so we gain control of the terminal immediately.</p>
</section>
<section id="screen" class="level3" data-number="10.5">
<h3 data-number="10.5" class="anchored" data-anchor-id="screen"><span class="header-section-number">10.5</span> screen</h3>
<ul>
<li><p><code>screen</code> is another popular utility, but not installed by default.</p></li>
<li><p>Typical workflow using <code>screen</code>.</p>
<ol start="0" type="1">
<li><p>Access remote server using <code>ssh</code>.</p></li>
<li><p>Start jobs in batch mode.</p></li>
<li><p>Detach jobs.</p></li>
<li><p>Exit from server, wait for jobs to finish.</p></li>
<li><p>Access remote server using <code>ssh</code>.</p></li>
<li><p>Re-attach jobs, check on progress, get results, etc.</p></li>
</ol></li>
</ul>
</section>
<section id="use-r-to-call-r" class="level3" data-number="10.6">
<h3 data-number="10.6" class="anchored" data-anchor-id="use-r-to-call-r"><span class="header-section-number">10.6</span> Use R to call R</h3>
<p>R in conjuction with <code>nohup</code> (or <code>screen</code>) can be used to orchestrate a large simulation study.</p>
<ul>
<li><p>It can be more elegant, transparent, and robust to parallelize jobs corresponding to different scenarios (e.g., different generative models) outside of the code used to do statistical computation.</p></li>
<li><p>We consider a simulation study in R but the same approach could be used with code written in Julia, Matlab, Python, etc.</p></li>
<li><p>Python in many ways makes a better <em>glue</em>.</p></li>
<li><p>Suppose we have</p>
<ul>
<li><a href="https://raw.githubusercontent.com/ucla-biostat-203b/2022winter/main/slides/02-linux/runSim.R"><code>runSim.R</code></a> which runs a simulation based on command line argument <code>n</code>.<br>
</li>
<li>A large collection of <code>n</code> values that we want to use in our simulation study.<br>
</li>
<li>Access to a server with 128 cores.<br>
How to parallelize the job?</li>
</ul></li>
<li><p>Option 1: manually call <code>runSim.R</code> for each setting.</p></li>
<li><p>Option 2 (smarter): automate calls using R and <code>nohup</code>.</p></li>
<li><p>Letâ€™s demonstrate using the script <a href="https://raw.githubusercontent.com/ucla-biostat-203b/2022winter/main/slides/02-linux/autoSim.R">autoSim.R</a></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> autoSim.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># autoSim.R

nVals &lt;- seq(100, 1000, by=100)
for (n in nVals) {
  oFile &lt;- paste("n", n, ".txt", sep="")
  sysCall &lt;- paste("nohup Rscript runSim.R n=", n, " &gt; ", oFile, sep="")
  system(sysCall, wait = FALSE)
  print(paste("sysCall=", sysCall, sep=""))
}</code></pre>
</div>
</div>
<p>Note when we call bash command using the <code>system</code> function in R, we set optional argument <code>wait=FALSE</code> so that jobs can be run parallel.</p>
<ul>
<li></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Rscript</span> autoSim.R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sysCall=nohup Rscript runSim.R n=100 &gt; n100.txt"
[1] "sysCall=nohup Rscript runSim.R n=200 &gt; n200.txt"
[1] "sysCall=nohup Rscript runSim.R n=300 &gt; n300.txt"
[1] "sysCall=nohup Rscript runSim.R n=400 &gt; n400.txt"
[1] "sysCall=nohup Rscript runSim.R n=500 &gt; n500.txt"
[1] "sysCall=nohup Rscript runSim.R n=600 &gt; n600.txt"
[1] "sysCall=nohup Rscript runSim.R n=700 &gt; n700.txt"
[1] "sysCall=nohup Rscript runSim.R n=800 &gt; n800.txt"
[1] "sysCall=nohup Rscript runSim.R n=900 &gt; n900.txt"
[1] "sysCall=nohup Rscript runSim.R n=1000 &gt; n1000.txt"</code></pre>
</div>
</div>
<div class="cell">

</div>
<ul>
<li><p>Now we just need to write a script to collect results from the output files.</p></li>
<li><p>Later we will learn how to coordinate large scale computation on UCLA Hoffman2 cluster, using Linux and R scripting.</p></li>
</ul>
</section>
</section>
<section id="some-other-linux-commands" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="some-other-linux-commands"><span class="header-section-number">11</span> Some other Linux commands</h2>
<ul>
<li><p>Log out Linux: <code>exit</code> or <code>logout</code> or <code>ctrl+d</code>.</p></li>
<li><p>Clear screen: <code>clear</code>.</p></li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>