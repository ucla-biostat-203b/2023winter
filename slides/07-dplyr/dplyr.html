<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Hua Zhou @ UCLA">
<meta name="dcterms.date" content="2023-02-06">

<title>Data Transformation With dplyr</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="dplyr_files/libs/clipboard/clipboard.min.js"></script>
<script src="dplyr_files/libs/quarto-html/quarto.js"></script>
<script src="dplyr_files/libs/quarto-html/popper.min.js"></script>
<script src="dplyr_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="dplyr_files/libs/quarto-html/anchor.min.js"></script>
<link href="dplyr_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="dplyr_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="dplyr_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="dplyr_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="dplyr_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#nycflights13-data" id="toc-nycflights13-data" class="nav-link active" data-scroll-target="#nycflights13-data"><span class="toc-section-number">1</span>  nycflights13 data</a></li>
  <li><a href="#dplyr-basics" id="toc-dplyr-basics" class="nav-link" data-scroll-target="#dplyr-basics"><span class="toc-section-number">2</span>  dplyr basics</a></li>
  <li><a href="#manipulate-rows-cases" id="toc-manipulate-rows-cases" class="nav-link" data-scroll-target="#manipulate-rows-cases"><span class="toc-section-number">3</span>  Manipulate rows (cases)</a>
  <ul>
  <li><a href="#filter-rows-with-filter" id="toc-filter-rows-with-filter" class="nav-link" data-scroll-target="#filter-rows-with-filter"><span class="toc-section-number">3.1</span>  Filter rows with <code>filter()</code></a></li>
  <li><a href="#remove-rows-with-duplicate-values" id="toc-remove-rows-with-duplicate-values" class="nav-link" data-scroll-target="#remove-rows-with-duplicate-values"><span class="toc-section-number">3.2</span>  Remove rows with duplicate values</a></li>
  <li><a href="#sample-rows" id="toc-sample-rows" class="nav-link" data-scroll-target="#sample-rows"><span class="toc-section-number">3.3</span>  Sample rows</a></li>
  <li><a href="#select-rows-by-position" id="toc-select-rows-by-position" class="nav-link" data-scroll-target="#select-rows-by-position"><span class="toc-section-number">3.4</span>  Select rows by position</a></li>
  <li><a href="#arrange-rows-with-arrange" id="toc-arrange-rows-with-arrange" class="nav-link" data-scroll-target="#arrange-rows-with-arrange"><span class="toc-section-number">3.5</span>  Arrange rows with <code>arrange()</code></a></li>
  </ul></li>
  <li><a href="#manipulate-columns-variables" id="toc-manipulate-columns-variables" class="nav-link" data-scroll-target="#manipulate-columns-variables"><span class="toc-section-number">4</span>  Manipulate columns (variables)</a>
  <ul>
  <li><a href="#select-columns-with-select" id="toc-select-columns-with-select" class="nav-link" data-scroll-target="#select-columns-with-select"><span class="toc-section-number">4.1</span>  Select columns with <code>select()</code></a></li>
  <li><a href="#add-new-variables-with-mutate" id="toc-add-new-variables-with-mutate" class="nav-link" data-scroll-target="#add-new-variables-with-mutate"><span class="toc-section-number">4.2</span>  Add new variables with <code>mutate()</code></a></li>
  </ul></li>
  <li><a href="#summaries" id="toc-summaries" class="nav-link" data-scroll-target="#summaries"><span class="toc-section-number">5</span>  Summaries</a>
  <ul>
  <li><a href="#summaries-with-summarise" id="toc-summaries-with-summarise" class="nav-link" data-scroll-target="#summaries-with-summarise"><span class="toc-section-number">5.1</span>  Summaries with <code>summarise()</code></a></li>
  <li><a href="#pipe" id="toc-pipe" class="nav-link" data-scroll-target="#pipe"><span class="toc-section-number">5.2</span>  Pipe</a></li>
  <li><a href="#other-summary-functions" id="toc-other-summary-functions" class="nav-link" data-scroll-target="#other-summary-functions"><span class="toc-section-number">5.3</span>  Other summary functions</a></li>
  </ul></li>
  <li><a href="#grouped-mutates-and-filters" id="toc-grouped-mutates-and-filters" class="nav-link" data-scroll-target="#grouped-mutates-and-filters"><span class="toc-section-number">6</span>  Grouped mutates (and filters)</a></li>
  <li><a href="#combine-tables" id="toc-combine-tables" class="nav-link" data-scroll-target="#combine-tables"><span class="toc-section-number">7</span>  Combine tables</a></li>
  <li><a href="#relational-data" id="toc-relational-data" class="nav-link" data-scroll-target="#relational-data"><span class="toc-section-number">8</span>  Relational data</a>
  <ul>
  <li><a href="#keys" id="toc-keys" class="nav-link" data-scroll-target="#keys"><span class="toc-section-number">8.1</span>  Keys</a></li>
  </ul></li>
  <li><a href="#combine-variables-columns" id="toc-combine-variables-columns" class="nav-link" data-scroll-target="#combine-variables-columns"><span class="toc-section-number">9</span>  Combine variables (columns)</a>
  <ul>
  <li><a href="#demo-tables" id="toc-demo-tables" class="nav-link" data-scroll-target="#demo-tables"><span class="toc-section-number">9.1</span>  Demo tables</a></li>
  <li><a href="#inner-join" id="toc-inner-join" class="nav-link" data-scroll-target="#inner-join"><span class="toc-section-number">9.2</span>  Inner join</a></li>
  <li><a href="#outer-join" id="toc-outer-join" class="nav-link" data-scroll-target="#outer-join"><span class="toc-section-number">9.3</span>  Outer join</a></li>
  <li><a href="#duplicate-keys" id="toc-duplicate-keys" class="nav-link" data-scroll-target="#duplicate-keys"><span class="toc-section-number">9.4</span>  Duplicate keys</a></li>
  <li><a href="#defining-the-key-columns" id="toc-defining-the-key-columns" class="nav-link" data-scroll-target="#defining-the-key-columns"><span class="toc-section-number">9.5</span>  Defining the key columns</a></li>
  </ul></li>
  <li><a href="#combine-cases-rows" id="toc-combine-cases-rows" class="nav-link" data-scroll-target="#combine-cases-rows"><span class="toc-section-number">10</span>  Combine cases (rows)</a>
  <ul>
  <li><a href="#semi-join" id="toc-semi-join" class="nav-link" data-scroll-target="#semi-join"><span class="toc-section-number">10.1</span>  Semi-join</a></li>
  <li><a href="#anti-join" id="toc-anti-join" class="nav-link" data-scroll-target="#anti-join"><span class="toc-section-number">10.2</span>  Anti-join</a></li>
  </ul></li>
  <li><a href="#set-operations" id="toc-set-operations" class="nav-link" data-scroll-target="#set-operations"><span class="toc-section-number">11</span>  Set operations</a></li>
  <li><a href="#cheat-sheet" id="toc-cheat-sheet" class="nav-link" data-scroll-target="#cheat-sheet"><span class="toc-section-number">12</span>  Cheat sheet</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Transformation With dplyr</h1>
<p class="subtitle lead">Biostat 203B</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr.&nbsp;Hua Zhou @ UCLA </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 6, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>Display machine information for reproducibility.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur ... 10.16

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
 [1] digest_0.6.30     lifecycle_1.0.3   jsonlite_1.8.4    magrittr_2.0.3   
 [5] evaluate_0.18     rlang_1.0.6       stringi_1.7.8     cli_3.4.1        
 [9] rstudioapi_0.14   vctrs_0.5.1       rmarkdown_2.18    tools_4.2.2      
[13] stringr_1.5.0     glue_1.6.2        htmlwidgets_1.6.0 xfun_0.35        
[17] yaml_2.3.6        fastmap_1.1.0     compiler_4.2.2    htmltools_0.5.4  
[21] knitr_1.41       </code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> IPython</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(IPython.sys_info())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'commit_hash': 'add5877a4',
 'commit_source': 'installation',
 'default_encoding': 'utf-8',
 'ipython_path': '/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/IPython',
 'ipython_version': '8.8.0',
 'os_name': 'posix',
 'platform': 'macOS-10.16-x86_64-i386-64bit',
 'sys_executable': '/Library/Frameworks/Python.framework/Versions/3.10/bin/python3',
 'sys_platform': 'darwin',
 'sys_version': '3.10.9 (v3.10.9:1dd9be6584, Dec  6 2022, 14:37:36) [Clang '
                '13.0.0 (clang-1300.0.29.30)]'}</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">InteractiveUtils</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">versioninfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Julia Version 1.8.3
Commit 0434deb161e (2022-11-14 20:14 UTC)
Platform Info:
  OS: macOS (x86_64-apple-darwin21.4.0)
  CPU: 8 × Intel(R) Core(TM) i7-6920HQ CPU @ 2.90GHz
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-13.0.1 (ORCJIT, skylake)
  Threads: 1 on 8 virtual cores
Environment:
  DYLD_FALLBACK_LIBRARY_PATH = /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_241.jdk/Contents/Home/jre/lib/server
  JULIA_EDITOR = code</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Load tidyverse (R), Pandas (Python), and DataFrames.jl (Julia).</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the pandas library</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load numpy for array manipulation</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrames</span>, <span class="bu">Pipe</span>, <span class="bu">StatsBase</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>A typical data science project:</p>
<p align="center">
<img src="./data-science.png" height="275">
</p>
<section id="nycflights13-data" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="nycflights13-data"><span class="header-section-number">1</span> nycflights13 data</h2>
<ul>
<li><p>Available from the nycflights13 package.</p></li>
<li><p>336,776 flights that departed from New York City in 2013:</p></li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"nycflights13"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>flights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1      517        515       2     830     819      11 UA     
 2  2013     1     1      533        529       4     850     830      20 UA     
 3  2013     1     1      542        540       2     923     850      33 AA     
 4  2013     1     1      544        545      -1    1004    1022     -18 B6     
 5  2013     1     1      554        600      -6     812     837     -25 DL     
 6  2013     1     1      554        558      -4     740     728      12 UA     
 7  2013     1     1      555        600      -5     913     854      19 B6     
 8  2013     1     1      557        600      -3     709     723     -14 EV     
 9  2013     1     1      557        600      -3     838     846      -8 B6     
10  2013     1     1      558        600      -2     753     745       8 AA     
# … with 336,766 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>The nycflights13 data is available from the nycflights13 package in Python.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nycflights13 <span class="im">import</span> flights</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>flights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  ...  hour  minute             time_hour
0       2013      1    1  ...     5      15  2013-01-01T10:00:00Z
1       2013      1    1  ...     5      29  2013-01-01T10:00:00Z
2       2013      1    1  ...     5      40  2013-01-01T10:00:00Z
3       2013      1    1  ...     5      45  2013-01-01T10:00:00Z
4       2013      1    1  ...     6       0  2013-01-01T11:00:00Z
...      ...    ...  ...  ...   ...     ...                   ...
336771  2013      9   30  ...    14      55  2013-09-30T18:00:00Z
336772  2013      9   30  ...    22       0  2013-10-01T02:00:00Z
336773  2013      9   30  ...    12      10  2013-09-30T16:00:00Z
336774  2013      9   30  ...    11      59  2013-09-30T15:00:00Z
336775  2013      9   30  ...     8      40  2013-09-30T12:00:00Z

[336776 rows x 19 columns]</code></pre>
</div>
</div>
<p>Note there are some differences of this <code>flights</code> data from that in tidyverse. The data types for some variables are different. There are no natural ways in Pandas to hold integer column with missing values; so <code>dep_time</code> , <code>arr_time</code> are <code>float64</code> instead of <code>int64</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>flights.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 336776 entries, 0 to 336775
Data columns (total 19 columns):
 #   Column          Non-Null Count   Dtype  
---  ------          --------------   -----  
 0   year            336776 non-null  int64  
 1   month           336776 non-null  int64  
 2   day             336776 non-null  int64  
 3   dep_time        328521 non-null  float64
 4   sched_dep_time  336776 non-null  int64  
 5   dep_delay       328521 non-null  float64
 6   arr_time        328063 non-null  float64
 7   sched_arr_time  336776 non-null  int64  
 8   arr_delay       327346 non-null  float64
 9   carrier         336776 non-null  object 
 10  flight          336776 non-null  int64  
 11  tailnum         334264 non-null  object 
 12  origin          336776 non-null  object 
 13  dest            336776 non-null  object 
 14  air_time        327346 non-null  float64
 15  distance        336776 non-null  int64  
 16  hour            336776 non-null  int64  
 17  minute          336776 non-null  int64  
 18  time_hour       336776 non-null  object 
dtypes: float64(5), int64(9), object(5)
memory usage: 48.8+ MB</code></pre>
</div>
</div>
<p>To be more consistent with <code>nycflights13</code> in tidyverse, we cast <code>time_hour</code> to <code>datetime</code> type.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>flights[<span class="st">'time_hour'</span>] <span class="op">=</span> pd.to_datetime(flights[<span class="st">'time_hour'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>Let’s use RCall.jl to retrieve the nycflights13 data from R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">RCall</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>R<span class="st">"""</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="st">library(nycflights13)</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RObject{StrSxp}</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>flights <span class="op">=</span> <span class="fu">rcopy</span>(R<span class="st">"flights"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×19 DataFrame
    Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time   ⋯
        │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?     ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      1      1       517             515        2.0       830   ⋯
      2 │  2013      1      1       533             529        4.0       850
      3 │  2013      1      1       542             540        2.0       923
      4 │  2013      1      1       544             545       -1.0      1004
      5 │  2013      1      1       554             600       -6.0       812   ⋯
      6 │  2013      1      1       554             558       -4.0       740
      7 │  2013      1      1       555             600       -5.0       913
      8 │  2013      1      1       557             600       -3.0       709
   ⋮    │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮       ⋱
 336770 │  2013      9     30      2349            2359      -10.0       325   ⋯
 336771 │  2013      9     30   missing            1842  missing     missing
 336772 │  2013      9     30   missing            1455  missing     missing
 336773 │  2013      9     30   missing            2200  missing     missing
 336774 │  2013      9     30   missing            1210  missing     missing   ⋯
 336775 │  2013      9     30   missing            1159  missing     missing
 336776 │  2013      9     30   missing             840  missing     missing
                                              12 columns and 336761 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>To display more rows or columns:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<ul>
<li><p>By default, tibble prints the first 10 rows and all columns <em>that fit on screen</em>.</p></li>
<li><p>To change number of rows and columns to display:</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>nycflights13<span class="sc">::</span>flights <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">width =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
   arr_delay carrier flight tailnum origin dest  air_time distance  hour minute
       &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1        11 UA        1545 N14228  EWR    IAH        227     1400     5     15
 2        20 UA        1714 N24211  LGA    IAH        227     1416     5     29
 3        33 AA        1141 N619AA  JFK    MIA        160     1089     5     40
 4       -18 B6         725 N804JB  JFK    BQN        183     1576     5     45
 5       -25 DL         461 N668DN  LGA    ATL        116      762     6      0
 6        12 UA        1696 N39463  EWR    ORD        150      719     5     58
 7        19 B6         507 N516JB  EWR    FLL        158     1065     6      0
 8       -14 EV        5708 N829AS  LGA    IAD         53      229     6      0
 9        -8 B6          79 N593JB  JFK    MCO        140      944     6      0
10         8 AA         301 N3ALAA  LGA    ORD        138      733     6      0
   time_hour          
   &lt;dttm&gt;             
 1 2013-01-01 05:00:00
 2 2013-01-01 05:00:00
 3 2013-01-01 05:00:00
 4 2013-01-01 05:00:00
 5 2013-01-01 06:00:00
 6 2013-01-01 05:00:00
 7 2013-01-01 06:00:00
 8 2013-01-01 06:00:00
 9 2013-01-01 06:00:00
10 2013-01-01 06:00:00
# … with 336,766 more rows</code></pre>
</div>
</div>
<p>Here we see the <strong>pipe operator</strong> <code>%&gt;%</code> pipes the output from previous command to the (first) argument of the next command.</p>
<ul>
<li>To change the default print setting globally:
<ul>
<li><code>options(tibble.print_max = n, tibble.print_min = m)</code>: if more than <code>m</code> rows, print only <code>n</code> rows.</li>
<li><code>options(dplyr.print_min = Inf)</code>: print all row.</li>
<li><code>options(tibble.width = Inf)</code>: print all columns.</li>
</ul></li>
</ul>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<ul>
<li><p>Pandas by default displays 10 rows and limits the number of columns to the display area.</p></li>
<li><p>We can override this behavior by</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">"display.max_rows"</span>, <span class="dv">500</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">"display.max_columns"</span>, <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>By default DataFrames.jl limits the number of rows and columns when displaying a data frame in a Jupyter Notebook to 25 and 100, respectively. You can override this behavior by changing the values of the <code>ENV["DATAFRAMES_COLUMNS"]</code> and <code>ENV["DATAFRAMES_ROWS"]</code> variables to hold the maximum number of columns and rows of the output. All columns or rows will be printed if those numbers are equal or lower than 0.</p>
</div>
</div>
</div>
</section>
<section id="dplyr-basics" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="dplyr-basics"><span class="header-section-number">2</span> dplyr basics</h2>
<ul>
<li><p>Pick observations (rows) by their values: <code>filter()</code>.</p></li>
<li><p>Reorder the rows: <code>arrange()</code>.</p></li>
<li><p>Pick variables (columns) by their names: <code>select()</code>.</p></li>
<li><p>Create new variables with functions of existing variables: <code>mutate()</code>.</p></li>
<li><p>Collapse many values down to a single summary: <code>summarise()</code>.</p></li>
</ul>
<pre><code>verb          meaning
--------------------------------------------
filter()      subset observations (or rows)
arrange()     re-order the observations
distinct()    remove duplicate entries
select()      select variables (or columns)
mutate()      add new variables (or columns)
group_by()    aggregate
summarise()   reduce to a single row
left_join()   merge two data objects
collect()     force computation and bring data back into R</code></pre>
</section>
<section id="manipulate-rows-cases" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="manipulate-rows-cases"><span class="header-section-number">3</span> Manipulate rows (cases)</h2>
<section id="filter-rows-with-filter" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="filter-rows-with-filter"><span class="header-section-number">3.1</span> Filter rows with <code>filter()</code></h3>
<ul>
<li>Flights on Jan 1st:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same as filter(flights, month == 1 &amp; day == 1)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, month <span class="sc">==</span> <span class="dv">1</span>, day <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 842 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1      517        515       2     830     819      11 UA     
 2  2013     1     1      533        529       4     850     830      20 UA     
 3  2013     1     1      542        540       2     923     850      33 AA     
 4  2013     1     1      544        545      -1    1004    1022     -18 B6     
 5  2013     1     1      554        600      -6     812     837     -25 DL     
 6  2013     1     1      554        558      -4     740     728      12 UA     
 7  2013     1     1      555        600      -5     913     854      19 B6     
 8  2013     1     1      557        600      -3     709     723     -14 EV     
 9  2013     1     1      557        600      -3     838     846      -8 B6     
10  2013     1     1      558        600      -2     753     745       8 AA     
# … with 832 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>flights[(flights[<span class="st">'month'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (flights[<span class="st">'day'</span>] <span class="op">==</span> <span class="dv">1</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
0    2013      1    1     517.0             515        2.0     830.0   
1    2013      1    1     533.0             529        4.0     850.0   
2    2013      1    1     542.0             540        2.0     923.0   
3    2013      1    1     544.0             545       -1.0    1004.0   
4    2013      1    1     554.0             600       -6.0     812.0   
..    ...    ...  ...       ...             ...        ...       ...   
837  2013      1    1    2356.0            2359       -3.0     425.0   
838  2013      1    1       NaN            1630        NaN       NaN   
839  2013      1    1       NaN            1935        NaN       NaN   
840  2013      1    1       NaN            1500        NaN       NaN   
841  2013      1    1       NaN             600        NaN       NaN   

     sched_arr_time  arr_delay carrier  flight tailnum origin dest  air_time  \
0               819       11.0      UA    1545  N14228    EWR  IAH     227.0   
1               830       20.0      UA    1714  N24211    LGA  IAH     227.0   
2               850       33.0      AA    1141  N619AA    JFK  MIA     160.0   
3              1022      -18.0      B6     725  N804JB    JFK  BQN     183.0   
4               837      -25.0      DL     461  N668DN    LGA  ATL     116.0   
..              ...        ...     ...     ...     ...    ...  ...       ...   
837             437      -12.0      B6     727  N588JB    JFK  BQN     186.0   
838            1815        NaN      EV    4308  N18120    EWR  RDU       NaN   
839            2240        NaN      AA     791  N3EHAA    LGA  DFW       NaN   
840            1825        NaN      AA    1925  N3EVAA    LGA  MIA       NaN   
841             901        NaN      B6     125  N618JB    JFK  FLL       NaN   

     distance  hour  minute                 time_hour  
0        1400     5      15 2013-01-01 10:00:00+00:00  
1        1416     5      29 2013-01-01 10:00:00+00:00  
2        1089     5      40 2013-01-01 10:00:00+00:00  
3        1576     5      45 2013-01-01 10:00:00+00:00  
4         762     6       0 2013-01-01 11:00:00+00:00  
..        ...   ...     ...                       ...  
837      1576    23      59 2013-01-02 04:00:00+00:00  
838       416    16      30 2013-01-01 21:00:00+00:00  
839      1389    19      35 2013-01-02 00:00:00+00:00  
840      1096    15       0 2013-01-01 20:00:00+00:00  
841      1069     6       0 2013-01-01 11:00:00+00:00  

[842 rows x 19 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(row <span class="op">-&gt;</span> (row.month <span class="op">==</span> <span class="fl">1</span>) <span class="op">&amp;</span> (row.day <span class="op">==</span> <span class="fl">1</span>), flights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>842×19 DataFrame
 Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time  sch ⋯
     │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?    Int ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │  2013      1      1       517             515        2.0       830      ⋯
   2 │  2013      1      1       533             529        4.0       850
   3 │  2013      1      1       542             540        2.0       923
   4 │  2013      1      1       544             545       -1.0      1004
   5 │  2013      1      1       554             600       -6.0       812      ⋯
   6 │  2013      1      1       554             558       -4.0       740
   7 │  2013      1      1       555             600       -5.0       913
   8 │  2013      1      1       557             600       -3.0       709
  ⋮  │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮          ⋱
 836 │  2013      1      1      2353            2359       -6.0       425      ⋯
 837 │  2013      1      1      2353            2359       -6.0       418
 838 │  2013      1      1      2356            2359       -3.0       425
 839 │  2013      1      1   missing            1630  missing     missing
 840 │  2013      1      1   missing            1935  missing     missing      ⋯
 841 │  2013      1      1   missing            1500  missing     missing
 842 │  2013      1      1   missing             600  missing     missing
                                                 12 columns and 827 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Flights in Nov or Dec:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55,403 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013    11     1        5       2359       6     352     345       7 B6     
 2  2013    11     1       35       2250     105     123    2356      87 B6     
 3  2013    11     1      455        500      -5     641     651     -10 US     
 4  2013    11     1      539        545      -6     856     827      29 UA     
 5  2013    11     1      542        545      -3     831     855     -24 AA     
 6  2013    11     1      549        600     -11     912     923     -11 UA     
 7  2013    11     1      550        600     -10     705     659       6 US     
 8  2013    11     1      554        600      -6     659     701      -2 US     
 9  2013    11     1      554        600      -6     826     827      -1 DL     
10  2013    11     1      554        600      -6     749     751      -2 DL     
# … with 55,393 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>flights[(flights[<span class="st">'month'</span>] <span class="op">==</span> <span class="dv">11</span>) <span class="op">|</span> (flights[<span class="st">'month'</span>] <span class="op">==</span> <span class="dv">12</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
55893   2013     11    1       5.0            2359        6.0     352.0   
55894   2013     11    1      35.0            2250      105.0     123.0   
55895   2013     11    1     455.0             500       -5.0     641.0   
55896   2013     11    1     539.0             545       -6.0     856.0   
55897   2013     11    1     542.0             545       -3.0     831.0   
...      ...    ...  ...       ...             ...        ...       ...   
111291  2013     12   31       NaN             705        NaN       NaN   
111292  2013     12   31       NaN             825        NaN       NaN   
111293  2013     12   31       NaN            1615        NaN       NaN   
111294  2013     12   31       NaN             600        NaN       NaN   
111295  2013     12   31       NaN             830        NaN       NaN   

        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \
55893              345        7.0      B6     745  N568JB    JFK  PSE   
55894             2356       87.0      B6    1816  N353JB    JFK  SYR   
55895              651      -10.0      US    1895  N192UW    EWR  CLT   
55896              827       29.0      UA    1714  N38727    LGA  IAH   
55897              855      -24.0      AA    2243  N5CLAA    JFK  MIA   
...                ...        ...     ...     ...     ...    ...  ...   
111291             931        NaN      UA    1729     NaN    EWR  DEN   
111292            1029        NaN      US    1831     NaN    JFK  CLT   
111293            1800        NaN      MQ    3301  N844MQ    LGA  RDU   
111294             735        NaN      UA     219     NaN    EWR  ORD   
111295            1154        NaN      UA     443     NaN    JFK  LAX   

        air_time  distance  hour  minute                 time_hour  
55893      205.0      1617    23      59 2013-11-02 03:00:00+00:00  
55894       36.0       209    22      50 2013-11-02 02:00:00+00:00  
55895       88.0       529     5       0 2013-11-01 09:00:00+00:00  
55896      229.0      1416     5      45 2013-11-01 09:00:00+00:00  
55897      147.0      1089     5      45 2013-11-01 09:00:00+00:00  
...          ...       ...   ...     ...                       ...  
111291       NaN      1605     7       5 2013-12-31 12:00:00+00:00  
111292       NaN       541     8      25 2013-12-31 13:00:00+00:00  
111293       NaN       431    16      15 2013-12-31 21:00:00+00:00  
111294       NaN       719     6       0 2013-12-31 11:00:00+00:00  
111295       NaN      2475     8      30 2013-12-31 13:00:00+00:00  

[55403 rows x 19 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(row <span class="op">-&gt;</span> (row.month <span class="op">==</span> <span class="fl">11</span>) <span class="op">|</span> (row.month <span class="op">==</span> <span class="fl">12</span>), flights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>55403×19 DataFrame
   Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time  s ⋯
       │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?    I ⋯
───────┼────────────────────────────────────────────────────────────────────────
     1 │  2013     11      1         5            2359        6.0       352    ⋯
     2 │  2013     11      1        35            2250      105.0       123
     3 │  2013     11      1       455             500       -5.0       641
     4 │  2013     11      1       539             545       -6.0       856
     5 │  2013     11      1       542             545       -3.0       831    ⋯
     6 │  2013     11      1       549             600      -11.0       912
     7 │  2013     11      1       550             600      -10.0       705
     8 │  2013     11      1       554             600       -6.0       659
   ⋮   │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮        ⋱
 55397 │  2013     12     31   missing            1430  missing     missing    ⋯
 55398 │  2013     12     31   missing             855  missing     missing
 55399 │  2013     12     31   missing             705  missing     missing
 55400 │  2013     12     31   missing             825  missing     missing
 55401 │  2013     12     31   missing            1615  missing     missing    ⋯
 55402 │  2013     12     31   missing             600  missing     missing
 55403 │  2013     12     31   missing             830  missing     missing
                                               12 columns and 55388 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="remove-rows-with-duplicate-values" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="remove-rows-with-duplicate-values"><span class="header-section-number">3.2</span> Remove rows with duplicate values</h3>
<ul>
<li>One row from each month:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>(flights, month, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1      517        515       2     830     819      11 UA     
 2  2013    10     1      447        500     -13     614     648     -34 US     
 3  2013    11     1        5       2359       6     352     345       7 B6     
 4  2013    12     1       13       2359      14     446     445       1 B6     
 5  2013     2     1      456        500      -4     652     648       4 US     
 6  2013     3     1        4       2159     125     318      56     142 B6     
 7  2013     4     1      454        500      -6     636     640      -4 US     
 8  2013     5     1        9       1655     434     308    2020     408 VX     
 9  2013     6     1        2       2359       3     341     350      -9 B6     
10  2013     7     1        1       2029     212     236    2359     157 B6     
11  2013     8     1       12       2130     162     257      14     163 B6     
12  2013     9     1        9       2359      10     343     340       3 B6     
# … with 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#   dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,
#   time_hour &lt;dttm&gt;, and abbreviated variable names ¹​sched_dep_time,
#   ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<ul>
<li>With <code>.keep_all = FALSE</code>, only distinct values of the variable are selected:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>(flights, month)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 1
   month
   &lt;int&gt;
 1     1
 2    10
 3    11
 4    12
 5     2
 6     3
 7     4
 8     5
 9     6
10     7
11     8
12     9</code></pre>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>flights.drop_duplicates(subset <span class="op">=</span> [<span class="st">'month'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
0       2013      1    1     517.0             515        2.0     830.0   
27004   2013     10    1     447.0             500      -13.0     614.0   
55893   2013     11    1       5.0            2359        6.0     352.0   
83161   2013     12    1      13.0            2359       14.0     446.0   
111296  2013      2    1     456.0             500       -4.0     652.0   
136247  2013      3    1       4.0            2159      125.0     318.0   
165081  2013      4    1     454.0             500       -6.0     636.0   
193411  2013      5    1       9.0            1655      434.0     308.0   
222207  2013      6    1       2.0            2359        3.0     341.0   
250450  2013      7    1       1.0            2029      212.0     236.0   
279875  2013      8    1      12.0            2130      162.0     257.0   
309202  2013      9    1       9.0            2359       10.0     343.0   

        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \
0                  819       11.0      UA    1545  N14228    EWR  IAH   
27004              648      -34.0      US    1877  N538UW    EWR  CLT   
55893              345        7.0      B6     745  N568JB    JFK  PSE   
83161              445        1.0      B6     745  N715JB    JFK  PSE   
111296             648        4.0      US    1117  N197UW    EWR  CLT   
136247              56      142.0      B6      11  N706JB    JFK  FLL   
165081             640       -4.0      US    1843  N566UW    EWR  CLT   
193411            2020      408.0      VX     413  N628VA    JFK  LAX   
222207             350       -9.0      B6     739  N618JB    JFK  PSE   
250450            2359      157.0      B6     915  N653JB    JFK  SFO   
279875              14      163.0      B6    1371  N618JB    LGA  FLL   
309202             340        3.0      B6     839  N663JB    JFK  BQN   

        air_time  distance  hour  minute                 time_hour  
0          227.0      1400     5      15 2013-01-01 10:00:00+00:00  
27004       69.0       529     5       0 2013-10-01 09:00:00+00:00  
55893      205.0      1617    23      59 2013-11-02 03:00:00+00:00  
83161      195.0      1617    23      59 2013-12-02 04:00:00+00:00  
111296      98.0       529     5       0 2013-02-01 10:00:00+00:00  
136247     166.0      1069    21      59 2013-03-02 02:00:00+00:00  
165081      84.0       529     5       0 2013-04-01 09:00:00+00:00  
193411     341.0      2475    16      55 2013-05-01 20:00:00+00:00  
222207     200.0      1617    23      59 2013-06-02 03:00:00+00:00  
250450     315.0      2586    20      29 2013-07-02 00:00:00+00:00  
279875     149.0      1076    21      30 2013-08-02 01:00:00+00:00  
309202     196.0      1576    23      59 2013-09-02 03:00:00+00:00  </code></pre>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(flights, <span class="op">:</span>month)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>12×19 DataFrame
 Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time  sch ⋯
     │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?    Int ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │  2013      1      1       517             515        2.0       830      ⋯
   2 │  2013     10      1       447             500      -13.0       614
   3 │  2013     11      1         5            2359        6.0       352
   4 │  2013     12      1        13            2359       14.0       446
   5 │  2013      2      1       456             500       -4.0       652      ⋯
   6 │  2013      3      1         4            2159      125.0       318
   7 │  2013      4      1       454             500       -6.0       636
   8 │  2013      5      1         9            1655      434.0       308
   9 │  2013      6      1         2            2359        3.0       341      ⋯
  10 │  2013      7      1         1            2029      212.0       236
  11 │  2013      8      1        12            2130      162.0       257
  12 │  2013      9      1         9            2359       10.0       343
                                                              12 columns omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sample-rows" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="sample-rows"><span class="header-section-number">3.3</span> Sample rows</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<ul>
<li>Randomly select <code>n</code> rows:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_n</span>(flights, <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013    10     9     2155       2123      32    2327    2321       6 EV     
 2  2013     3     3      728        729      -1    1017    1026      -9 B6     
 3  2013     5    11     1431       1433      -2    1531    1540      -9 EV     
 4  2013     7     2     1315       1315       0    1534    1607     -33 UA     
 5  2013     6    24      609        600       9     710     727     -17 UA     
 6  2013    11    26     1254       1244      10    1419    1357      22 EV     
 7  2013     4    15     1503       1511      -8    1723    1705      18 EV     
 8  2013     3    26     1155       1157      -2    1448    1450      -2 B6     
 9  2013     3    21     1724       1720       4    1912    1910       2 AA     
10  2013    10    29      856        900      -4    1233    1210      23 B6     
# … with 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#   dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,
#   time_hour &lt;dttm&gt;, and abbreviated variable names ¹​sched_dep_time,
#   ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<ul>
<li>Randomly select fraction of rows:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_frac</span>(flights, <span class="fl">0.1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33,678 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     3    14      608        610      -2     915     918      -3 B6     
 2  2013     5    11       NA       1910      NA      NA    2043      NA 9E     
 3  2013     1     2     2041       1942      59    2151    2106      45 EV     
 4  2013     5    16     1638       1409     149    1756    1517     159 B6     
 5  2013     2     6     1421       1400      21    1609    1559      10 EV     
 6  2013     3     8      917        910       7    1206    1032      94 B6     
 7  2013    11    29      723        730      -7     904     925     -21 DL     
 8  2013    11    10     2354       2359      -5     422     440     -18 B6     
 9  2013     7     2     1456       1500      -4    1731    1750     -19 AA     
10  2013     2    12     1459       1500      -1    1759    1837     -38 DL     
# … with 33,668 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>Sample <code>n=10</code> rows.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>flights.sample(n <span class="op">=</span> <span class="dv">10</span>, axis <span class="op">=</span> <span class="dv">0</span>, replace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
79035   2013     11   26     608.0             605        3.0     727.0   
94653   2013     12   13     859.0             900       -1.0    1226.0   
25151   2013      1   29    2156.0            2159       -3.0    2300.0   
188962  2013      4   26     754.0             755       -1.0    1040.0   
46606   2013     10   22     650.0             700      -10.0    1000.0   
62032   2013     11    7    1641.0            1645       -4.0    1913.0   
280822  2013      8    1       NaN            1545        NaN       NaN   
56379   2013     11    1    1424.0            1335       49.0    1539.0   
100616  2013     12   19    1903.0            1830       33.0    2126.0   
87298   2013     12    5     848.0             850       -2.0    1225.0   

        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \
79035              730       -3.0      WN    1284  N266WN    EWR  MDW   
94653             1206       20.0      B6    1701  N527JB    JFK  FLL   
25151             2306       -6.0      EV    4322  N12175    EWR  PWM   
188962            1007       33.0      9E    3879  N826AY    EWR  CVG   
46606              949       11.0      B6     683  N618JB    JFK  MCO   
62032             1916       -3.0      DL     884  N315NB    LGA  DEN   
280822            1906        NaN      DL    1982  N918DE    LGA  MIA   
56379             1500       39.0      WN       1  N796SW    LGA  MDW   
100616            2107       19.0      DL     404  N3772H    JFK  ATL   
87298             1132       53.0      UA    1643  N13138    EWR  DEN   

        air_time  distance  hour  minute                 time_hour  
79035      125.0       711     6       5 2013-11-26 11:00:00+00:00  
94653      159.0      1069     9       0 2013-12-13 14:00:00+00:00  
25151       48.0       284    21      59 2013-01-30 02:00:00+00:00  
188962      94.0       569     7      55 2013-04-26 11:00:00+00:00  
46606      147.0       944     7       0 2013-10-22 11:00:00+00:00  
62032      234.0      1620    16      45 2013-11-07 21:00:00+00:00  
280822       NaN      1096    15      45 2013-08-01 19:00:00+00:00  
56379      114.0       725    13      35 2013-11-01 17:00:00+00:00  
100616     108.0       760    18      30 2013-12-19 23:00:00+00:00  
87298      252.0      1605     8      50 2013-12-05 13:00:00+00:00  </code></pre>
</div>
</div>
<p>Sample 10% rows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>flights.sample(frac <span class="op">=</span> <span class="fl">0.1</span>, replace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
78527   2013     11   25    1352.0            1400       -8.0    1450.0   
278201  2013      7   30    1034.0            1035       -1.0    1150.0   
57430   2013     11    2    1725.0            1732       -7.0    1943.0   
272771  2013      7   24    1636.0            1630        6.0    1844.0   
29289   2013     10    3    1102.0            1110       -8.0    1410.0   
...      ...    ...  ...       ...             ...        ...       ...   
290548  2013      8   12     828.0             830       -2.0    1011.0   
300731  2013      8   22    1837.0            1722       75.0    1953.0   
248165  2013      6   28    1313.0            1315       -2.0    1601.0   
192837  2013      4   30    1156.0            1200       -4.0    1318.0   
235947  2013      6   15    1723.0            1700       23.0    1838.0   

        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \
78527             1515      -25.0      US    2183  N756US    LGA  DCA   
278201            1154       -4.0      B6    2602  N184JB    JFK  BUF   
57430             1959      -16.0      FL     623  N603AT    LGA  ATL   
272771            1839        5.0      DL    2231  N381DN    LGA  DTW   
29289             1431      -21.0      9E    3493  N926XJ    LGA  SRQ   
...                ...        ...     ...     ...     ...    ...  ...   
290548            1010        1.0      9E    3521  N604LR    JFK  ORD   
300731            1858       55.0      B6      86  N216JB    JFK  ROC   
248165            1558        3.0      B6     553  N206JB    JFK  PBI   
192837            1310        8.0      US    2126  N959UW    LGA  BOS   
235947            1845       -7.0      MQ    3216  N638MQ    JFK  ORF   

        air_time  distance  hour  minute                 time_hour  
78527       39.0       214    14       0 2013-11-25 19:00:00+00:00  
278201      54.0       301    10      35 2013-07-30 14:00:00+00:00  
57430      120.0       762    17      32 2013-11-02 21:00:00+00:00  
272771      81.0       502    16      30 2013-07-24 20:00:00+00:00  
29289      150.0      1047    11      10 2013-10-03 15:00:00+00:00  
...          ...       ...   ...     ...                       ...  
290548     120.0       740     8      30 2013-08-12 12:00:00+00:00  
300731      51.0       264    17      22 2013-08-22 21:00:00+00:00  
248165     142.0      1028    13      15 2013-06-28 17:00:00+00:00  
192837      37.0       184    12       0 2013-04-30 16:00:00+00:00  
235947      46.0       290    17       0 2013-06-15 21:00:00+00:00  

[33678 rows x 19 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<p>I’m not sure whether there’s a native function in DataFrames.jl for sampling.</p>
<p>Sample 10 rows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>rowidx <span class="op">=</span> StatsBase.<span class="fu">sample</span>(<span class="fl">1</span><span class="op">:</span><span class="fu">nrow</span>(flights), <span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">true</span>);</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>flights[rowidx, <span class="op">:</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10×19 DataFrame
 Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time  sch ⋯
     │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?    Int ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │  2013     11     18      1426            1429       -3.0      1632      ⋯
   2 │  2013     11     15       902             906       -4.0      1049
   3 │  2013      6      3      1433            1435       -2.0      1557
   4 │  2013     10     30      1527            1529       -2.0      1656
   5 │  2013      9     16      1801            1810       -9.0      2010      ⋯
   6 │  2013      5     10      1649            1415      154.0      1815
   7 │  2013      3     13      1506            1512       -6.0      1808
   8 │  2013      5     20       645             630       15.0       753
   9 │  2013      7     26      1709            1655       14.0      1959      ⋯
  10 │  2013      8     11      1454            1440       14.0      1624
                                                              12 columns omitted</code></pre>
</div>
</div>
<p>Sample 10% rows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>rowidx <span class="op">=</span> StatsBase.<span class="fu">sample</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1</span><span class="op">:</span><span class="fu">nrow</span>(flights), </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dt">Int</span>, <span class="fu">nrow</span>(flights) <span class="op">*</span> <span class="fl">0.1</span>), </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  replace <span class="op">=</span> <span class="cn">true</span>);</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>flights[rowidx, <span class="op">:</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>33678×19 DataFrame
   Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time  s ⋯
       │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?    I ⋯
───────┼────────────────────────────────────────────────────────────────────────
     1 │  2013      3      2       724             730       -6.0       832    ⋯
     2 │  2013      4     29       933             930        3.0      1214
     3 │  2013      9     18       815             815        0.0       941
     4 │  2013      7     26       812             815       -3.0       929
     5 │  2013     11      6      1923            1930       -7.0      2143    ⋯
     6 │  2013      9     28      1552            1545        7.0      1712
     7 │  2013      8     18      1646            1550       56.0      1818
     8 │  2013     10     26       812             815       -3.0       934
   ⋮   │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮        ⋱
 33672 │  2013     12     23      1453            1326       87.0      1553    ⋯
 33673 │  2013     12      9      1824            1714       70.0      1938
 33674 │  2013      3     21      1717            1645       32.0      1933
 33675 │  2013      1     10      1759            1722       37.0      1929
 33676 │  2013      1     11      1446            1444        2.0      1743    ⋯
 33677 │  2013      6     21      1104            1107       -3.0      1206
 33678 │  2013      6     11       946             945        1.0      1102
                                               12 columns and 33663 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="select-rows-by-position" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="select-rows-by-position"><span class="header-section-number">3.4</span> Select rows by position</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<ul>
<li>Select rows by position:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice</span>(flights, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 19
   year month   day dep_time sched_dep…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
  &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;       &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
1  2013     1     1      517         515       2     830     819      11 UA     
2  2013     1     1      533         529       4     850     830      20 UA     
3  2013     1     1      542         540       2     923     850      33 AA     
4  2013     1     1      544         545      -1    1004    1022     -18 B6     
5  2013     1     1      554         600      -6     812     837     -25 DL     
# … with 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#   dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,
#   time_hour &lt;dttm&gt;, and abbreviated variable names ¹​sched_dep_time,
#   ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<ul>
<li>First rows:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_head</span>(flights, <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 19
   year month   day dep_time sched_dep…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
  &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;       &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
1  2013     1     1      517         515       2     830     819      11 UA     
2  2013     1     1      533         529       4     850     830      20 UA     
3  2013     1     1      542         540       2     923     850      33 AA     
4  2013     1     1      544         545      -1    1004    1022     -18 B6     
5  2013     1     1      554         600      -6     812     837     -25 DL     
# … with 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#   dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,
#   time_hour &lt;dttm&gt;, and abbreviated variable names ¹​sched_dep_time,
#   ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<ul>
<li>Last rows:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_tail</span>(flights, <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 19
   year month   day dep_time sched_dep…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
  &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;       &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
1  2013     9    30       NA        1455      NA      NA    1634      NA 9E     
2  2013     9    30       NA        2200      NA      NA    2312      NA 9E     
3  2013     9    30       NA        1210      NA      NA    1330      NA MQ     
4  2013     9    30       NA        1159      NA      NA    1344      NA MQ     
5  2013     9    30       NA         840      NA      NA    1020      NA MQ     
# … with 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#   dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,
#   time_hour &lt;dttm&gt;, and abbreviated variable names ¹​sched_dep_time,
#   ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<ul>
<li>Top <code>n</code> rows with the highest values:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># deprecated: top_n(flights, 5, wt = time_hour)</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This function is quick</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_max</span>(flights, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">order_by =</span> time_hour)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 19
   year month   day dep_time sched_dep…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
  &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;       &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
1  2013    12    31       13        2359      14     439     437       2 B6     
2  2013    12    31       18        2359      19     449     444       5 DL     
3  2013    12    31     2328        2330      -2     412     409       3 B6     
4  2013    12    31     2355        2359      -4     430     440     -10 B6     
5  2013    12    31     2356        2359      -3     436     445      -9 B6     
# … with 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#   dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,
#   time_hour &lt;dttm&gt;, and abbreviated variable names ¹​sched_dep_time,
#   ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<ul>
<li>Bottom <code>n</code> rows with lowest values:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># deprecated: top_n(flights, -5, wt = time_hour)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Why it takes REALLY long???</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_max</span>(flights, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">order_by =</span> <span class="fu">desc</span>(time_hour)) <span class="co"># is fast</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 19
   year month   day dep_time sched_dep…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
  &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;       &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
1  2013     1     1      517         515       2     830     819      11 UA     
2  2013     1     1      533         529       4     850     830      20 UA     
3  2013     1     1      542         540       2     923     850      33 AA     
4  2013     1     1      544         545      -1    1004    1022     -18 B6     
5  2013     1     1      554         558      -4     740     728      12 UA     
6  2013     1     1      559         559       0     702     706      -4 B6     
# … with 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#   dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,
#   time_hour &lt;dttm&gt;, and abbreviated variable names ¹​sched_dep_time,
#   ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># slice_min(flights, n = 5, order_by = time_hour) # very slow</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>slice_*</code> verbs apply to groups for grouped tibbles.</li>
</ul>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<ul>
<li>Select rows by position:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>flights.iloc[<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">5</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
0  2013      1    1     517.0             515        2.0     830.0   
1  2013      1    1     533.0             529        4.0     850.0   
2  2013      1    1     542.0             540        2.0     923.0   
3  2013      1    1     544.0             545       -1.0    1004.0   
4  2013      1    1     554.0             600       -6.0     812.0   

   sched_arr_time  arr_delay carrier  flight tailnum origin dest  air_time  \
0             819       11.0      UA    1545  N14228    EWR  IAH     227.0   
1             830       20.0      UA    1714  N24211    LGA  IAH     227.0   
2             850       33.0      AA    1141  N619AA    JFK  MIA     160.0   
3            1022      -18.0      B6     725  N804JB    JFK  BQN     183.0   
4             837      -25.0      DL     461  N668DN    LGA  ATL     116.0   

   distance  hour  minute                 time_hour  
0      1400     5      15 2013-01-01 10:00:00+00:00  
1      1416     5      29 2013-01-01 10:00:00+00:00  
2      1089     5      40 2013-01-01 10:00:00+00:00  
3      1576     5      45 2013-01-01 10:00:00+00:00  
4       762     6       0 2013-01-01 11:00:00+00:00  </code></pre>
</div>
</div>
<ul>
<li>First rows:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>flights.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
0  2013      1    1     517.0             515        2.0     830.0   
1  2013      1    1     533.0             529        4.0     850.0   
2  2013      1    1     542.0             540        2.0     923.0   
3  2013      1    1     544.0             545       -1.0    1004.0   
4  2013      1    1     554.0             600       -6.0     812.0   

   sched_arr_time  arr_delay carrier  flight tailnum origin dest  air_time  \
0             819       11.0      UA    1545  N14228    EWR  IAH     227.0   
1             830       20.0      UA    1714  N24211    LGA  IAH     227.0   
2             850       33.0      AA    1141  N619AA    JFK  MIA     160.0   
3            1022      -18.0      B6     725  N804JB    JFK  BQN     183.0   
4             837      -25.0      DL     461  N668DN    LGA  ATL     116.0   

   distance  hour  minute                 time_hour  
0      1400     5      15 2013-01-01 10:00:00+00:00  
1      1416     5      29 2013-01-01 10:00:00+00:00  
2      1089     5      40 2013-01-01 10:00:00+00:00  
3      1576     5      45 2013-01-01 10:00:00+00:00  
4       762     6       0 2013-01-01 11:00:00+00:00  </code></pre>
</div>
</div>
<ul>
<li>Last rows:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>flights.tail(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
336771  2013      9   30       NaN            1455        NaN       NaN   
336772  2013      9   30       NaN            2200        NaN       NaN   
336773  2013      9   30       NaN            1210        NaN       NaN   
336774  2013      9   30       NaN            1159        NaN       NaN   
336775  2013      9   30       NaN             840        NaN       NaN   

        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \
336771            1634        NaN      9E    3393     NaN    JFK  DCA   
336772            2312        NaN      9E    3525     NaN    LGA  SYR   
336773            1330        NaN      MQ    3461  N535MQ    LGA  BNA   
336774            1344        NaN      MQ    3572  N511MQ    LGA  CLE   
336775            1020        NaN      MQ    3531  N839MQ    LGA  RDU   

        air_time  distance  hour  minute                 time_hour  
336771       NaN       213    14      55 2013-09-30 18:00:00+00:00  
336772       NaN       198    22       0 2013-10-01 02:00:00+00:00  
336773       NaN       764    12      10 2013-09-30 16:00:00+00:00  
336774       NaN       419    11      59 2013-09-30 15:00:00+00:00  
336775       NaN       431     8      40 2013-09-30 12:00:00+00:00  </code></pre>
</div>
</div>
<ul>
<li>Top <code>n</code> rows with the highest values:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>flights.nlargest(n <span class="op">=</span> <span class="dv">5</span>, columns <span class="op">=</span> <span class="st">'time_hour'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
110520  2013     12   31      13.0            2359       14.0     439.0   
110521  2013     12   31      18.0            2359       19.0     449.0   
111276  2013     12   31    2328.0            2330       -2.0     412.0   
111278  2013     12   31    2355.0            2359       -4.0     430.0   
111279  2013     12   31    2356.0            2359       -3.0     436.0   

        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \
110520             437        2.0      B6     839  N566JB    JFK  BQN   
110521             444        5.0      DL     412  N713TW    JFK  SJU   
111276             409        3.0      B6    1389  N651JB    EWR  SJU   
111278             440      -10.0      B6    1503  N509JB    JFK  SJU   
111279             445       -9.0      B6     745  N665JB    JFK  PSE   

        air_time  distance  hour  minute                 time_hour  
110520     189.0      1576    23      59 2014-01-01 04:00:00+00:00  
110521     192.0      1598    23      59 2014-01-01 04:00:00+00:00  
111276     198.0      1608    23      30 2014-01-01 04:00:00+00:00  
111278     195.0      1598    23      59 2014-01-01 04:00:00+00:00  
111279     200.0      1617    23      59 2014-01-01 04:00:00+00:00  </code></pre>
</div>
</div>
<ul>
<li>Bottom <code>n</code> rows with lowest values:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>flights.nsmallest(n <span class="op">=</span> <span class="dv">5</span>, columns <span class="op">=</span> <span class="st">'time_hour'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
0  2013      1    1     517.0             515        2.0     830.0   
1  2013      1    1     533.0             529        4.0     850.0   
2  2013      1    1     542.0             540        2.0     923.0   
3  2013      1    1     544.0             545       -1.0    1004.0   
5  2013      1    1     554.0             558       -4.0     740.0   

   sched_arr_time  arr_delay carrier  flight tailnum origin dest  air_time  \
0             819       11.0      UA    1545  N14228    EWR  IAH     227.0   
1             830       20.0      UA    1714  N24211    LGA  IAH     227.0   
2             850       33.0      AA    1141  N619AA    JFK  MIA     160.0   
3            1022      -18.0      B6     725  N804JB    JFK  BQN     183.0   
5             728       12.0      UA    1696  N39463    EWR  ORD     150.0   

   distance  hour  minute                 time_hour  
0      1400     5      15 2013-01-01 10:00:00+00:00  
1      1416     5      29 2013-01-01 10:00:00+00:00  
2      1089     5      40 2013-01-01 10:00:00+00:00  
3      1576     5      45 2013-01-01 10:00:00+00:00  
5       719     5      58 2013-01-01 10:00:00+00:00  </code></pre>
</div>
</div>
<p>I don’t think <code>nlargest</code> and <code>nsmallest</code> apply to grouped DataFrame. But I may be wrong.</p>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<ul>
<li>Select rows by position:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>flights[<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">:</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5×19 DataFrame
 Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time  sch ⋯
     │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?    Int ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │  2013      1      1       517             515        2.0       830      ⋯
   2 │  2013      1      1       533             529        4.0       850
   3 │  2013      1      1       542             540        2.0       923
   4 │  2013      1      1       544             545       -1.0      1004
   5 │  2013      1      1       554             600       -6.0       812      ⋯
                                                              12 columns omitted</code></pre>
</div>
</div>
<ul>
<li>First rows:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">first</span>(flights, <span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5×19 DataFrame
 Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time  sch ⋯
     │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?    Int ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │  2013      1      1       517             515        2.0       830      ⋯
   2 │  2013      1      1       533             529        4.0       850
   3 │  2013      1      1       542             540        2.0       923
   4 │  2013      1      1       544             545       -1.0      1004
   5 │  2013      1      1       554             600       -6.0       812      ⋯
                                                              12 columns omitted</code></pre>
</div>
</div>
<ul>
<li>Last rows:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">last</span>(flights, <span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5×19 DataFrame
 Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time  sch ⋯
     │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?    Int ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │  2013      9     30   missing            1455    missing   missing      ⋯
   2 │  2013      9     30   missing            2200    missing   missing
   3 │  2013      9     30   missing            1210    missing   missing
   4 │  2013      9     30   missing            1159    missing   missing
   5 │  2013      9     30   missing             840    missing   missing      ⋯
                                                              12 columns omitted</code></pre>
</div>
</div>
<ul>
<li>Top <code>n</code> rows with the highest values:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">last</span>(<span class="fu">sort</span>(flights, [<span class="op">:</span>time_hour]), <span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5×19 DataFrame
 Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time  sch ⋯
     │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?    Int ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │  2013     12     31        13            2359       14.0       439      ⋯
   2 │  2013     12     31        18            2359       19.0       449
   3 │  2013     12     31      2328            2330       -2.0       412
   4 │  2013     12     31      2355            2359       -4.0       430
   5 │  2013     12     31      2356            2359       -3.0       436      ⋯
                                                              12 columns omitted</code></pre>
</div>
</div>
<ul>
<li>Bottom <code>n</code> rows with lowest values:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">first</span>(<span class="fu">sort</span>(flights, [<span class="op">:</span>time_hour]), <span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5×19 DataFrame
 Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time  sch ⋯
     │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?    Int ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │  2013      1      1       517             515        2.0       830      ⋯
   2 │  2013      1      1       533             529        4.0       850
   3 │  2013      1      1       542             540        2.0       923
   4 │  2013      1      1       544             545       -1.0      1004
   5 │  2013      1      1       554             558       -4.0       740      ⋯
                                                              12 columns omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="arrange-rows-with-arrange" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="arrange-rows-with-arrange"><span class="header-section-number">3.5</span> Arrange rows with <code>arrange()</code></h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<ul>
<li>Sort in ascending order:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(flights, year, month, day)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1      517        515       2     830     819      11 UA     
 2  2013     1     1      533        529       4     850     830      20 UA     
 3  2013     1     1      542        540       2     923     850      33 AA     
 4  2013     1     1      544        545      -1    1004    1022     -18 B6     
 5  2013     1     1      554        600      -6     812     837     -25 DL     
 6  2013     1     1      554        558      -4     740     728      12 UA     
 7  2013     1     1      555        600      -5     913     854      19 B6     
 8  2013     1     1      557        600      -3     709     723     -14 EV     
 9  2013     1     1      557        600      -3     838     846      -8 B6     
10  2013     1     1      558        600      -2     753     745       8 AA     
# … with 336,766 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<p>Note input order matters!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(flights, day, month, year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1      517        515       2     830     819      11 UA     
 2  2013     1     1      533        529       4     850     830      20 UA     
 3  2013     1     1      542        540       2     923     850      33 AA     
 4  2013     1     1      544        545      -1    1004    1022     -18 B6     
 5  2013     1     1      554        600      -6     812     837     -25 DL     
 6  2013     1     1      554        558      -4     740     728      12 UA     
 7  2013     1     1      555        600      -5     913     854      19 B6     
 8  2013     1     1      557        600      -3     709     723     -14 EV     
 9  2013     1     1      557        600      -3     838     846      -8 B6     
10  2013     1     1      558        600      -2     753     745       8 AA     
# … with 336,766 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<ul>
<li>Sort in descending order:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(flights, <span class="fu">desc</span>(arr_delay)) <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     9      641            900      1301     1242           1530
 2  2013     6    15     1432           1935      1137     1607           2120
 3  2013     1    10     1121           1635      1126     1239           1810
 4  2013     9    20     1139           1845      1014     1457           2210
 5  2013     7    22      845           1600      1005     1044           1815
 6  2013     4    10     1100           1900       960     1342           2211
 7  2013     3    17     2321            810       911      135           1020
 8  2013     7    22     2257            759       898      121           1026
 9  2013    12     5      756           1700       896     1058           2020
10  2013     5     3     1133           2055       878     1250           2215
   arr_delay carrier flight tailnum origin dest  air_time distance  hour minute
       &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1      1272 HA          51 N384HA  JFK    HNL        640     4983     9      0
 2      1127 MQ        3535 N504MQ  JFK    CMH         74      483    19     35
 3      1109 MQ        3695 N517MQ  EWR    ORD        111      719    16     35
 4      1007 AA         177 N338AA  JFK    SFO        354     2586    18     45
 5       989 MQ        3075 N665MQ  JFK    CVG         96      589    16      0
 6       931 DL        2391 N959DL  JFK    TPA        139     1005    19      0
 7       915 DL        2119 N927DA  LGA    MSP        167     1020     8     10
 8       895 DL        2047 N6716C  LGA    ATL        109      762     7     59
 9       878 AA         172 N5DMAA  EWR    MIA        149     1085    17      0
10       875 MQ        3744 N523MQ  EWR    ORD        112      719    20     55
   time_hour          
   &lt;dttm&gt;             
 1 2013-01-09 09:00:00
 2 2013-06-15 19:00:00
 3 2013-01-10 16:00:00
 4 2013-09-20 18:00:00
 5 2013-07-22 16:00:00
 6 2013-04-10 19:00:00
 7 2013-03-17 08:00:00
 8 2013-07-22 07:00:00
 9 2013-12-05 17:00:00
10 2013-05-03 20:00:00
# … with 336,766 more rows</code></pre>
</div>
</div>
<ul>
<li>By default, <code>arrange</code> ignores grouping in grouped tibbles. Set <code>.by_group = TRUE</code> to arrange within each group.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What are the worst delays in each month?</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(arr_delay), <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
# Groups:   month [12]
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     9      641            900      1301     1242           1530
 2  2013     1    10     1121           1635      1126     1239           1810
 3  2013     1     1      848           1835       853     1001           1950
 4  2013     1    13     1809            810       599     2054           1042
 5  2013     1    16     1622            800       502     1911           1054
 6  2013     1    23     1551            753       478     1812           1006
 7  2013     1     1     2343           1724       379      314           1938
 8  2013     1    10     1525            900       385     1713           1039
 9  2013     1    25       15           1815       360      208           1958
10  2013     1     2     1607           1030       337     2003           1355
   arr_delay carrier flight tailnum origin dest  air_time distance  hour minute
       &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1      1272 HA          51 N384HA  JFK    HNL        640     4983     9      0
 2      1109 MQ        3695 N517MQ  EWR    ORD        111      719    16     35
 3       851 MQ        3944 N942MQ  JFK    BWI         41      184    18     35
 4       612 DL         269 N322NB  JFK    ATL        116      760     8     10
 5       497 B6         517 N661JB  EWR    MCO        144      937     8      0
 6       486 DL        2119 N326NB  LGA    MSP        166     1020     7     53
 7       456 EV        4321 N21197  EWR    MCI        222     1092    17     24
 8       394 UA         544 N419UA  LGA    ORD        123      733     9      0
 9       370 9E        4019 N8646A  JFK    RIC         56      288    18     15
10       368 AA         179 N324AA  JFK    SFO        346     2586    10     30
   time_hour          
   &lt;dttm&gt;             
 1 2013-01-09 09:00:00
 2 2013-01-10 16:00:00
 3 2013-01-01 18:00:00
 4 2013-01-13 08:00:00
 5 2013-01-16 08:00:00
 6 2013-01-23 07:00:00
 7 2013-01-01 17:00:00
 8 2013-01-10 09:00:00
 9 2013-01-25 18:00:00
10 2013-01-02 10:00:00
# … with 336,766 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<ul>
<li>Sort in ascending order:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>flights.sort_values(by <span class="op">=</span> <span class="st">'arr_delay'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
199668  2013      5    7    1715.0            1729      -14.0    1944.0   
211124  2013      5   20     719.0             735      -16.0     951.0   
198763  2013      5    6    1826.0            1830       -4.0    2045.0   
195236  2013      5    2    1947.0            1949       -2.0    2209.0   
196935  2013      5    4    1816.0            1820       -4.0    2017.0   
...      ...    ...  ...       ...             ...        ...       ...   
336771  2013      9   30       NaN            1455        NaN       NaN   
336772  2013      9   30       NaN            2200        NaN       NaN   
336773  2013      9   30       NaN            1210        NaN       NaN   
336774  2013      9   30       NaN            1159        NaN       NaN   
336775  2013      9   30       NaN             840        NaN       NaN   

        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \
199668            2110      -86.0      VX     193  N843VA    EWR  SFO   
211124            1110      -79.0      VX      11  N840VA    JFK  SFO   
198763            2200      -75.0      AA     269  N3KCAA    JFK  SEA   
195236            2324      -75.0      UA     612  N851UA    EWR  LAX   
196935            2131      -74.0      AS       7  N551AS    EWR  SEA   
...                ...        ...     ...     ...     ...    ...  ...   
336771            1634        NaN      9E    3393     NaN    JFK  DCA   
336772            2312        NaN      9E    3525     NaN    LGA  SYR   
336773            1330        NaN      MQ    3461  N535MQ    LGA  BNA   
336774            1344        NaN      MQ    3572  N511MQ    LGA  CLE   
336775            1020        NaN      MQ    3531  N839MQ    LGA  RDU   

        air_time  distance  hour  minute                 time_hour  
199668     315.0      2565    17      29 2013-05-07 21:00:00+00:00  
211124     316.0      2586     7      35 2013-05-20 11:00:00+00:00  
198763     289.0      2422    18      30 2013-05-06 22:00:00+00:00  
195236     300.0      2454    19      49 2013-05-02 23:00:00+00:00  
196935     281.0      2402    18      20 2013-05-04 22:00:00+00:00  
...          ...       ...   ...     ...                       ...  
336771       NaN       213    14      55 2013-09-30 18:00:00+00:00  
336772       NaN       198    22       0 2013-10-01 02:00:00+00:00  
336773       NaN       764    12      10 2013-09-30 16:00:00+00:00  
336774       NaN       419    11      59 2013-09-30 15:00:00+00:00  
336775       NaN       431     8      40 2013-09-30 12:00:00+00:00  

[336776 rows x 19 columns]</code></pre>
</div>
</div>
<ul>
<li>Sort in descending order:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>flights.sort_values(</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  by <span class="op">=</span> <span class="st">'arr_delay'</span>,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  ascending <span class="op">=</span> <span class="va">False</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
7072    2013      1    9     641.0             900     1301.0    1242.0   
235778  2013      6   15    1432.0            1935     1137.0    1607.0   
8239    2013      1   10    1121.0            1635     1126.0    1239.0   
327043  2013      9   20    1139.0            1845     1014.0    1457.0   
270376  2013      7   22     845.0            1600     1005.0    1044.0   
...      ...    ...  ...       ...             ...        ...       ...   
336771  2013      9   30       NaN            1455        NaN       NaN   
336772  2013      9   30       NaN            2200        NaN       NaN   
336773  2013      9   30       NaN            1210        NaN       NaN   
336774  2013      9   30       NaN            1159        NaN       NaN   
336775  2013      9   30       NaN             840        NaN       NaN   

        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \
7072              1530     1272.0      HA      51  N384HA    JFK  HNL   
235778            2120     1127.0      MQ    3535  N504MQ    JFK  CMH   
8239              1810     1109.0      MQ    3695  N517MQ    EWR  ORD   
327043            2210     1007.0      AA     177  N338AA    JFK  SFO   
270376            1815      989.0      MQ    3075  N665MQ    JFK  CVG   
...                ...        ...     ...     ...     ...    ...  ...   
336771            1634        NaN      9E    3393     NaN    JFK  DCA   
336772            2312        NaN      9E    3525     NaN    LGA  SYR   
336773            1330        NaN      MQ    3461  N535MQ    LGA  BNA   
336774            1344        NaN      MQ    3572  N511MQ    LGA  CLE   
336775            1020        NaN      MQ    3531  N839MQ    LGA  RDU   

        air_time  distance  hour  minute                 time_hour  
7072       640.0      4983     9       0 2013-01-09 14:00:00+00:00  
235778      74.0       483    19      35 2013-06-15 23:00:00+00:00  
8239       111.0       719    16      35 2013-01-10 21:00:00+00:00  
327043     354.0      2586    18      45 2013-09-20 22:00:00+00:00  
270376      96.0       589    16       0 2013-07-22 20:00:00+00:00  
...          ...       ...   ...     ...                       ...  
336771       NaN       213    14      55 2013-09-30 18:00:00+00:00  
336772       NaN       198    22       0 2013-10-01 02:00:00+00:00  
336773       NaN       764    12      10 2013-09-30 16:00:00+00:00  
336774       NaN       419    11      59 2013-09-30 15:00:00+00:00  
336775       NaN       431     8      40 2013-09-30 12:00:00+00:00  

[336776 rows x 19 columns]</code></pre>
</div>
</div>
<ul>
<li>To sort within groups (<code>month</code>)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>flights.sort_values(</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  by <span class="op">=</span> [<span class="st">'month'</span>, <span class="st">'arr_delay'</span>],</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  ascending <span class="op">=</span> [<span class="va">True</span>, <span class="va">False</span>]</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
7072    2013      1    9     641.0             900     1301.0    1242.0   
8239    2013      1   10    1121.0            1635     1126.0    1239.0   
151     2013      1    1     848.0            1835      853.0    1001.0   
11063   2013      1   13    1809.0             810      599.0    2054.0   
13654   2013      1   16    1622.0             800      502.0    1911.0   
...      ...    ...  ...       ...             ...        ...       ...   
111291  2013     12   31       NaN             705        NaN       NaN   
111292  2013     12   31       NaN             825        NaN       NaN   
111293  2013     12   31       NaN            1615        NaN       NaN   
111294  2013     12   31       NaN             600        NaN       NaN   
111295  2013     12   31       NaN             830        NaN       NaN   

        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \
7072              1530     1272.0      HA      51  N384HA    JFK  HNL   
8239              1810     1109.0      MQ    3695  N517MQ    EWR  ORD   
151               1950      851.0      MQ    3944  N942MQ    JFK  BWI   
11063             1042      612.0      DL     269  N322NB    JFK  ATL   
13654             1054      497.0      B6     517  N661JB    EWR  MCO   
...                ...        ...     ...     ...     ...    ...  ...   
111291             931        NaN      UA    1729     NaN    EWR  DEN   
111292            1029        NaN      US    1831     NaN    JFK  CLT   
111293            1800        NaN      MQ    3301  N844MQ    LGA  RDU   
111294             735        NaN      UA     219     NaN    EWR  ORD   
111295            1154        NaN      UA     443     NaN    JFK  LAX   

        air_time  distance  hour  minute                 time_hour  
7072       640.0      4983     9       0 2013-01-09 14:00:00+00:00  
8239       111.0       719    16      35 2013-01-10 21:00:00+00:00  
151         41.0       184    18      35 2013-01-01 23:00:00+00:00  
11063      116.0       760     8      10 2013-01-13 13:00:00+00:00  
13654      144.0       937     8       0 2013-01-16 13:00:00+00:00  
...          ...       ...   ...     ...                       ...  
111291       NaN      1605     7       5 2013-12-31 12:00:00+00:00  
111292       NaN       541     8      25 2013-12-31 13:00:00+00:00  
111293       NaN       431    16      15 2013-12-31 21:00:00+00:00  
111294       NaN       719     6       0 2013-12-31 11:00:00+00:00  
111295       NaN      2475     8      30 2013-12-31 13:00:00+00:00  

[336776 rows x 19 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<p>Sort in ascending order:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(flights, [<span class="op">:</span>arr_delay])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×19 DataFrame
    Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time   ⋯
        │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?     ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      5      7      1715            1729      -14.0      1944   ⋯
      2 │  2013      5     20       719             735      -16.0       951
      3 │  2013      5      2      1947            1949       -2.0      2209
      4 │  2013      5      6      1826            1830       -4.0      2045
      5 │  2013      5      4      1816            1820       -4.0      2017   ⋯
      6 │  2013      5      2      1926            1929       -3.0      2157
      7 │  2013      5      6      1753            1755       -2.0      2004
      8 │  2013      5      7      2054            2055       -1.0      2317
   ⋮    │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮       ⋱
 336770 │  2013      9     30       559             600       -1.0   missing   ⋯
 336771 │  2013      9     30   missing            1842  missing     missing
 336772 │  2013      9     30   missing            1455  missing     missing
 336773 │  2013      9     30   missing            2200  missing     missing
 336774 │  2013      9     30   missing            1210  missing     missing   ⋯
 336775 │  2013      9     30   missing            1159  missing     missing
 336776 │  2013      9     30   missing             840  missing     missing
                                              12 columns and 336761 rows omitted</code></pre>
</div>
</div>
<p>Sort in descending order:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(flights, [<span class="op">:</span>arr_delay], rev <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×19 DataFrame
    Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time   ⋯
        │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?     ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      1      1      1525            1530       -5.0      1934   ⋯
      2 │  2013      1      1      1528            1459       29.0      2002
      3 │  2013      1      1      1740            1745       -5.0      2158
      4 │  2013      1      1      1807            1738       29.0      2251
      5 │  2013      1      1      1939            1840       59.0        29   ⋯
      6 │  2013      1      1      1952            1930       22.0      2358
      7 │  2013      1      1      2016            1930       46.0   missing
      8 │  2013      1      1   missing            1630  missing     missing
   ⋮    │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮       ⋱
 336770 │  2013      5     13       657             700       -3.0       908   ⋯
 336771 │  2013      5      2      1926            1929       -3.0      2157
 336772 │  2013      5      4      1816            1820       -4.0      2017
 336773 │  2013      5      2      1947            1949       -2.0      2209
 336774 │  2013      5      6      1826            1830       -4.0      2045   ⋯
 336775 │  2013      5     20       719             735      -16.0       951
 336776 │  2013      5      7      1715            1729      -14.0      1944
                                              12 columns and 336761 rows omitted</code></pre>
</div>
</div>
<p>To sort within groups (<code>month</code>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(flights, [<span class="op">:</span>month, <span class="fu">order</span>(<span class="op">:</span>arr_delay, rev<span class="op">=</span> <span class="cn">true</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×19 DataFrame
    Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time   ⋯
        │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?     ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      1      1      1525            1530       -5.0      1934   ⋯
      2 │  2013      1      1      1528            1459       29.0      2002
      3 │  2013      1      1      1740            1745       -5.0      2158
      4 │  2013      1      1      1807            1738       29.0      2251
      5 │  2013      1      1      1939            1840       59.0        29   ⋯
      6 │  2013      1      1      1952            1930       22.0      2358
      7 │  2013      1      1      2016            1930       46.0   missing
      8 │  2013      1      1   missing            1630  missing     missing
   ⋮    │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮       ⋱
 336770 │  2013     12     28       625             630       -5.0       916   ⋯
 336771 │  2013     12     29       818             830      -12.0      1056
 336772 │  2013     12     29      1017            1025       -8.0      1304
 336773 │  2013     12     27      1622            1630       -8.0      1908
 336774 │  2013     12     27      1728            1729       -1.0      2011   ⋯
 336775 │  2013     12     27      1833            1836       -3.0      2050
 336776 │  2013     12     27       853             856       -3.0      1052
                                              12 columns and 336761 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="manipulate-columns-variables" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="manipulate-columns-variables"><span class="header-section-number">4</span> Manipulate columns (variables)</h2>
<section id="select-columns-with-select" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="select-columns-with-select"><span class="header-section-number">4.1</span> Select columns with <code>select()</code></h3>
<ul>
<li>Select columns by variable names:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, year, month, day)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 3
    year month   day
   &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1  2013     1     1
 2  2013     1     1
 3  2013     1     1
 4  2013     1     1
 5  2013     1     1
 6  2013     1     1
 7  2013     1     1
 8  2013     1     1
 9  2013     1     1
10  2013     1     1
# … with 336,766 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>flights[[<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day
0       2013      1    1
1       2013      1    1
2       2013      1    1
3       2013      1    1
4       2013      1    1
...      ...    ...  ...
336771  2013      9   30
336772  2013      9   30
336773  2013      9   30
336774  2013      9   30
336775  2013      9   30

[336776 rows x 3 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, [<span class="op">:</span>year, <span class="op">:</span>month, <span class="op">:</span>day])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×3 DataFrame
    Row │ year   month  day
        │ Int64  Int64  Int64
────────┼─────────────────────
      1 │  2013      1      1
      2 │  2013      1      1
      3 │  2013      1      1
      4 │  2013      1      1
      5 │  2013      1      1
      6 │  2013      1      1
      7 │  2013      1      1
      8 │  2013      1      1
   ⋮    │   ⋮      ⋮      ⋮
 336770 │  2013      9     30
 336771 │  2013      9     30
 336772 │  2013      9     30
 336773 │  2013      9     30
 336774 │  2013      9     30
 336775 │  2013      9     30
 336776 │  2013      9     30
           336761 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Pull values of <em>one</em> column as a vector:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>Not displayed because the vector is long.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pull</span>(flights, year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Following are same</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>flights.year</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>flights.loc[:, <span class="st">'year'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Return a vector</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>flights.year</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Return a vector</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>flights.<span class="st">"year"</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Return a vector</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>flights[!, <span class="op">:</span>year] <span class="co"># does not make a copy</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Return a vector</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>flights[!, <span class="st">"year"</span>] <span class="co"># does not make a copy</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Return a vector</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>flights[<span class="op">:</span>, <span class="op">:</span>year] <span class="co"># make a copy!</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Return a vector</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>flights[<span class="op">:</span>, <span class="st">"year"</span>] <span class="co"># make a copy!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<ul>
<li>Select columns between two variables:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, year<span class="sc">:</span>day)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 3
    year month   day
   &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1  2013     1     1
 2  2013     1     1
 3  2013     1     1
 4  2013     1     1
 5  2013     1     1
 6  2013     1     1
 7  2013     1     1
 8  2013     1     1
 9  2013     1     1
10  2013     1     1
# … with 336,766 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>flights.loc[:, <span class="st">'year'</span>:<span class="st">'day'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day
0       2013      1    1
1       2013      1    1
2       2013      1    1
3       2013      1    1
4       2013      1    1
...      ...    ...  ...
336771  2013      9   30
336772  2013      9   30
336773  2013      9   30
336774  2013      9   30
336775  2013      9   30

[336776 rows x 3 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="fu">Between</span>(<span class="op">:</span>year, <span class="op">:</span>day))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×3 DataFrame
    Row │ year   month  day
        │ Int64  Int64  Int64
────────┼─────────────────────
      1 │  2013      1      1
      2 │  2013      1      1
      3 │  2013      1      1
      4 │  2013      1      1
      5 │  2013      1      1
      6 │  2013      1      1
      7 │  2013      1      1
      8 │  2013      1      1
   ⋮    │   ⋮      ⋮      ⋮
 336770 │  2013      9     30
 336771 │  2013      9     30
 336772 │  2013      9     30
 336773 │  2013      9     30
 336774 │  2013      9     30
 336775 │  2013      9     30
 336776 │  2013      9     30
           336761 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Select all columns <em>except</em> those between two variables:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="sc">-</span>(year<span class="sc">:</span>day))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 16
   dep_t…¹ sched…² dep_d…³ arr_t…⁴ sched…⁵ arr_d…⁶ carrier flight tailnum origin
     &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; 
 1     517     515       2     830     819      11 UA        1545 N14228  EWR   
 2     533     529       4     850     830      20 UA        1714 N24211  LGA   
 3     542     540       2     923     850      33 AA        1141 N619AA  JFK   
 4     544     545      -1    1004    1022     -18 B6         725 N804JB  JFK   
 5     554     600      -6     812     837     -25 DL         461 N668DN  LGA   
 6     554     558      -4     740     728      12 UA        1696 N39463  EWR   
 7     555     600      -5     913     854      19 B6         507 N516JB  EWR   
 8     557     600      -3     709     723     -14 EV        5708 N829AS  LGA   
 9     557     600      -3     838     846      -8 B6          79 N593JB  JFK   
10     558     600      -2     753     745       8 AA         301 N3ALAA  LGA   
# … with 336,766 more rows, 6 more variables: dest &lt;chr&gt;, air_time &lt;dbl&gt;,
#   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated
#   variable names ¹​dep_time, ²​sched_dep_time, ³​dep_delay, ⁴​arr_time,
#   ⁵​sched_arr_time, ⁶​arr_delay</code></pre>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>flights.drop(flights.loc[:, <span class="st">'year'</span>:<span class="st">'day'</span>].columns, axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        dep_time  sched_dep_time  dep_delay  arr_time  sched_arr_time  \
0          517.0             515        2.0     830.0             819   
1          533.0             529        4.0     850.0             830   
2          542.0             540        2.0     923.0             850   
3          544.0             545       -1.0    1004.0            1022   
4          554.0             600       -6.0     812.0             837   
...          ...             ...        ...       ...             ...   
336771       NaN            1455        NaN       NaN            1634   
336772       NaN            2200        NaN       NaN            2312   
336773       NaN            1210        NaN       NaN            1330   
336774       NaN            1159        NaN       NaN            1344   
336775       NaN             840        NaN       NaN            1020   

        arr_delay carrier  flight tailnum origin dest  air_time  distance  \
0            11.0      UA    1545  N14228    EWR  IAH     227.0      1400   
1            20.0      UA    1714  N24211    LGA  IAH     227.0      1416   
2            33.0      AA    1141  N619AA    JFK  MIA     160.0      1089   
3           -18.0      B6     725  N804JB    JFK  BQN     183.0      1576   
4           -25.0      DL     461  N668DN    LGA  ATL     116.0       762   
...           ...     ...     ...     ...    ...  ...       ...       ...   
336771        NaN      9E    3393     NaN    JFK  DCA       NaN       213   
336772        NaN      9E    3525     NaN    LGA  SYR       NaN       198   
336773        NaN      MQ    3461  N535MQ    LGA  BNA       NaN       764   
336774        NaN      MQ    3572  N511MQ    LGA  CLE       NaN       419   
336775        NaN      MQ    3531  N839MQ    LGA  RDU       NaN       431   

        hour  minute                 time_hour  
0          5      15 2013-01-01 10:00:00+00:00  
1          5      29 2013-01-01 10:00:00+00:00  
2          5      40 2013-01-01 10:00:00+00:00  
3          5      45 2013-01-01 10:00:00+00:00  
4          6       0 2013-01-01 11:00:00+00:00  
...      ...     ...                       ...  
336771    14      55 2013-09-30 18:00:00+00:00  
336772    22       0 2013-10-01 02:00:00+00:00  
336773    12      10 2013-09-30 16:00:00+00:00  
336774    11      59 2013-09-30 15:00:00+00:00  
336775     8      40 2013-09-30 12:00:00+00:00  

[336776 rows x 16 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="fu">Not</span>(<span class="fu">Between</span>(<span class="op">:</span>year, <span class="op">:</span>day)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×16 DataFrame
    Row │ dep_time  sched_dep_time  dep_delay  arr_time  sched_arr_time  arr_d ⋯
        │ Int64?    Int64           Float64?   Int64?    Int64           Float ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │      517             515        2.0       830             819        ⋯
      2 │      533             529        4.0       850             830
      3 │      542             540        2.0       923             850
      4 │      544             545       -1.0      1004            1022      -
      5 │      554             600       -6.0       812             837      - ⋯
      6 │      554             558       -4.0       740             728
      7 │      555             600       -5.0       913             854
      8 │      557             600       -3.0       709             723      -
   ⋮    │    ⋮            ⋮             ⋮         ⋮            ⋮             ⋮ ⋱
 336770 │     2349            2359      -10.0       325             350      - ⋯
 336771 │  missing            1842  missing     missing            2019  missi
 336772 │  missing            1455  missing     missing            1634  missi
 336773 │  missing            2200  missing     missing            2312  missi
 336774 │  missing            1210  missing     missing            1330  missi ⋯
 336775 │  missing            1159  missing     missing            1344  missi
 336776 │  missing             840  missing     missing            1020  missi
                                              11 columns and 336761 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Select columns by positions:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 5
    year   day sched_dep_time arr_time arr_delay
   &lt;int&gt; &lt;int&gt;          &lt;int&gt;    &lt;int&gt;     &lt;dbl&gt;
 1  2013     1            515      830        11
 2  2013     1            529      850        20
 3  2013     1            540      923        33
 4  2013     1            545     1004       -18
 5  2013     1            600      812       -25
 6  2013     1            558      740        12
 7  2013     1            600      913        19
 8  2013     1            600      709       -14
 9  2013     1            600      838        -8
10  2013     1            600      753         8
# … with 336,766 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>flights.iloc[:, <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">2</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  day  sched_dep_time  arr_time  arr_delay
0       2013    1             515     830.0       11.0
1       2013    1             529     850.0       20.0
2       2013    1             540     923.0       33.0
3       2013    1             545    1004.0      -18.0
4       2013    1             600     812.0      -25.0
...      ...  ...             ...       ...        ...
336771  2013   30            1455       NaN        NaN
336772  2013   30            2200       NaN        NaN
336773  2013   30            1210       NaN        NaN
336774  2013   30            1159       NaN        NaN
336775  2013   30             840       NaN        NaN

[336776 rows x 5 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">:</span><span class="fl">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×5 DataFrame
    Row │ year   day    sched_dep_time  arr_time  arr_delay
        │ Int64  Int64  Int64           Int64?    Float64?
────────┼───────────────────────────────────────────────────
      1 │  2013      1             515       830       11.0
      2 │  2013      1             529       850       20.0
      3 │  2013      1             540       923       33.0
      4 │  2013      1             545      1004      -18.0
      5 │  2013      1             600       812      -25.0
      6 │  2013      1             558       740       12.0
      7 │  2013      1             600       913       19.0
      8 │  2013      1             600       709      -14.0
   ⋮    │   ⋮      ⋮          ⋮            ⋮          ⋮
 336770 │  2013     30            2359       325      -25.0
 336771 │  2013     30            1842   missing  missing
 336772 │  2013     30            1455   missing  missing
 336773 │  2013     30            2200   missing  missing
 336774 │  2013     30            1210   missing  missing
 336775 │  2013     30            1159   missing  missing
 336776 │  2013     30             840   missing  missing
                                         336761 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Move variables to the start of data frame:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false" href="">Python (???)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, time_hour, air_time, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
   time_hour           air_t…¹  year month   day dep_t…² sched…³ dep_d…⁴ arr_t…⁵
   &lt;dttm&gt;                &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;
 1 2013-01-01 05:00:00     227  2013     1     1     517     515       2     830
 2 2013-01-01 05:00:00     227  2013     1     1     533     529       4     850
 3 2013-01-01 05:00:00     160  2013     1     1     542     540       2     923
 4 2013-01-01 05:00:00     183  2013     1     1     544     545      -1    1004
 5 2013-01-01 06:00:00     116  2013     1     1     554     600      -6     812
 6 2013-01-01 05:00:00     150  2013     1     1     554     558      -4     740
 7 2013-01-01 06:00:00     158  2013     1     1     555     600      -5     913
 8 2013-01-01 06:00:00      53  2013     1     1     557     600      -3     709
 9 2013-01-01 06:00:00     140  2013     1     1     557     600      -3     838
10 2013-01-01 06:00:00     138  2013     1     1     558     600      -2     753
# … with 336,766 more rows, 10 more variables: sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#   dest &lt;chr&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, and abbreviated
#   variable names ¹​air_time, ²​dep_time, ³​sched_dep_time, ⁴​dep_delay, ⁵​arr_time</code></pre>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<p>Not sure what’s the optimal way to do this.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note time_hour is missing in Python dataframe</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>cols_to_move <span class="op">=</span> [<span class="st">'arr_delay'</span>, <span class="st">'air_time'</span>]</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>flights[cols_to_move <span class="op">+</span> [x <span class="cf">for</span> x <span class="kw">in</span> flights.columns <span class="cf">if</span> x <span class="kw">not</span> <span class="kw">in</span> cols_to_move]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        arr_delay  air_time  year  month  day  dep_time  sched_dep_time  \
0            11.0     227.0  2013      1    1     517.0             515   
1            20.0     227.0  2013      1    1     533.0             529   
2            33.0     160.0  2013      1    1     542.0             540   
3           -18.0     183.0  2013      1    1     544.0             545   
4           -25.0     116.0  2013      1    1     554.0             600   
...           ...       ...   ...    ...  ...       ...             ...   
336771        NaN       NaN  2013      9   30       NaN            1455   
336772        NaN       NaN  2013      9   30       NaN            2200   
336773        NaN       NaN  2013      9   30       NaN            1210   
336774        NaN       NaN  2013      9   30       NaN            1159   
336775        NaN       NaN  2013      9   30       NaN             840   

        dep_delay  arr_time  sched_arr_time carrier  flight tailnum origin  \
0             2.0     830.0             819      UA    1545  N14228    EWR   
1             4.0     850.0             830      UA    1714  N24211    LGA   
2             2.0     923.0             850      AA    1141  N619AA    JFK   
3            -1.0    1004.0            1022      B6     725  N804JB    JFK   
4            -6.0     812.0             837      DL     461  N668DN    LGA   
...           ...       ...             ...     ...     ...     ...    ...   
336771        NaN       NaN            1634      9E    3393     NaN    JFK   
336772        NaN       NaN            2312      9E    3525     NaN    LGA   
336773        NaN       NaN            1330      MQ    3461  N535MQ    LGA   
336774        NaN       NaN            1344      MQ    3572  N511MQ    LGA   
336775        NaN       NaN            1020      MQ    3531  N839MQ    LGA   

       dest  distance  hour  minute                 time_hour  
0       IAH      1400     5      15 2013-01-01 10:00:00+00:00  
1       IAH      1416     5      29 2013-01-01 10:00:00+00:00  
2       MIA      1089     5      40 2013-01-01 10:00:00+00:00  
3       BQN      1576     5      45 2013-01-01 10:00:00+00:00  
4       ATL       762     6       0 2013-01-01 11:00:00+00:00  
...     ...       ...   ...     ...                       ...  
336771  DCA       213    14      55 2013-09-30 18:00:00+00:00  
336772  SYR       198    22       0 2013-10-01 02:00:00+00:00  
336773  BNA       764    12      10 2013-09-30 16:00:00+00:00  
336774  CLE       419    11      59 2013-09-30 15:00:00+00:00  
336775  RDU       431     8      40 2013-09-30 12:00:00+00:00  

[336776 rows x 19 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="op">:</span>time_hour, <span class="op">:</span>air_time, <span class="fu">Not</span>([<span class="op">:</span>time_hour, <span class="op">:</span>air_time]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×19 DataFrame
    Row │ time_hour            air_time   year   month  day    dep_time  sched ⋯
        │ DateTime             Float64?   Int64  Int64  Int64  Int64?    Int64 ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │ 2013-01-01T10:00:00      227.0   2013      1      1       517        ⋯
      2 │ 2013-01-01T10:00:00      227.0   2013      1      1       533
      3 │ 2013-01-01T10:00:00      160.0   2013      1      1       542
      4 │ 2013-01-01T10:00:00      183.0   2013      1      1       544
      5 │ 2013-01-01T11:00:00      116.0   2013      1      1       554        ⋯
      6 │ 2013-01-01T10:00:00      150.0   2013      1      1       554
      7 │ 2013-01-01T11:00:00      158.0   2013      1      1       555
      8 │ 2013-01-01T11:00:00       53.0   2013      1      1       557
   ⋮    │          ⋮               ⋮        ⋮      ⋮      ⋮       ⋮            ⋱
 336770 │ 2013-10-01T03:00:00      196.0   2013      9     30      2349        ⋯
 336771 │ 2013-09-30T22:00:00  missing     2013      9     30   missing
 336772 │ 2013-09-30T18:00:00  missing     2013      9     30   missing
 336773 │ 2013-10-01T02:00:00  missing     2013      9     30   missing
 336774 │ 2013-09-30T16:00:00  missing     2013      9     30   missing        ⋯
 336775 │ 2013-09-30T15:00:00  missing     2013      9     30   missing
 336776 │ 2013-09-30T12:00:00  missing     2013      9     30   missing
                                              13 columns and 336761 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li><p>Helper functions in <code>dplyr</code>.</p>
<ul>
<li><p><code>everying()</code>: matches all variables.</p></li>
<li><p><code>last_col()</code>: select last variable, possibly with an offset.</p></li>
<li><p><code>starts_with("abc")</code>: matches names that begin with “abc”.</p></li>
<li><p><code>ends_with("xyz")</code>: matches names that end with “xyz”.</p></li>
<li><p><code>contains("ijk")</code>: matches names that contain “ijk”.</p></li>
<li><p><code>matches("(.)\\1")</code>: selects variables that match a regular expression.</p></li>
<li><p><code>num_range("x", 1:3)</code>: matches x1, x2 and x3.</p></li>
<li><p><code>all_of()</code>: matches variables names in a character vector. All names must be present, otherwise an out-of-bounds error is thrown.</p></li>
<li><p><code>any_of()</code>: same as <code>all_of()</code>, but no error is thrown.</p></li>
</ul></li>
</ul>
</section>
<section id="add-new-variables-with-mutate" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="add-new-variables-with-mutate"><span class="header-section-number">4.2</span> Add new variables with <code>mutate()</code></h3>
<ul>
<li>A tibble with fewer columns.</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false" href="">Python (???)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>flights_sml <span class="ot">&lt;-</span> </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(flights, year<span class="sc">:</span>day, <span class="fu">ends_with</span>(<span class="st">"delay"</span>), distance, air_time)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>flights_sml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 7
    year month   day dep_delay arr_delay distance air_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2013     1     1         2        11     1400      227
 2  2013     1     1         4        20     1416      227
 3  2013     1     1         2        33     1089      160
 4  2013     1     1        -1       -18     1576      183
 5  2013     1     1        -6       -25      762      116
 6  2013     1     1        -4        12      719      150
 7  2013     1     1        -5        19     1065      158
 8  2013     1     1        -3       -14      229       53
 9  2013     1     1        -3        -8      944      140
10  2013     1     1        -2         8      733      138
# … with 336,766 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<p>Is there better way?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>] <span class="op">+</span> <span class="bu">list</span>(<span class="bu">filter</span>(re.<span class="bu">compile</span>(<span class="st">".*delay"</span>).match, flights.columns)) <span class="op">+</span> [<span class="st">'distance'</span>, <span class="st">'air_time'</span>]</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>flights_sml <span class="op">=</span> flights.loc[:, cols]</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>flights_sml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_delay  arr_delay  distance  air_time
0       2013      1    1        2.0       11.0      1400     227.0
1       2013      1    1        4.0       20.0      1416     227.0
2       2013      1    1        2.0       33.0      1089     160.0
3       2013      1    1       -1.0      -18.0      1576     183.0
4       2013      1    1       -6.0      -25.0       762     116.0
...      ...    ...  ...        ...        ...       ...       ...
336771  2013      9   30        NaN        NaN       213       NaN
336772  2013      9   30        NaN        NaN       198       NaN
336773  2013      9   30        NaN        NaN       764       NaN
336774  2013      9   30        NaN        NaN       419       NaN
336775  2013      9   30        NaN        NaN       431       NaN

[336776 rows x 7 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>flights_sml <span class="op">=</span> <span class="fu">select</span>(flights, <span class="fu">Between</span>(<span class="op">:</span>year, <span class="op">:</span>day), <span class="st">r"</span><span class="sc">.*</span><span class="st">delay</span><span class="sc">$</span><span class="st">", :</span>distance<span class="st">, :air_time</span><span class="ch">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×7 DataFrame
    Row │ year   month  day    dep_delay  arr_delay  distance  air_time
        │ Int64  Int64  Int64  Float64?   Float64?   Float64   Float64?
────────┼────────────────────────────────────────────────────────────────
      1 │  2013      1      1        2.0       11.0    1400.0      227.0
      2 │  2013      1      1        4.0       20.0    1416.0      227.0
      3 │  2013      1      1        2.0       33.0    1089.0      160.0
      4 │  2013      1      1       -1.0      -18.0    1576.0      183.0
      5 │  2013      1      1       -6.0      -25.0     762.0      116.0
      6 │  2013      1      1       -4.0       12.0     719.0      150.0
      7 │  2013      1      1       -5.0       19.0    1065.0      158.0
      8 │  2013      1      1       -3.0      -14.0     229.0       53.0
   ⋮    │   ⋮      ⋮      ⋮        ⋮          ⋮         ⋮          ⋮
 336770 │  2013      9     30      -10.0      -25.0    1617.0      196.0
 336771 │  2013      9     30  missing    missing       764.0  missing
 336772 │  2013      9     30  missing    missing       213.0  missing
 336773 │  2013      9     30  missing    missing       198.0  missing
 336774 │  2013      9     30  missing    missing       764.0  missing
 336775 │  2013      9     30  missing    missing       419.0  missing
 336776 │  2013      9     30  missing    missing       431.0  missing
                                                      336761 rows omitted</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>flights_sml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×7 DataFrame
    Row │ year   month  day    dep_delay  arr_delay  distance  air_time
        │ Int64  Int64  Int64  Float64?   Float64?   Float64   Float64?
────────┼────────────────────────────────────────────────────────────────
      1 │  2013      1      1        2.0       11.0    1400.0      227.0
      2 │  2013      1      1        4.0       20.0    1416.0      227.0
      3 │  2013      1      1        2.0       33.0    1089.0      160.0
      4 │  2013      1      1       -1.0      -18.0    1576.0      183.0
      5 │  2013      1      1       -6.0      -25.0     762.0      116.0
      6 │  2013      1      1       -4.0       12.0     719.0      150.0
      7 │  2013      1      1       -5.0       19.0    1065.0      158.0
      8 │  2013      1      1       -3.0      -14.0     229.0       53.0
   ⋮    │   ⋮      ⋮      ⋮        ⋮          ⋮         ⋮          ⋮
 336770 │  2013      9     30      -10.0      -25.0    1617.0      196.0
 336771 │  2013      9     30  missing    missing       764.0  missing
 336772 │  2013      9     30  missing    missing       213.0  missing
 336773 │  2013      9     30  missing    missing       198.0  missing
 336774 │  2013      9     30  missing    missing       764.0  missing
 336775 │  2013      9     30  missing    missing       419.0  missing
 336776 │  2013      9     30  missing    missing       431.0  missing
                                                      336761 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Add variables <code>gain</code> and <code>speed</code>:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  flights_sml,</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain =</span> arr_delay <span class="sc">-</span> dep_delay,</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">speed =</span> distance <span class="sc">/</span> air_time <span class="sc">*</span> <span class="dv">60</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 9
    year month   day dep_delay arr_delay distance air_time  gain speed
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  2013     1     1         2        11     1400      227     9  370.
 2  2013     1     1         4        20     1416      227    16  374.
 3  2013     1     1         2        33     1089      160    31  408.
 4  2013     1     1        -1       -18     1576      183   -17  517.
 5  2013     1     1        -6       -25      762      116   -19  394.
 6  2013     1     1        -4        12      719      150    16  288.
 7  2013     1     1        -5        19     1065      158    24  404.
 8  2013     1     1        -3       -14      229       53   -11  259.
 9  2013     1     1        -3        -8      944      140    -5  405.
10  2013     1     1        -2         8      733      138    10  319.
# … with 336,766 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>flights_sml[<span class="st">'gain'</span>] <span class="op">=</span> flights_sml[<span class="st">'arr_delay'</span>] <span class="op">-</span> flights_sml[<span class="st">'dep_delay'</span>]</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>flights_sml[<span class="st">'speed'</span>] <span class="op">=</span> flights_sml[<span class="st">'distance'</span>] <span class="op">/</span> flights_sml[<span class="st">'air_time'</span>] <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>flights_sml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_delay  arr_delay  distance  air_time  gain  \
0       2013      1    1        2.0       11.0      1400     227.0   9.0   
1       2013      1    1        4.0       20.0      1416     227.0  16.0   
2       2013      1    1        2.0       33.0      1089     160.0  31.0   
3       2013      1    1       -1.0      -18.0      1576     183.0 -17.0   
4       2013      1    1       -6.0      -25.0       762     116.0 -19.0   
...      ...    ...  ...        ...        ...       ...       ...   ...   
336771  2013      9   30        NaN        NaN       213       NaN   NaN   
336772  2013      9   30        NaN        NaN       198       NaN   NaN   
336773  2013      9   30        NaN        NaN       764       NaN   NaN   
336774  2013      9   30        NaN        NaN       419       NaN   NaN   
336775  2013      9   30        NaN        NaN       431       NaN   NaN   

             speed  
0       370.044053  
1       374.273128  
2       408.375000  
3       516.721311  
4       394.137931  
...            ...  
336771         NaN  
336772         NaN  
336773         NaN  
336774         NaN  
336775         NaN  

[336776 rows x 9 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<p>Julia analog is <code>transform</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Following are equivalent</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">transform</span>(flights_sml, [<span class="op">:</span>arr_delay, <span class="op">:</span>dep_delay] <span class="op">=&gt;</span> (<span class="op">-</span>) <span class="op">=&gt;</span> <span class="op">:</span>gain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×8 DataFrame
    Row │ year   month  day    dep_delay  arr_delay  distance  air_time   gain ⋯
        │ Int64  Int64  Int64  Float64?   Float64?   Float64   Float64?   Floa ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      1      1        2.0       11.0    1400.0      227.0       ⋯
      2 │  2013      1      1        4.0       20.0    1416.0      227.0
      3 │  2013      1      1        2.0       33.0    1089.0      160.0
      4 │  2013      1      1       -1.0      -18.0    1576.0      183.0
      5 │  2013      1      1       -6.0      -25.0     762.0      116.0       ⋯
      6 │  2013      1      1       -4.0       12.0     719.0      150.0
      7 │  2013      1      1       -5.0       19.0    1065.0      158.0
      8 │  2013      1      1       -3.0      -14.0     229.0       53.0
   ⋮    │   ⋮      ⋮      ⋮        ⋮          ⋮         ⋮          ⋮           ⋱
 336770 │  2013      9     30      -10.0      -25.0    1617.0      196.0       ⋯
 336771 │  2013      9     30  missing    missing       764.0  missing    miss
 336772 │  2013      9     30  missing    missing       213.0  missing    miss
 336773 │  2013      9     30  missing    missing       198.0  missing    miss
 336774 │  2013      9     30  missing    missing       764.0  missing    miss ⋯
 336775 │  2013      9     30  missing    missing       419.0  missing    miss
 336776 │  2013      9     30  missing    missing       431.0  missing    miss
                                                1 column and 336761 rows omitted</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">insertcols!</span>(flights_sml, <span class="op">:</span>gain <span class="op">=&gt;</span> flights.arr_delay <span class="op">-</span> flights.dep_delay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×8 DataFrame
    Row │ year   month  day    dep_delay  arr_delay  distance  air_time   gain ⋯
        │ Int64  Int64  Int64  Float64?   Float64?   Float64   Float64?   Floa ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      1      1        2.0       11.0    1400.0      227.0       ⋯
      2 │  2013      1      1        4.0       20.0    1416.0      227.0
      3 │  2013      1      1        2.0       33.0    1089.0      160.0
      4 │  2013      1      1       -1.0      -18.0    1576.0      183.0
      5 │  2013      1      1       -6.0      -25.0     762.0      116.0       ⋯
      6 │  2013      1      1       -4.0       12.0     719.0      150.0
      7 │  2013      1      1       -5.0       19.0    1065.0      158.0
      8 │  2013      1      1       -3.0      -14.0     229.0       53.0
   ⋮    │   ⋮      ⋮      ⋮        ⋮          ⋮         ⋮          ⋮           ⋱
 336770 │  2013      9     30      -10.0      -25.0    1617.0      196.0       ⋯
 336771 │  2013      9     30  missing    missing       764.0  missing    miss
 336772 │  2013      9     30  missing    missing       213.0  missing    miss
 336773 │  2013      9     30  missing    missing       198.0  missing    miss
 336774 │  2013      9     30  missing    missing       764.0  missing    miss ⋯
 336775 │  2013      9     30  missing    missing       419.0  missing    miss
 336776 │  2013      9     30  missing    missing       431.0  missing    miss
                                                1 column and 336761 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Refer to columns that you’ve just created:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false" href="">Python (???)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false" href="">Julia (???)</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(flights_sml,</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">gain =</span> arr_delay <span class="sc">-</span> dep_delay,</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">hours =</span> air_time <span class="sc">/</span> <span class="dv">60</span>,</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">gain_per_hour =</span> gain <span class="sc">/</span> hours</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 10
    year month   day dep_delay arr_delay distance air_time  gain hours gain_pe…¹
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1  2013     1     1         2        11     1400      227     9 3.78       2.38
 2  2013     1     1         4        20     1416      227    16 3.78       4.23
 3  2013     1     1         2        33     1089      160    31 2.67      11.6 
 4  2013     1     1        -1       -18     1576      183   -17 3.05      -5.57
 5  2013     1     1        -6       -25      762      116   -19 1.93      -9.83
 6  2013     1     1        -4        12      719      150    16 2.5        6.4 
 7  2013     1     1        -5        19     1065      158    24 2.63       9.11
 8  2013     1     1        -3       -14      229       53   -11 0.883    -12.5 
 9  2013     1     1        -3        -8      944      140    -5 2.33      -2.14
10  2013     1     1        -2         8      733      138    10 2.3        4.35
# … with 336,766 more rows, and abbreviated variable name ¹​gain_per_hour</code></pre>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<p>Not sure how to refer to columns in the same command.</p>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<p>Not sure how to do this, except using two lines.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Following are equivalent</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@pipe</span> flights <span class="op">|&gt;</span> </span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>    _ , </span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>    [<span class="op">:</span>arr_delay, <span class="op">:</span>dep_delay] <span class="op">=&gt;</span> (<span class="op">-</span>) <span class="op">=&gt;</span> <span class="op">:</span>gain,</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>    [<span class="op">:</span>air_time] <span class="op">=&gt;</span> (x <span class="op">-&gt;</span> x <span class="op">/</span> <span class="fl">60</span>)  <span class="op">=&gt;</span> <span class="op">:</span>hours,</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="op">|&gt;</span> </span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>    _,</span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>    [<span class="op">:</span>gain, <span class="op">:</span>hours] <span class="op">=&gt;</span> <span class="fu">ByRow</span>(<span class="op">/</span>) <span class="op">=&gt;</span> <span class="op">:</span>gain_per_hour</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×22 DataFrame
    Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time   ⋯
        │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?     ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      1      1       517             515        2.0       830   ⋯
      2 │  2013      1      1       533             529        4.0       850
      3 │  2013      1      1       542             540        2.0       923
      4 │  2013      1      1       544             545       -1.0      1004
      5 │  2013      1      1       554             600       -6.0       812   ⋯
      6 │  2013      1      1       554             558       -4.0       740
      7 │  2013      1      1       555             600       -5.0       913
      8 │  2013      1      1       557             600       -3.0       709
   ⋮    │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮       ⋱
 336770 │  2013      9     30      2349            2359      -10.0       325   ⋯
 336771 │  2013      9     30   missing            1842  missing     missing
 336772 │  2013      9     30   missing            1455  missing     missing
 336773 │  2013      9     30   missing            2200  missing     missing
 336774 │  2013      9     30   missing            1210  missing     missing   ⋯
 336775 │  2013      9     30   missing            1159  missing     missing
 336776 │  2013      9     30   missing             840  missing     missing
                                              15 columns and 336761 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Only keep the new variables by <code>transmute()</code>:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">transmute</span>(</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>  flights,</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain =</span> arr_delay <span class="sc">-</span> dep_delay,</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">hours =</span> air_time <span class="sc">/</span> <span class="dv">60</span>,</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain_per_hour =</span> gain <span class="sc">/</span> hours</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 3
    gain hours gain_per_hour
   &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
 1     9 3.78           2.38
 2    16 3.78           4.23
 3    31 2.67          11.6 
 4   -17 3.05          -5.57
 5   -19 1.93          -9.83
 6    16 2.5            6.4 
 7    24 2.63           9.11
 8   -11 0.883        -12.5 
 9    -5 2.33          -2.14
10    10 2.3            4.35
# … with 336,766 more rows</code></pre>
</div>
</div>
<ul>
<li><code>mutate_all()</code>: apply funs to all columns.</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false" href="">Python (???)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate_all</span>(data, <span class="fu">funs</span>(<span class="fu">log</span>(.), <span class="fu">log2</span>(.)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<p>TODO</p>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mapcols</span>(col <span class="op">-&gt;</span> <span class="fl">2</span>col, df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<ul>
<li><code>mutate_at()</code>: apply funs to specific columns.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate_at</span>(data, <span class="fu">vars</span>(<span class="sc">-</span>Species), <span class="fu">funs</span>(<span class="fu">log</span>(.)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>mutate_if()</code>: apply funs of one type</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate_if</span>(data, is.numeric, <span class="fu">funs</span>(<span class="fu">log</span>(.)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="summaries" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="summaries"><span class="header-section-number">5</span> Summaries</h2>
<section id="summaries-with-summarise" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="summaries-with-summarise"><span class="header-section-number">5.1</span> Summaries with <code>summarise()</code></h3>
<ul>
<li>Mean of a variable:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(flights, <span class="at">delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  delay
  &lt;dbl&gt;
1  12.6</code></pre>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>flights.agg({<span class="st">'dep_delay'</span>: np.mean})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dep_delay    12.63907
dtype: float64</code></pre>
</div>
</div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(flights, <span class="op">:</span>dep_delay <span class="op">=&gt;</span> (x <span class="op">-&gt;</span> <span class="fu">mean</span>(<span class="fu">skipmissing</span>(x))) <span class="op">=&gt;</span> <span class="op">:</span>delay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1×1 DataFrame
 Row │ delay
     │ Float64
─────┼─────────
   1 │ 12.6391</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Convert a tibble into a grouped tibble:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-3" role="tab" aria-controls="tabset-22-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>by_day <span class="ot">&lt;-</span> <span class="fu">group_by</span>(flights, year, month, day) <span class="sc">%&gt;%</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
# Groups:   year, month, day [365]
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
   arr_delay carrier flight tailnum origin dest  air_time distance  hour minute
       &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1        11 UA        1545 N14228  EWR    IAH        227     1400     5     15
 2        20 UA        1714 N24211  LGA    IAH        227     1416     5     29
 3        33 AA        1141 N619AA  JFK    MIA        160     1089     5     40
 4       -18 B6         725 N804JB  JFK    BQN        183     1576     5     45
 5       -25 DL         461 N668DN  LGA    ATL        116      762     6      0
 6        12 UA        1696 N39463  EWR    ORD        150      719     5     58
 7        19 B6         507 N516JB  EWR    FLL        158     1065     6      0
 8       -14 EV        5708 N829AS  LGA    IAD         53      229     6      0
 9        -8 B6          79 N593JB  JFK    MCO        140      944     6      0
10         8 AA         301 N3ALAA  LGA    ORD        138      733     6      0
   time_hour          
   &lt;dttm&gt;             
 1 2013-01-01 05:00:00
 2 2013-01-01 05:00:00
 3 2013-01-01 05:00:00
 4 2013-01-01 05:00:00
 5 2013-01-01 06:00:00
 6 2013-01-01 05:00:00
 7 2013-01-01 06:00:00
 8 2013-01-01 06:00:00
 9 2013-01-01 06:00:00
10 2013-01-01 06:00:00
# … with 336,766 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>by_day <span class="op">=</span> flights.groupby([<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>])</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>by_day</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x12b5b0610&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-22-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>by_day <span class="op">=</span> <span class="fu">groupby</span>(flights, [<span class="op">:</span>year, <span class="op">:</span>month, <span class="op">:</span>day])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GroupedDataFrame with 365 groups based on keys: year, month, day
First Group (842 rows): year = 2013, month = 1, day = 1
 Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time  sch ⋯
     │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?    Int ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │  2013      1      1       517             515        2.0       830      ⋯
   2 │  2013      1      1       533             529        4.0       850
  ⋮  │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮          ⋱
 841 │  2013      1      1   missing            1500  missing     missing
 842 │  2013      1      1   missing             600  missing     missing
                                                 12 columns and 838 rows omitted
⋮
Last Group (776 rows): year = 2013, month = 12, day = 31
 Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time  sch ⋯
     │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?    Int ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │  2013     12     31        13            2359       14.0       439      ⋯
   2 │  2013     12     31        18            2359       19.0       449
  ⋮  │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮          ⋱
 776 │  2013     12     31   missing             830  missing     missing
                                                 12 columns and 773 rows omitted</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>by_day</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GroupedDataFrame with 365 groups based on keys: year, month, day
First Group (842 rows): year = 2013, month = 1, day = 1
 Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time  sch ⋯
     │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?    Int ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │  2013      1      1       517             515        2.0       830      ⋯
   2 │  2013      1      1       533             529        4.0       850
  ⋮  │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮          ⋱
 841 │  2013      1      1   missing            1500  missing     missing
 842 │  2013      1      1   missing             600  missing     missing
                                                 12 columns and 838 rows omitted
⋮
Last Group (776 rows): year = 2013, month = 12, day = 31
 Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time  sch ⋯
     │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?    Int ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │  2013     12     31        13            2359       14.0       439      ⋯
   2 │  2013     12     31        18            2359       19.0       449
  ⋮  │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮          ⋱
 776 │  2013     12     31   missing             830  missing     missing
                                                 12 columns and 773 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Grouped summaries:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(by_day, <span class="at">delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 4
# Groups:   year, month [12]
    year month   day delay
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
 1  2013     1     1 11.5 
 2  2013     1     2 13.9 
 3  2013     1     3 11.0 
 4  2013     1     4  8.95
 5  2013     1     5  5.73
 6  2013     1     6  7.15
 7  2013     1     7  5.42
 8  2013     1     8  2.55
 9  2013     1     9  2.28
10  2013     1    10  2.84
# … with 355 more rows</code></pre>
</div>
</div>
</section>
<section id="pipe" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="pipe"><span class="header-section-number">5.2</span> Pipe</h3>
<ul>
<li>Consider following analysis (find destinations excluding <code>HNL</code> that have &gt;20 flights, and calculate the average distances and arrival delay):</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>by_dest <span class="ot">&lt;-</span> <span class="fu">group_by</span>(flights, dest)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>delay <span class="ot">&lt;-</span> <span class="fu">summarise</span>(by_dest, <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dist =</span> <span class="fu">mean</span>(distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>delay <span class="ot">&lt;-</span> <span class="fu">filter</span>(delay, count <span class="sc">&gt;</span> <span class="dv">20</span>, dest <span class="sc">!=</span> <span class="st">"HNL"</span>)</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>delay</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 96 × 4
   dest  count  dist delay
   &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 ABQ     254 1826   4.38
 2 ACK     265  199   4.85
 3 ALB     439  143  14.4 
 4 ATL   17215  757. 11.3 
 5 AUS    2439 1514.  6.02
 6 AVL     275  584.  8.00
 7 BDL     443  116   7.05
 8 BGR     375  378   8.03
 9 BHM     297  866. 16.9 
10 BNA    6333  758. 11.8 
# … with 86 more rows</code></pre>
</div>
</div>
<hr>
<ul>
<li>Cleaner code using pipe <code>%&gt;%</code>:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>delays <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dest) <span class="sc">%&gt;%</span> </span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist =</span> <span class="fu">mean</span>(distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;</span> <span class="dv">20</span>, dest <span class="sc">!=</span> <span class="st">"HNL"</span>)</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>delays</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 96 × 4
   dest  count  dist delay
   &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 ABQ     254 1826   4.38
 2 ACK     265  199   4.85
 3 ALB     439  143  14.4 
 4 ATL   17215  757. 11.3 
 5 AUS    2439 1514.  6.02
 6 AVL     275  584.  8.00
 7 BDL     443  116   7.05
 8 BGR     375  378   8.03
 9 BHM     297  866. 16.9 
10 BNA    6333  758. 11.8 
# … with 86 more rows</code></pre>
</div>
</div>
<ul>
<li>ggplot2 accepts pipe too.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>delays <span class="sc">%&gt;%</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> dist, <span class="at">y =</span> delay)) <span class="sc">+</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> count), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Distance from NYC (miles)"</span>,</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Arrival delay (mins)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="dplyr_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="other-summary-functions" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="other-summary-functions"><span class="header-section-number">5.3</span> Other summary functions</h3>
<ul>
<li>Location: <code>mean(x)</code>, <code>median(x)</code>.</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Equivalent code using filter</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="co"># not_cancelled &lt;- flights %&gt;% </span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!is.na(dep_delay), !is.na(arr_delay)) %&gt;%</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   print(width = Inf)</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(dep_delay, arr_delay) <span class="sc">%&gt;%</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 327,346 × 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
   arr_delay carrier flight tailnum origin dest  air_time distance  hour minute
       &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1        11 UA        1545 N14228  EWR    IAH        227     1400     5     15
 2        20 UA        1714 N24211  LGA    IAH        227     1416     5     29
 3        33 AA        1141 N619AA  JFK    MIA        160     1089     5     40
 4       -18 B6         725 N804JB  JFK    BQN        183     1576     5     45
 5       -25 DL         461 N668DN  LGA    ATL        116      762     6      0
 6        12 UA        1696 N39463  EWR    ORD        150      719     5     58
 7        19 B6         507 N516JB  EWR    FLL        158     1065     6      0
 8       -14 EV        5708 N829AS  LGA    IAD         53      229     6      0
 9        -8 B6          79 N593JB  JFK    MCO        140      944     6      0
10         8 AA         301 N3ALAA  LGA    ORD        138      733     6      0
   time_hour          
   &lt;dttm&gt;             
 1 2013-01-01 05:00:00
 2 2013-01-01 05:00:00
 3 2013-01-01 05:00:00
 4 2013-01-01 05:00:00
 5 2013-01-01 06:00:00
 6 2013-01-01 05:00:00
 7 2013-01-01 06:00:00
 8 2013-01-01 06:00:00
 9 2013-01-01 06:00:00
10 2013-01-01 06:00:00
# … with 327,336 more rows</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_delay1 =</span> <span class="fu">mean</span>(arr_delay),</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_delay2 =</span> <span class="fu">mean</span>(arr_delay[arr_delay <span class="sc">&gt;</span> <span class="dv">0</span>]) <span class="co"># the average positive delay</span></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 5
# Groups:   year, month [12]
    year month   day avg_delay1 avg_delay2
   &lt;int&gt; &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1  2013     1     1     12.7         32.5
 2  2013     1     2     12.7         32.0
 3  2013     1     3      5.73        27.7
 4  2013     1     4     -1.93        28.3
 5  2013     1     5     -1.53        22.6
 6  2013     1     6      4.24        24.4
 7  2013     1     7     -4.95        27.8
 8  2013     1     8     -3.23        20.8
 9  2013     1     9     -0.264       25.6
10  2013     1    10     -5.90        27.3
# … with 355 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="op">=</span> flights.dropna(subset <span class="op">=</span> [<span class="st">'dep_delay'</span>, <span class="st">'arr_delay'</span>])</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>not_cancelled</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
0       2013      1    1     517.0             515        2.0     830.0   
1       2013      1    1     533.0             529        4.0     850.0   
2       2013      1    1     542.0             540        2.0     923.0   
3       2013      1    1     544.0             545       -1.0    1004.0   
4       2013      1    1     554.0             600       -6.0     812.0   
...      ...    ...  ...       ...             ...        ...       ...   
336765  2013      9   30    2240.0            2245       -5.0    2334.0   
336766  2013      9   30    2240.0            2250      -10.0    2347.0   
336767  2013      9   30    2241.0            2246       -5.0    2345.0   
336768  2013      9   30    2307.0            2255       12.0    2359.0   
336769  2013      9   30    2349.0            2359      -10.0     325.0   

        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \
0                  819       11.0      UA    1545  N14228    EWR  IAH   
1                  830       20.0      UA    1714  N24211    LGA  IAH   
2                  850       33.0      AA    1141  N619AA    JFK  MIA   
3                 1022      -18.0      B6     725  N804JB    JFK  BQN   
4                  837      -25.0      DL     461  N668DN    LGA  ATL   
...                ...        ...     ...     ...     ...    ...  ...   
336765            2351      -17.0      B6    1816  N354JB    JFK  SYR   
336766               7      -20.0      B6    2002  N281JB    JFK  BUF   
336767               1      -16.0      B6     486  N346JB    JFK  ROC   
336768            2358        1.0      B6     718  N565JB    JFK  BOS   
336769             350      -25.0      B6     745  N516JB    JFK  PSE   

        air_time  distance  hour  minute                 time_hour  
0          227.0      1400     5      15 2013-01-01 10:00:00+00:00  
1          227.0      1416     5      29 2013-01-01 10:00:00+00:00  
2          160.0      1089     5      40 2013-01-01 10:00:00+00:00  
3          183.0      1576     5      45 2013-01-01 10:00:00+00:00  
4          116.0       762     6       0 2013-01-01 11:00:00+00:00  
...          ...       ...   ...     ...                       ...  
336765      41.0       209    22      45 2013-10-01 02:00:00+00:00  
336766      52.0       301    22      50 2013-10-01 02:00:00+00:00  
336767      47.0       264    22      46 2013-10-01 02:00:00+00:00  
336768      33.0       187    22      55 2013-10-01 02:00:00+00:00  
336769     196.0      1617    23      59 2013-10-01 03:00:00+00:00  

[327346 rows x 19 columns]</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>flights.groupby([<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>]).agg(</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>  avg_delay1 <span class="op">=</span> (<span class="st">'arr_delay'</span>, np.mean), </span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>  avg_delay2 <span class="op">=</span> (<span class="st">'arr_delay'</span>, <span class="kw">lambda</span> x: np.mean(x[x <span class="op">&gt;</span> <span class="dv">0</span>]))</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                avg_delay1  avg_delay2
year month day                        
2013 1     1     12.651023   32.481562
           2     12.692888   32.029907
           3      5.733333   27.660870
           4     -1.932819   28.309764
           5     -1.525802   22.558824
           6      4.236429   24.372703
           7     -4.947312   27.761317
           8     -3.227578   20.789091
           9     -0.264278   25.634146
           10    -5.898816   27.345455
           11    -4.762268   26.159836
           12   -13.016153   23.471698
           13    14.931846   52.548913
           14     3.640303   22.444444
           15     0.425653   19.710027
           16    34.247362   46.083458
           17     6.492896   25.602679
           18     1.841758   25.053824
           19    -8.526080   24.289062
           20     3.740077   29.029126
           21     6.315965   32.243590
           22    12.276836   33.883227
           23     6.917793   33.051813
           24    15.427313   42.088235
           25    27.098976   55.736944
           26     0.751118   29.058333
           27    -1.308933   36.024793
           28     9.319720   38.703608
           29    -6.555811   30.133333
           30    25.910804   57.428894
           31    32.602854   51.590444
     2     1      7.165198   30.290865
           2     -4.788774   26.194595
           3      0.025189   28.443299
           4      7.507625   33.155172
           5      6.766249   23.292735
           6     -1.282511   29.103203
           7      2.069189   26.704735
           8     24.228571   35.454810
           9      6.639175   37.007874
           10     6.659176   38.445455
           11    36.290094   62.482014
           12    -2.144796   26.017182
           13     0.026637   22.653740
           14     4.777311   26.404651
           15     0.769556   24.400524
           16     0.203804   29.846405
           17    -1.108434   35.627820
           18    -2.730074   31.022989
           19    12.819849   38.548807
           20     3.049303   33.492537
           21     7.915598   28.701493
           22    10.978655   32.619522
           23    14.711957   35.622871
           24     1.093211   30.911184
           25     1.371822   30.538682
           26     1.715719   29.851064
           27    31.252492   59.044828
           28    -9.168940   23.614173
     3     1     -0.690678   35.070796
           2     -3.257294   32.088462
           3     -6.398015   28.093385
           4     -2.333333   28.114286
           5     -3.888532   28.861345
           6      6.972187   46.834437
           7     16.230420   44.491342
           8     85.862155   97.485315
           9     -7.023936   34.135593
           10    -2.080931   35.546125
           11    -0.844969   27.080357
           12    22.556049   50.529297
           13    -3.333333   26.852201
           14     3.667347   33.248082
           15     0.590722   36.420245
           16    11.131406   30.976019
           17     6.551225   25.390909
           18    41.291892   64.746457
           19    26.489201   44.734921
           20     2.374086   28.238845
           21     3.508230   30.382653
           22     3.284979   33.024457
           23    13.767105   36.159036
           24    11.166479   39.157407
           25    10.370370   44.251208
           26    -7.690476   21.831169
           27    -6.323409   25.738318
           28    -6.454918   32.087156
           29    -9.594845   29.128834
           30   -13.737598   28.849057
           31    -0.762332   30.641577
     4     1     10.847758   35.018828
           2      4.581633   31.492308
           3      0.103239   21.008000
           4      5.278119   28.138085
           5      5.644535   28.078261
           6     -6.324641   27.707182
           7     -4.072767   23.301653
           8     -6.421053   24.801802
           9      0.383090   32.686957
           10    38.412311   94.130641
           11    20.499475   47.626168
           12    36.048140   56.411765
           13     4.370757   25.724928
           14     6.862637   31.294118
           15     0.112348   26.695652
           16     2.969664   46.575092
           17     9.867089   40.985258
           18    36.028481   64.895175
           19    47.911697   80.048780
           20     6.482759   31.100575
           21     4.371460   28.240409
           22    37.812166   56.491971
           23    22.952329   40.163462
           24    23.461373   50.996219
           25    33.681250   45.829333
           26    21.372188   42.631579
           27   -12.046358   27.902985
           28    -5.185919   26.915709
           29    -3.382805   35.463768
           30   -10.514166   23.260465
     5     1     -8.381497   23.833333
           2     -7.252317   31.076596
           3      4.230530   42.539945
           4     -8.537940   35.557377
           5     -9.772026   30.853933
           6     -7.578029   30.901141
           7    -14.367089   24.167630
           8     39.609183   69.049153
           9     11.840415   36.572549
           10     9.017562   37.834821
           11    22.773826   61.501425
           12    -6.227222   23.460076
           13    -6.364198   29.882979
           14   -11.105485   30.681818
           15    -2.029598   34.597865
           16     4.196939   34.097884
           17     1.093878   29.060274
           18   -10.738606   30.571429
           19    19.513333   55.668817
           20     5.846473   39.297030
           21     4.079114   30.686420
           22    27.593853   56.271881
           23    61.970899   88.501792
           24    24.257415   48.242583
           25     0.053867   34.650655
           26   -11.027473   19.185714
           27    -9.673514   28.415301
           28     1.101344   33.385075
           29     0.267635   25.632432
           30    -0.161389   38.012780
           31    -4.627593   34.295082
     6     1    -11.861148   26.272727
           2     26.075518   72.118687
           3     23.010460   49.567857
           4     -0.390167   25.123494
           5     -3.104384   30.104089
           6      0.926272   25.843575
           7     27.973481   52.932862
           8     -3.540155   34.458937
           9     -2.321903   27.858696
           10    28.022293   57.427549
           11     2.135135   36.368116
           12    -0.101784   25.011494
           13    63.753689   77.495957
           14    18.910603   48.978346
           15    -4.268939   37.066667
           16    -0.941048   27.618893
           17    29.360287   59.349040
           18    37.648026   63.436242
           19     7.245632   25.152475
           20    -7.135765   20.145833
           21    -3.197769   33.905797
           22    -5.814907   31.156250
           23     7.666667   43.331565
           24    51.176808   92.093985
           25    41.513684   73.197347
           26    27.317410   59.994253
           27    44.783296   88.440546
           28    44.976852   78.172414
           29    11.073325   39.922460
           30    43.510278   75.887218
     7     1     58.280502   76.901146
           2     14.966486   42.913223
           3     17.257467   48.211155
           4    -12.099591   26.457364
           5     -8.844743   33.886076
           6     -7.516046   36.117647
           7     40.306378   86.342213
           8     29.648847   62.889908
           9     31.334365   71.164773
           10    59.626478  110.093439
           11    16.524678   44.407484
           12    20.116989   47.355993
           13    13.539241   42.950980
           14    -8.483766   42.163462
           15    -9.598385   23.768061
           16     3.467413   32.411330
           17     4.868154   38.806701
           18    12.832132   51.722477
           19    11.723644   46.004545
           20     8.832908   38.854342
           21    15.459579   45.089087
           22    62.763403  102.343470
           23    44.959821   69.958132
           24    14.073171   34.338156
           25    17.404082   42.024390
           26    10.337398   31.212355
           27     0.248756   34.088462
           28    49.831776   86.632163
           29    11.453988   36.544699
           30    -1.347870   28.543478
           31    -0.892354   27.344937
     8     1     35.989259   56.319508
           2      8.565884   33.083512
           3      9.414880   33.488000
           4      4.085963   29.500000
           5      2.009027   27.671916
           6     -2.051724   27.094463
           7      8.192153   31.287785
           8     55.481163   78.624638
           9     43.313641   62.330914
           10     4.804483   29.857558
           11     6.603896   29.613426
           12     7.590313   26.316103
           13    29.825107   44.047757
           14    13.804656   29.067769
           15     1.643863   27.269129
           16    -1.842265   27.611285
           17    -7.209781   25.130000
           18    -1.126932   28.290429
           19    -6.434211   22.300000
           20    -8.207317   24.676596
           21    -9.823649   22.323810
           22    29.976744   53.612903
           23    -0.666328   26.029674
           24   -13.894942   32.000000
           25   -15.030000   30.555556
           26   -13.246660   27.606936
           27   -11.759916   29.491713
           28    35.203074   75.326848
           29    -0.692387   28.875706
           30   -12.035639   37.154762
           31    -9.907738   31.934959
     9     1     -9.390449   34.632353
           2     45.518430  102.811364
           3     -3.319194   27.251701
           4    -15.092850   25.413793
           5    -15.540373   26.259259
           6    -17.895010   27.282609
           7    -20.349854   23.984615
           8    -11.545455   22.047120
           9    -11.701417   20.015075
           10    -9.033438   29.628141
           11     7.982475   49.561308
           12    58.912418  100.024540
           13    13.457819   38.092885
           14   -14.703377   30.863636
           15    -9.751964   23.060773
           16    -3.620549   20.321918
           17   -10.257829   17.824859
           18   -12.139319   36.620968
           19     2.814508   46.939103
           20    -4.093878   40.828571
           21    -4.934783   29.631868
           22    -1.705357   26.658703
           23    -4.345491   24.832168
           24    -9.909378   16.851648
           25    -5.546680   19.596154
           26    -4.643145   20.578231
           27    -7.593939   21.831967
           28   -16.371852   22.186916
           29    -8.478022   27.164319
           30   -11.641988   25.601227
     10    1    -18.959375   24.242424
           2    -13.080164   19.128571
           3      4.260606   33.699739
           4     -4.868421   26.890977
           5     -9.113703   31.014815
           6     -5.759300   23.773279
           7     39.017260   72.483304
           8     -6.169792   21.547893
           9     -5.874871   24.808765
           10    10.574359   36.680672
           11    18.922995   51.251037
           12    -9.684993   30.144000
           13    -2.464365   25.470000
           14    -4.509165   21.857651
           15    -3.469045   25.148649
           16    -3.857585   19.110368
           17     6.635996   30.467849
           18     3.928355   25.672289
           19    -1.076358   17.848249
           20    -1.563457   18.818462
           21    -1.755826   16.853107
           22     0.003122   21.531073
           23     4.535052   21.614256
           24     0.208925   20.438830
           25     7.619919   32.589286
           26     0.735988   27.076596
           27    -5.429360   30.230088
           28    -2.207354   22.406832
           29    -3.220481   21.645062
           30    -4.075335   22.381757
           31     0.911572   24.745042
     11    1     11.268162   34.353191
           2     -2.871492   16.882609
           3     -3.916667   24.677419
           4      3.461934   20.141079
           5     -5.169615   19.446970
           6     -4.185685   21.406130
           7     13.168050   31.615101
           8      0.319714   21.318052
           9     -8.877980   15.695035
           10     1.540965   28.296296
           11    -4.524004   24.914062
           12    10.111111   29.271914
           13   -10.976362   22.168889
           14    -8.560529   22.403141
           15    -4.681263   17.946996
           16    -7.066104   23.722581
           17    20.591014   53.404545
           18     0.636458   28.200000
           19    -2.766839   19.267101
           20    -3.144764   24.118033
           21     0.212487   21.065104
           22     9.184662   30.304950
           23     3.813514   23.990881
           24     5.837472   35.022099
           25    -5.129274   23.016260
           26     6.232487   26.987041
           27    17.534289   38.413445
           28    -3.097792   31.231214
           29   -12.180303   20.621359
           30   -11.900468   26.166667
     12    1     -0.976507   32.912752
           2      0.450902   31.554878
           3      2.222798   24.459259
           4     -0.222222   28.406433
           5     51.666255   80.835714
           6     21.119469   37.510888
           7      5.057057   27.187075
           8     36.911801   56.160000
           9     42.575556   53.073826
           10    44.508796   52.194401
           11    10.902439   24.905594
           12     5.339937   23.463203
           13     0.163032   22.141210
           14    46.397504   59.978022
           15    15.870098   38.986784
           16     7.370681   27.813853
           17    55.871856   60.467949
           18    11.079832   26.595027
           19     9.006211   31.040084
           20    13.820166   35.249049
           21    12.456929   36.855392
           22    23.899549   45.648746
           23    32.226042   50.033973
           24    -1.043883   21.169611
           25    -1.899301   30.095000
           26     7.174194   34.548694
           27    -0.148803   29.046832
           28    -3.259533   25.607692
           29    18.763825   47.256356
           30    10.057712   31.243802
           31     6.212121   24.455959</code></pre>
</div>
</div>
</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="op">=</span> <span class="fu">dropmissing</span>(flights, [<span class="op">:</span>dep_delay, <span class="op">:</span>arr_delay])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>327346×19 DataFrame
    Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time   ⋯
        │ Int64  Int64  Int64  Int64?    Int64           Float64    Int64?     ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      1      1       517             515        2.0       830   ⋯
      2 │  2013      1      1       533             529        4.0       850
      3 │  2013      1      1       542             540        2.0       923
      4 │  2013      1      1       544             545       -1.0      1004
      5 │  2013      1      1       554             600       -6.0       812   ⋯
      6 │  2013      1      1       554             558       -4.0       740
      7 │  2013      1      1       555             600       -5.0       913
      8 │  2013      1      1       557             600       -3.0       709
   ⋮    │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮       ⋱
 327340 │  2013      9     30      2235            2001      154.0        59   ⋯
 327341 │  2013      9     30      2237            2245       -8.0      2345
 327342 │  2013      9     30      2240            2245       -5.0      2334
 327343 │  2013      9     30      2240            2250      -10.0      2347
 327344 │  2013      9     30      2241            2246       -5.0      2345   ⋯
 327345 │  2013      9     30      2307            2255       12.0      2359
 327346 │  2013      9     30      2349            2359      -10.0       325
                                              12 columns and 327331 rows omitted</code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>not_cancelled</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>327346×19 DataFrame
    Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time   ⋯
        │ Int64  Int64  Int64  Int64?    Int64           Float64    Int64?     ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      1      1       517             515        2.0       830   ⋯
      2 │  2013      1      1       533             529        4.0       850
      3 │  2013      1      1       542             540        2.0       923
      4 │  2013      1      1       544             545       -1.0      1004
      5 │  2013      1      1       554             600       -6.0       812   ⋯
      6 │  2013      1      1       554             558       -4.0       740
      7 │  2013      1      1       555             600       -5.0       913
      8 │  2013      1      1       557             600       -3.0       709
   ⋮    │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮       ⋱
 327340 │  2013      9     30      2235            2001      154.0        59   ⋯
 327341 │  2013      9     30      2237            2245       -8.0      2345
 327342 │  2013      9     30      2240            2245       -5.0      2334
 327343 │  2013      9     30      2240            2250      -10.0      2347
 327344 │  2013      9     30      2241            2246       -5.0      2345   ⋯
 327345 │  2013      9     30      2307            2255       12.0      2359
 327346 │  2013      9     30      2349            2359      -10.0       325
                                              12 columns and 327331 rows omitted</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@pipe</span> not_cancelled <span class="op">|&gt;</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(_, [<span class="op">:</span>year, <span class="op">:</span>month, <span class="op">:</span>day]) <span class="op">|&gt;</span> </span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>    _, </span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>arr_delay <span class="op">=&gt;</span> (x <span class="op">-&gt;</span> [(<span class="fu">mean</span>(x), <span class="fu">mean</span>(<span class="fu">skipmissing</span>(x[x <span class="op">.&gt;=</span> <span class="fl">0</span>])))]) <span class="op">=&gt;</span> [<span class="op">:</span>avg_delay1, <span class="op">:</span>avg_delay2]</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>365×5 DataFrame
 Row │ year   month  day    avg_delay1  avg_delay2
     │ Int64  Int64  Int64  Float64     Float64
─────┼─────────────────────────────────────────────
   1 │  2013      1      1   12.651        31.5907
   2 │  2013      1      2   12.6929       30.9314
   3 │  2013      1      3    5.73333      26.2351
   4 │  2013      1      4   -1.93282      27.1226
   5 │  2013      1      5   -1.5258       20.9727
   6 │  2013      1      6    4.23643      22.9284
   7 │  2013      1      7   -4.94731      25.8467
   8 │  2013      1      8   -3.22758      19.5788
  ⋮  │   ⋮      ⋮      ⋮        ⋮           ⋮
 359 │  2013     12     25   -1.8993       29.0773
 360 │  2013     12     26    7.17419      33.0568
 361 │  2013     12     27   -0.148803     27.1054
 362 │  2013     12     28   -3.25953      24.4779
 363 │  2013     12     29   18.7638       46.5658
 364 │  2013     12     30   10.0577       29.4776
 365 │  2013     12     31    6.21212      23.1941
                                   350 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Spread: <code>sd(x)</code>, <code>IQR(x)</code>, <code>mad(x)</code>.</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-3" role="tab" aria-controls="tabset-24-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># destinations with largest variation in distance</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dest) <span class="sc">%&gt;%</span> </span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">distance_sd =</span> <span class="fu">sd</span>(distance)) <span class="sc">%&gt;%</span> </span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(distance_sd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 104 × 2
   dest  distance_sd
   &lt;chr&gt;       &lt;dbl&gt;
 1 EGE         10.5 
 2 SAN         10.4 
 3 SFO         10.2 
 4 HNL         10.0 
 5 SEA          9.98
 6 LAS          9.91
 7 PDX          9.87
 8 PHX          9.86
 9 LAX          9.66
10 IND          9.46
# … with 94 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>flights.groupby([<span class="st">'dest'</span>]).agg(</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>  distance_sd <span class="op">=</span> (<span class="st">'distance'</span>, np.std)</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>).sort_values(<span class="st">'distance_sd'</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      distance_sd
dest             
EGE     10.549066
SAN     10.346588
SFO     10.216858
HNL     10.001783
SEA      9.979116
LAS      9.913856
PDX      9.880313
PHX      9.856062
LAX      9.657222
IND      9.455668
SAT      9.000096
CVG      8.992937
MEM      8.497715
HOU      8.476723
MCI      8.387283
AUS      8.318982
DFW      8.305072
CLE      8.282101
TYS      8.004084
IAH      8.001671
DEN      7.981494
STL      7.899533
BNA      7.814711
ORD      7.731902
PIT      7.731472
BUF      7.724076
DTW      7.581811
ROC      7.452263
SDF      7.367790
SLC      7.363589
GSO      7.352531
MSP      7.296561
SBN      7.229569
XNA      7.194400
ATL      7.155615
MSY      7.088342
CMH      7.071074
MDW      7.000700
DAY      6.988557
BWI      6.920632
MKE      6.918848
BOS      6.878423
CLT      6.824532
IAD      6.774477
RIC      6.497803
MSN      6.319128
DSM      6.275483
PWM      5.633014
DCA      5.588415
JAC      5.537749
RDU      5.378799
SYR      5.305292
STT      5.291656
GSP      5.248836
PBI      5.166350
CHS      5.141765
TPA      5.104954
MCO      5.079727
MHT      4.870863
TVC      4.705253
MIA      4.607839
RSW      4.589385
CAE      4.587971
FLL      4.492772
JAX      4.452836
OMA      4.415946
BQN      4.239051
ORF      4.043022
SAV      3.897944
SJU      3.869986
GRR      3.092497
AVL      3.000553
SRQ      2.929607
MYR      2.880434
PHL      2.696727
BTV      2.538673
BHM      0.058026
SMF      0.000000
SJC      0.000000
BDL      0.000000
BGR      0.000000
SNA      0.000000
TUL      0.000000
ALB      0.000000
ANC      0.000000
EYW      0.000000
PVD      0.000000
CAK      0.000000
HDN      0.000000
CRW      0.000000
ILM      0.000000
LGB      0.000000
ACK      0.000000
CHO      0.000000
MTJ      0.000000
PSP      0.000000
MVY      0.000000
OAK      0.000000
OKC      0.000000
BZN      0.000000
BUR      0.000000
PSE      0.000000
ABQ      0.000000
LEX           NaN
LGA           NaN</code></pre>
</div>
</div>
</div>
<div id="tabset-24-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@pipe</span> flights <span class="op">|&gt;</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(_, <span class="op">:</span>dest) <span class="op">|&gt;</span></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(_, <span class="op">:</span>distance <span class="op">=&gt;</span> std <span class="op">=&gt;</span> <span class="op">:</span>distance_sd) <span class="op">|&gt;</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(_, <span class="op">:</span>distance_sd, rev <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>105×2 DataFrame
 Row │ dest    distance_sd
     │ String  Float64
─────┼─────────────────────
   1 │ LEX       NaN
   2 │ LGA       NaN
   3 │ EGE        10.5491
   4 │ SAN        10.3466
   5 │ SFO        10.2169
   6 │ HNL        10.0018
   7 │ SEA         9.97912
   8 │ LAS         9.91386
  ⋮  │   ⋮          ⋮
  99 │ ACK         0.0
 100 │ BGR         0.0
 101 │ ABQ         0.0
 102 │ ILM         0.0
 103 │ MVY         0.0
 104 │ CHO         0.0
 105 │ ANC         0.0
            90 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Rank: <code>min(x)</code>, <code>quantile(x, 0.25)</code>, <code>max(x)</code>.</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-3" role="tab" aria-controls="tabset-25-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Earliest and latest flights on each day?</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">first =</span> <span class="fu">min</span>(dep_time),</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">last =</span> <span class="fu">max</span>(dep_time)</span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 5
# Groups:   year, month [12]
    year month   day first  last
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1  2013     1     1   517  2356
 2  2013     1     2    42  2354
 3  2013     1     3    32  2349
 4  2013     1     4    25  2358
 5  2013     1     5    14  2357
 6  2013     1     6    16  2355
 7  2013     1     7    49  2359
 8  2013     1     8   454  2351
 9  2013     1     9     2  2252
10  2013     1    10     3  2320
# … with 355 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>not_cancelled.groupby([<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>]).agg(</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>  first <span class="op">=</span> (<span class="st">'dep_time'</span>, np.<span class="bu">min</span>),</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>  last <span class="op">=</span> (<span class="st">'dep_time'</span>, np.<span class="bu">max</span>)</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                first    last
year month day               
2013 1     1    517.0  2356.0
           2     42.0  2354.0
           3     32.0  2349.0
           4     25.0  2358.0
           5     14.0  2357.0
           6     16.0  2355.0
           7     49.0  2359.0
           8    454.0  2351.0
           9      2.0  2252.0
           10     3.0  2320.0
           11    11.0  2304.0
           12    30.0  2359.0
           13     1.0  2359.0
           14   453.0  2353.0
           15   453.0  2356.0
           16     2.0  2358.0
           17   453.0  2352.0
           18   455.0  2359.0
           19   456.0  2359.0
           20   525.0  2356.0
           21   455.0  2352.0
           22     5.0  2358.0
           23   158.0  2358.0
           24    37.0  2350.0
           25    15.0  2359.0
           26   107.0  2352.0
           27   523.0  2355.0
           28    10.0  2356.0
           29   448.0  2354.0
           30     3.0  2354.0
           31     1.0  2354.0
     2     1    456.0  2355.0
           2      3.0  2359.0
           3     31.0  2352.0
           4    453.0  2351.0
           5    450.0  2355.0
           6      6.0  2349.0
           7     27.0  2400.0
           8    458.0  1728.0
           9    901.0  2358.0
           10   455.0  2359.0
           11     1.0  2400.0
           12    17.0  2358.0
           13     4.0  2353.0
           14     7.0  2358.0
           15     3.0  2358.0
           16     4.0  2357.0
           17    25.0  2356.0
           18     7.0  2347.0
           19     3.0  2355.0
           20    10.0  2353.0
           21    20.0  2356.0
           22     9.0  2359.0
           23    18.0  2355.0
           24     1.0  2353.0
           25    19.0  2357.0
           26     6.0  2356.0
           27    25.0  2348.0
           28   457.0  2359.0
     3     1      4.0  2357.0
           2     43.0  2356.0
           3    509.0  2353.0
           4     11.0  2353.0
           5    505.0  2351.0
           6      4.0  2356.0
           7      7.0  2351.0
           8      1.0  2359.0
           9     53.0  2345.0
           10     6.0  2354.0
           11    14.0  2355.0
           12     2.0  2359.0
           13   103.0  2355.0
           14     9.0  2355.0
           15    11.0  2400.0
           16    37.0  2356.0
           17    17.0  2321.0
           18     1.0  2357.0
           19     1.0  2357.0
           20    31.0  2358.0
           21     4.0  2352.0
           22    37.0  2400.0
           23    18.0  2349.0
           24     2.0  2357.0
           25    13.0  2400.0
           26    18.0  2355.0
           27    10.0  2359.0
           28     4.0  2355.0
           29   453.0  2357.0
           30     6.0  2355.0
           31    51.0  2358.0
     4     1    454.0  2358.0
           2      9.0  2400.0
           3      2.0  2355.0
           4     14.0  2400.0
           5      1.0  2354.0
           6    453.0  2359.0
           7     30.0  2358.0
           8    454.0  2355.0
           9    449.0  2356.0
           10     1.0  2357.0
           11    25.0  2353.0
           12     2.0  2357.0
           13    59.0  2355.0
           14    16.0  2357.0
           15     2.0  2358.0
           16   454.0  2359.0
           17     8.0  2357.0
           18     2.0  2358.0
           19    11.0  2359.0
           20     7.0  2400.0
           21     8.0  2357.0
           22     2.0  2352.0
           23     4.0  2352.0
           24    30.0  2358.0
           25     5.0  2356.0
           26    22.0  2358.0
           27   453.0  2351.0
           28   452.0  2352.0
           29     2.0  2346.0
           30   455.0  2351.0
     5     1      9.0  2356.0
           2      3.0  2352.0
           3     32.0  2359.0
           4    456.0  2359.0
           5    446.0  2355.0
           6    450.0  2359.0
           7      2.0  2356.0
           8      2.0  2358.0
           9      9.0  2356.0
           10     3.0  2325.0
           11     2.0  2355.0
           12     3.0  2359.0
           13    16.0  2349.0
           14   455.0  2357.0
           15    48.0  2358.0
           16     8.0  2358.0
           17    11.0  2357.0
           18     7.0  2356.0
           19     2.0  2346.0
           20    21.0  2357.0
           21   110.0  2400.0
           22     1.0  2356.0
           23     4.0  2354.0
           24    10.0  2358.0
           25     1.0  2355.0
           26     4.0  2358.0
           27   455.0  2358.0
           28    22.0  2356.0
           29   457.0  2352.0
           30   453.0  2358.0
           31    33.0  2355.0
     6     1      2.0  2359.0
           2     14.0  2357.0
           3      3.0  2353.0
           4    452.0  2355.0
           5     23.0  2359.0
           6    454.0  2359.0
           7     16.0  2359.0
           8      2.0  2358.0
           9    453.0  2356.0
           10     7.0  2352.0
           11   455.0  2358.0
           12     5.0  2355.0
           13     3.0  2355.0
           14    24.0  2358.0
           15   456.0  2356.0
           16    14.0  2355.0
           17     2.0  2400.0
           18     3.0  2358.0
           19     7.0  2357.0
           20     1.0  2356.0
           21     9.0  2354.0
           22     3.0  2359.0
           23     7.0  2354.0
           24     1.0  2359.0
           25     1.0  2357.0
           26    13.0  2353.0
           27    10.0  2359.0
           28     2.0  2359.0
           29    11.0  2342.0
           30    12.0  2359.0
     7     1      1.0  2359.0
           2     12.0  2349.0
           3     28.0  2359.0
           4     11.0  2357.0
           5     38.0  2358.0
           6     32.0  2333.0
           7      4.0  2400.0
           8      2.0  2353.0
           9     17.0  2359.0
           10    17.0  2357.0
           11     5.0  2357.0
           12     5.0  2358.0
           13    19.0  2400.0
           14     6.0  2358.0
           15     9.0  2357.0
           16    19.0  2356.0
           17     2.0  2400.0
           18     9.0  2356.0
           19    24.0  2354.0
           20     6.0  2324.0
           21    11.0  2356.0
           22     1.0  2359.0
           23     4.0  2355.0
           24     6.0  2357.0
           25     6.0  2357.0
           26     9.0  2355.0
           27     1.0  2358.0
           28     1.0  2400.0
           29     5.0  2359.0
           30     3.0  2329.0
           31    10.0  2352.0
     8     1     12.0  2358.0
           2      6.0  2357.0
           3      2.0  2357.0
           4      3.0  2321.0
           5      8.0  2337.0
           6     24.0  2358.0
           7    453.0  2358.0
           8     10.0  2359.0
           9      4.0  2359.0
           10    13.0  2400.0
           11     4.0  2352.0
           12    12.0  2358.0
           13   208.0  2359.0
           14     7.0  2338.0
           15     1.0  2359.0
           16    23.0  2358.0
           17     7.0  2354.0
           18    13.0  2359.0
           19     1.0  2358.0
           20    54.0  2400.0
           21    10.0  2353.0
           22     9.0  2350.0
           23     9.0  2328.0
           24    24.0  2359.0
           25     3.0  2351.0
           26    13.0  2258.0
           27     8.0  2350.0
           28    10.0  2358.0
           29    21.0  2357.0
           30   450.0  2359.0
           31   455.0  2359.0
     9     1      9.0  2352.0
           2      8.0  2400.0
           3    457.0  2357.0
           4    446.0  2258.0
           5    450.0  2352.0
           6      8.0  2341.0
           7    452.0  2246.0
           8    509.0  2358.0
           9    451.0  2354.0
           10   453.0  2347.0
           11    11.0  2351.0
           12     2.0  2400.0
           13     3.0  2352.0
           14   453.0  2349.0
           15   509.0  2351.0
           16   453.0  2346.0
           17   450.0  2352.0
           18   450.0  2349.0
           19    10.0  2353.0
           20     9.0  2349.0
           21     8.0  2306.0
           22   518.0  2350.0
           23   455.0  2342.0
           24   455.0  2348.0
           25   451.0  2358.0
           26   451.0  2349.0
           27   453.0  2346.0
           28   451.0  2351.0
           29   521.0  2356.0
           30   453.0  2349.0
     10    1    447.0  2349.0
           2    449.0  2341.0
           3    453.0  2355.0
           4      7.0  2343.0
           5    453.0  2354.0
           6    519.0  2346.0
           7      6.0  2356.0
           8    141.0  2349.0
           9    452.0  2346.0
           10   457.0  2358.0
           11     8.0  2359.0
           12   457.0  2354.0
           13    15.0  2352.0
           14   451.0  2347.0
           15   456.0  2355.0
           16   454.0  2357.0
           17   453.0  2357.0
           18     9.0  2317.0
           19   454.0  2356.0
           20   517.0  2349.0
           21   453.0  2356.0
           22   454.0  2343.0
           23   454.0  2355.0
           24   453.0  2347.0
           25    13.0  2353.0
           26   451.0  2356.0
           27    16.0  2352.0
           28   453.0  2357.0
           29   456.0  2353.0
           30   455.0  2400.0
           31   458.0  2357.0
     11    1      5.0  2353.0
           2    453.0  2358.0
           3    519.0  2358.0
           4     11.0  2357.0
           5      4.0  2359.0
           6    457.0  2355.0
           7    457.0  2358.0
           8    457.0  2357.0
           9     52.0  2355.0
           10   147.0  2354.0
           11   453.0  2355.0
           12   455.0  2356.0
           13     1.0  2355.0
           14   453.0  2359.0
           15     3.0  2354.0
           16   455.0  2359.0
           17     3.0  2359.0
           18    11.0  2355.0
           19    59.0  2356.0
           20   455.0  2355.0
           21     6.0  2351.0
           22     6.0  2351.0
           23   504.0  2356.0
           24    22.0  2358.0
           25     5.0  2355.0
           26   458.0  2357.0
           27    28.0  2400.0
           28   514.0  2356.0
           29   518.0  2353.0
           30    11.0  2354.0
     12    1     13.0  2354.0
           2     12.0  2358.0
           3    457.0  2358.0
           4    457.0  2355.0
           5     16.0  2400.0
           6      6.0  2357.0
           7      3.0  2358.0
           8     16.0  2354.0
           9     11.0  2400.0
           10     7.0  2348.0
           11   459.0  2359.0
           12     2.0  2356.0
           13    15.0  2400.0
           14     3.0  2359.0
           15     5.0  2359.0
           16     1.0  2332.0
           17     4.0  2358.0
           18   500.0  2358.0
           19    17.0  2400.0
           20     1.0  2358.0
           21     2.0  2357.0
           22     7.0  2358.0
           23    11.0  2354.0
           24     9.0  2358.0
           25   456.0  2357.0
           26     1.0  2355.0
           27     2.0  2351.0
           28     7.0  2358.0
           29     3.0  2400.0
           30     1.0  2356.0
           31    13.0  2356.0</code></pre>
</div>
</div>
</div>
<div id="tabset-25-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@pipe</span> not_cancelled <span class="op">|&gt;</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(_, [<span class="op">:</span>year, <span class="op">:</span>month, <span class="op">:</span>day]) <span class="op">|&gt;</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(_, <span class="op">:</span>dep_time <span class="op">=&gt;</span> (x <span class="op">-&gt;</span> [<span class="fu">extrema</span>(x)]) <span class="op">=&gt;</span> [<span class="op">:</span>first, <span class="op">:</span>last])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>365×5 DataFrame
 Row │ year   month  day    first  last
     │ Int64  Int64  Int64  Int64  Int64
─────┼───────────────────────────────────
   1 │  2013      1      1    517   2356
   2 │  2013      1      2     42   2354
   3 │  2013      1      3     32   2349
   4 │  2013      1      4     25   2358
   5 │  2013      1      5     14   2357
   6 │  2013      1      6     16   2355
   7 │  2013      1      7     49   2359
   8 │  2013      1      8    454   2351
  ⋮  │   ⋮      ⋮      ⋮      ⋮      ⋮
 359 │  2013     12     25    456   2357
 360 │  2013     12     26      1   2355
 361 │  2013     12     27      2   2351
 362 │  2013     12     28      7   2358
 363 │  2013     12     29      3   2400
 364 │  2013     12     30      1   2356
 365 │  2013     12     31     13   2356
                         350 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Position: <code>first(x)</code>, <code>nth(x, 2)</code>, <code>last(x)</code>. Note unless the variable is sorted, <code>first</code> is different from <code>min</code> and <code>last</code> is different from <code>max</code>.</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-3" role="tab" aria-controls="tabset-26-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_dep =</span> <span class="fu">first</span>(dep_time), </span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">last_dep =</span> <span class="fu">last</span>(dep_time)</span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 5
# Groups:   year, month [12]
    year month   day first_dep last_dep
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;int&gt;    &lt;int&gt;
 1  2013     1     1       517     2356
 2  2013     1     2        42     2354
 3  2013     1     3        32     2349
 4  2013     1     4        25     2358
 5  2013     1     5        14     2357
 6  2013     1     6        16     2355
 7  2013     1     7        49     2359
 8  2013     1     8       454     2351
 9  2013     1     9         2     2252
10  2013     1    10         3     2320
# … with 355 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>not_cancelled.groupby([<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>]).agg(</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>  first_dep <span class="op">=</span> (<span class="st">'dep_time'</span>, <span class="kw">lambda</span> x: x.iloc[<span class="dv">0</span>]),</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>  last_dep <span class="op">=</span> (<span class="st">'dep_time'</span>, <span class="kw">lambda</span> x: x.iloc[<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                first_dep  last_dep
year month day                     
2013 1     1        517.0    2356.0
           2         42.0    2354.0
           3         32.0    2349.0
           4         25.0    2358.0
           5         14.0    2357.0
           6         16.0    2355.0
           7         49.0    2359.0
           8        454.0    2351.0
           9          2.0    2252.0
           10         3.0    2320.0
           11        11.0    2304.0
           12        30.0    2359.0
           13         1.0    2359.0
           14       453.0    2353.0
           15       453.0    2356.0
           16         2.0    2358.0
           17       453.0    2352.0
           18       455.0    2359.0
           19       456.0    2359.0
           20       525.0    2356.0
           21       455.0    2352.0
           22         5.0    2358.0
           23       158.0    2358.0
           24        37.0    2350.0
           25        15.0    2359.0
           26       107.0    2352.0
           27       523.0    2355.0
           28        10.0    2356.0
           29       448.0    2354.0
           30         3.0    2354.0
           31         1.0    2354.0
     2     1        456.0    2355.0
           2          3.0    2359.0
           3         31.0    2352.0
           4        453.0    2351.0
           5        450.0    2355.0
           6          6.0    2349.0
           7         27.0    2400.0
           8        458.0    1728.0
           9        901.0    2358.0
           10       455.0    2359.0
           11         1.0    2400.0
           12        17.0    2358.0
           13         4.0    2353.0
           14         7.0    2358.0
           15         3.0    2358.0
           16         4.0    2357.0
           17        25.0    2356.0
           18         7.0    2347.0
           19         3.0    2355.0
           20        10.0    2353.0
           21        20.0    2356.0
           22         9.0    2359.0
           23        18.0    2355.0
           24         1.0    2353.0
           25        19.0    2357.0
           26         6.0    2356.0
           27        25.0    2348.0
           28       457.0    2359.0
     3     1          4.0    2357.0
           2         43.0    2356.0
           3        509.0    2353.0
           4         11.0    2353.0
           5        505.0    2351.0
           6          4.0    2356.0
           7          7.0    2351.0
           8          1.0    2359.0
           9         53.0    2345.0
           10         6.0    2354.0
           11        14.0    2355.0
           12         2.0    2359.0
           13       103.0    2355.0
           14         9.0    2355.0
           15        11.0    2400.0
           16        37.0    2356.0
           17        17.0    2321.0
           18         1.0    2357.0
           19         1.0    2357.0
           20        31.0    2358.0
           21         4.0    2352.0
           22        37.0    2400.0
           23        18.0    2349.0
           24         2.0    2357.0
           25        13.0    2400.0
           26        18.0    2355.0
           27        10.0    2359.0
           28         4.0    2355.0
           29       453.0    2357.0
           30         6.0    2355.0
           31        51.0    2358.0
     4     1        454.0    2358.0
           2          9.0    2400.0
           3          2.0    2355.0
           4         14.0    2400.0
           5          1.0    2354.0
           6        453.0    2359.0
           7         30.0    2358.0
           8        454.0    2355.0
           9        449.0    2356.0
           10         1.0    2357.0
           11        25.0    2353.0
           12         2.0    2357.0
           13        59.0    2355.0
           14        16.0    2357.0
           15         2.0    2358.0
           16       454.0    2359.0
           17         8.0    2357.0
           18         2.0    2358.0
           19        11.0    2359.0
           20         7.0    2400.0
           21         8.0    2357.0
           22         2.0    2352.0
           23         4.0    2352.0
           24        30.0    2358.0
           25         5.0    2356.0
           26        22.0    2358.0
           27       453.0    2351.0
           28       452.0    2352.0
           29         2.0    2346.0
           30       455.0    2351.0
     5     1          9.0    2356.0
           2          3.0    2352.0
           3         32.0    2359.0
           4        456.0    2359.0
           5        446.0    2355.0
           6        450.0    2359.0
           7          2.0    2356.0
           8          2.0    2358.0
           9          9.0    2356.0
           10         3.0    2325.0
           11         2.0    2355.0
           12         3.0    2359.0
           13        16.0    2349.0
           14       455.0    2357.0
           15        48.0    2358.0
           16         8.0    2358.0
           17        11.0    2357.0
           18         7.0    2356.0
           19         2.0    2346.0
           20        21.0    2357.0
           21       110.0    2400.0
           22         1.0    2356.0
           23         4.0    2354.0
           24        10.0    2358.0
           25         1.0    2355.0
           26         4.0    2358.0
           27       455.0    2358.0
           28        22.0    2356.0
           29       457.0    2352.0
           30       453.0    2358.0
           31        33.0    2355.0
     6     1          2.0    2359.0
           2         14.0    2357.0
           3          3.0    2353.0
           4        452.0    2355.0
           5         23.0    2359.0
           6        454.0    2359.0
           7         16.0    2359.0
           8          2.0    2358.0
           9        453.0    2356.0
           10         7.0    2352.0
           11       455.0    2358.0
           12         5.0    2355.0
           13         3.0    2355.0
           14        24.0    2358.0
           15       456.0    2356.0
           16        14.0    2355.0
           17         2.0    2400.0
           18         3.0    2358.0
           19         7.0    2357.0
           20         1.0    2356.0
           21         9.0    2354.0
           22         3.0    2359.0
           23         7.0    2354.0
           24         1.0    2359.0
           25         1.0    2357.0
           26        13.0    2353.0
           27        10.0    2359.0
           28         2.0    2359.0
           29        11.0    2342.0
           30        12.0    2359.0
     7     1          1.0    2359.0
           2         12.0    2349.0
           3         28.0    2359.0
           4         11.0    2357.0
           5         38.0    2358.0
           6         32.0    2333.0
           7          4.0    2400.0
           8          2.0    2353.0
           9         17.0    2359.0
           10        17.0    2357.0
           11         5.0    2357.0
           12         5.0    2358.0
           13        19.0    2400.0
           14         6.0    2358.0
           15         9.0    2357.0
           16        19.0    2356.0
           17         2.0    2400.0
           18         9.0    2356.0
           19        24.0    2354.0
           20         6.0    2324.0
           21        11.0    2356.0
           22         1.0    2359.0
           23         4.0    2355.0
           24         6.0    2357.0
           25         6.0    2357.0
           26         9.0    2355.0
           27         1.0    2358.0
           28         1.0    2400.0
           29         5.0    2359.0
           30         3.0    2329.0
           31        10.0    2352.0
     8     1         12.0    2358.0
           2          6.0    2357.0
           3          2.0    2357.0
           4          3.0    2321.0
           5          8.0    2337.0
           6         24.0    2358.0
           7        453.0    2358.0
           8         10.0    2359.0
           9          4.0    2359.0
           10        13.0    2400.0
           11         4.0    2352.0
           12        12.0    2358.0
           13       208.0    2359.0
           14         7.0    2338.0
           15         1.0    2359.0
           16        23.0    2358.0
           17         7.0    2354.0
           18        13.0    2359.0
           19         1.0    2358.0
           20        54.0    2400.0
           21        10.0    2353.0
           22         9.0    2350.0
           23         9.0    2328.0
           24        24.0    2359.0
           25         3.0    2351.0
           26        13.0    2258.0
           27         8.0    2350.0
           28        10.0    2358.0
           29        21.0    2357.0
           30       450.0    2359.0
           31       455.0    2359.0
     9     1          9.0    2352.0
           2          8.0    2400.0
           3        457.0    2357.0
           4        446.0    2258.0
           5        450.0    2352.0
           6          8.0    2341.0
           7        452.0    2246.0
           8        509.0    2358.0
           9        451.0    2354.0
           10       453.0    2347.0
           11        11.0    2351.0
           12         2.0    2400.0
           13         3.0    2352.0
           14       453.0    2349.0
           15       509.0    2351.0
           16       453.0    2346.0
           17       450.0    2352.0
           18       450.0    2349.0
           19        10.0    2353.0
           20         9.0    2349.0
           21         8.0    2306.0
           22       518.0    2350.0
           23       455.0    2342.0
           24       455.0    2348.0
           25       451.0    2358.0
           26       451.0    2349.0
           27       453.0    2346.0
           28       451.0    2351.0
           29       521.0    2356.0
           30       453.0    2349.0
     10    1        447.0    2349.0
           2        449.0    2341.0
           3        453.0    2355.0
           4          7.0    2343.0
           5        453.0    2354.0
           6        519.0    2346.0
           7          6.0    2356.0
           8        141.0    2349.0
           9        452.0    2346.0
           10       457.0    2358.0
           11         8.0    2359.0
           12       457.0    2354.0
           13        15.0    2352.0
           14       451.0    2347.0
           15       456.0    2355.0
           16       454.0    2357.0
           17       453.0    2357.0
           18         9.0    2317.0
           19       454.0    2356.0
           20       517.0    2349.0
           21       453.0    2356.0
           22       454.0    2343.0
           23       454.0    2355.0
           24       453.0    2347.0
           25        13.0    2353.0
           26       451.0    2356.0
           27        16.0    2352.0
           28       453.0    2357.0
           29       456.0    2353.0
           30       455.0    2400.0
           31       458.0    2357.0
     11    1          5.0    2353.0
           2        453.0    2358.0
           3        519.0    2358.0
           4         11.0    2357.0
           5          4.0    2359.0
           6        457.0    2355.0
           7        457.0    2358.0
           8        457.0    2357.0
           9         52.0    2355.0
           10       147.0    2354.0
           11       453.0    2355.0
           12       455.0    2356.0
           13         1.0    2355.0
           14       453.0    2359.0
           15         3.0    2354.0
           16       455.0    2359.0
           17         3.0    2359.0
           18        11.0    2355.0
           19        59.0    2356.0
           20       455.0    2355.0
           21         6.0    2351.0
           22         6.0    2351.0
           23       504.0    2356.0
           24        22.0    2358.0
           25         5.0    2355.0
           26       458.0    2357.0
           27        28.0    2400.0
           28       514.0    2356.0
           29       518.0    2353.0
           30        11.0    2354.0
     12    1         13.0    2354.0
           2         12.0    2358.0
           3        457.0    2358.0
           4        457.0    2355.0
           5         16.0    2400.0
           6          6.0    2357.0
           7          3.0    2358.0
           8         16.0    2354.0
           9         11.0    2400.0
           10         7.0    2348.0
           11       459.0    2359.0
           12         2.0    2356.0
           13        15.0    2400.0
           14         3.0    2359.0
           15         5.0    2359.0
           16         1.0    2332.0
           17         4.0    2358.0
           18       500.0    2358.0
           19        17.0    2400.0
           20         1.0    2358.0
           21         2.0    2357.0
           22         7.0    2358.0
           23        11.0    2354.0
           24         9.0    2358.0
           25       456.0    2357.0
           26         1.0    2355.0
           27         2.0    2351.0
           28         7.0    2358.0
           29         3.0    2400.0
           30         1.0    2356.0
           31        13.0    2356.0</code></pre>
</div>
</div>
</div>
<div id="tabset-26-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@pipe</span> not_cancelled <span class="op">|&gt;</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(_, [<span class="op">:</span>year, <span class="op">:</span>month, <span class="op">:</span>day]) <span class="op">|&gt;</span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>    _, </span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>dep_time <span class="op">=&gt;</span> first <span class="op">=&gt;</span> <span class="op">:</span>first_dep,</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>dep_time <span class="op">=&gt;</span> last <span class="op">=&gt;</span> <span class="op">:</span>last_dep</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>365×5 DataFrame
 Row │ year   month  day    first_dep  last_dep
     │ Int64  Int64  Int64  Int64      Int64
─────┼──────────────────────────────────────────
   1 │  2013      1      1        517      2356
   2 │  2013      1      2         42      2354
   3 │  2013      1      3         32      2349
   4 │  2013      1      4         25      2358
   5 │  2013      1      5         14      2357
   6 │  2013      1      6         16      2355
   7 │  2013      1      7         49      2359
   8 │  2013      1      8        454      2351
  ⋮  │   ⋮      ⋮      ⋮        ⋮         ⋮
 359 │  2013     12     25        456      2357
 360 │  2013     12     26          1      2355
 361 │  2013     12     27          2      2351
 362 │  2013     12     28          7      2358
 363 │  2013     12     29          3      2400
 364 │  2013     12     30          1      2356
 365 │  2013     12     31         13      2356
                                350 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Count: <code>n(x)</code>, <code>sum(!is.na(x))</code>, <code>n_distinct(x)</code>.</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-2" role="tab" aria-controls="tabset-27-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-3" role="tab" aria-controls="tabset-27-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-27-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Which destinations have the most carriers?</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dest) <span class="sc">%&gt;%</span> </span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">carriers =</span> <span class="fu">n_distinct</span>(carrier)) <span class="sc">%&gt;%</span> </span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(carriers))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 104 × 2
   dest  carriers
   &lt;chr&gt;    &lt;int&gt;
 1 ATL          7
 2 BOS          7
 3 CLT          7
 4 ORD          7
 5 TPA          7
 6 AUS          6
 7 DCA          6
 8 DTW          6
 9 IAD          6
10 MSP          6
# … with 94 more rows</code></pre>
</div>
</div>
<p>Similarly</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># which destination has most flights from NYC?</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(dest) <span class="sc">%&gt;%</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 104 × 2
   dest      n
   &lt;chr&gt; &lt;int&gt;
 1 ATL   16837
 2 ORD   16566
 3 LAX   16026
 4 BOS   15022
 5 MCO   13967
 6 CLT   13674
 7 SFO   13173
 8 FLL   11897
 9 MIA   11593
10 DCA    9111
# … with 94 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-27-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>not_cancelled.groupby(<span class="st">'dest'</span>).agg(</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>  carriers <span class="op">=</span> (<span class="st">'carrier'</span>, <span class="kw">lambda</span> x: x.nunique(dropna <span class="op">=</span> <span class="va">True</span>))</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>).sort_values(<span class="st">'carriers'</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      carriers
dest          
ORD          7
CLT          7
ATL          7
BOS          7
TPA          7
DTW          6
PIT          6
STL          6
DCA          6
AUS          6
MSY          6
MSP          6
IAD          6
SFO          5
RDU          5
CLE          5
PHX          5
SEA          5
DEN          5
PHL          5
PBI          5
LAS          5
LAX          5
BNA          5
IND          5
SAN          4
JAX          4
FLL          4
RSW          4
MCO          4
MKE          4
DFW          4
CVG          4
SRQ          4
CHS          4
SJU          4
BUF          4
BWI          4
ORF          3
MIA          3
MEM          3
SYR          3
OMA          3
STT          3
BTV          3
MCI          3
PDX          3
CMH          3
PWM          3
SDF          3
ROC          3
SAT          3
MSN          2
SJC          2
MVY          2
RIC          2
TVC          2
TYS          2
SLC          2
XNA          2
MHT          2
HOU          2
AVL          2
BDL          2
BQN          2
CAE          2
DAY          2
DSM          2
GRR          2
GSO          2
GSP          2
HNL          2
EGE          2
IAH          2
JAC          2
CAK          1
ALB          1
ANC          1
TUL          1
MTJ          1
ACK          1
BGR          1
BHM          1
MYR          1
SNA          1
SMF          1
BUR          1
BZN          1
OAK          1
CHO          1
HDN          1
CRW          1
SBN          1
SAV          1
OKC          1
LGB          1
MDW          1
EYW          1
LEX          1
ILM          1
PVD          1
PSP          1
PSE          1
ABQ          1</code></pre>
</div>
</div>
</div>
<div id="tabset-27-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@pipe</span> not_cancelled <span class="op">|&gt;</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(_, <span class="op">:</span>dest) <span class="op">|&gt;</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(_, <span class="op">:</span>carrier <span class="op">=&gt;</span> length <span class="op">∘</span> unique <span class="op">=&gt;</span> <span class="op">:</span>carriers) <span class="op">|&gt;</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(_, <span class="op">:</span>carriers, rev <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>104×2 DataFrame
 Row │ dest    carriers
     │ String  Int64
─────┼──────────────────
   1 │ ATL            7
   2 │ ORD            7
   3 │ TPA            7
   4 │ BOS            7
   5 │ CLT            7
   6 │ IAD            6
   7 │ MSP            6
   8 │ DTW            6
  ⋮  │   ⋮        ⋮
  98 │ BGR            1
  99 │ ABQ            1
 100 │ ILM            1
 101 │ SBN            1
 102 │ LEX            1
 103 │ CHO            1
 104 │ ANC            1
         89 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Example: which aircraft flew most (in distance) in 2013?</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-28-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-1" role="tab" aria-controls="tabset-28-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-2" role="tab" aria-controls="tabset-28-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-3" role="tab" aria-controls="tabset-28-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-28-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-28-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(tailnum, <span class="at">wt =</span> distance) <span class="sc">%&gt;%</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,037 × 2
   tailnum      n
   &lt;chr&gt;    &lt;dbl&gt;
 1 N328AA  929090
 2 N338AA  921172
 3 N335AA  902271
 4 N327AA  900482
 5 N323AA  839468
 6 N319AA  837924
 7 N336AA  833136
 8 N329AA  825826
 9 N324AA  786159
10 N339AA  783648
# … with 4,027 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-28-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>not_cancelled.groupby(<span class="st">'tailnum'</span>).agg(</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>  total_distance <span class="op">=</span> (<span class="st">'distance'</span>, <span class="bu">sum</span>)</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>).sort_values(<span class="st">'total_distance'</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         total_distance
tailnum                
N328AA           929090
N338AA           921172
N335AA           902271
N327AA           900482
N323AA           839468
...                 ...
N762SK              419
N824AS              296
N881AS              292
N746SK              229
N505SW              185

[4037 rows x 1 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-28-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@pipe</span> not_cancelled <span class="op">|&gt;</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(_, <span class="op">:</span>tailnum) <span class="op">|&gt;</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(_, <span class="op">:</span>distance <span class="op">=&gt;</span> sum <span class="op">∘</span> skipmissing <span class="op">=&gt;</span> <span class="op">:</span>total_distance) <span class="op">|&gt;</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(_, <span class="op">:</span>total_distance, rev <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4037×2 DataFrame
  Row │ tailnum  total_distance
      │ String?  Float64
──────┼─────────────────────────
    1 │ N328AA         929090.0
    2 │ N338AA         921172.0
    3 │ N335AA         902271.0
    4 │ N327AA         900482.0
    5 │ N323AA         839468.0
    6 │ N319AA         837924.0
    7 │ N336AA         833136.0
    8 │ N329AA         825826.0
  ⋮   │    ⋮           ⋮
 4031 │ N772SK            419.0
 4032 │ N776SK            419.0
 4033 │ N785SK            419.0
 4034 │ N824AS            296.0
 4035 │ N881AS            292.0
 4036 │ N746SK            229.0
 4037 │ N505SW            185.0
               4022 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Example: How many flights left before 5am? (these usually indicate delayed flights from the previous day)</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-29-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-1" role="tab" aria-controls="tabset-29-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-2" role="tab" aria-controls="tabset-29-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-3" role="tab" aria-controls="tabset-29-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-29-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-29-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_early =</span> <span class="fu">sum</span>(dep_time <span class="sc">&lt;</span> <span class="dv">500</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n_early))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 4
# Groups:   year, month [12]
    year month   day n_early
   &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;
 1  2013     6    28      32
 2  2013     4    10      30
 3  2013     7    28      30
 4  2013     3    18      29
 5  2013     7     7      29
 6  2013     7    10      27
 7  2013     6    27      25
 8  2013     6    13      24
 9  2013     3     8      22
10  2013     7    22      22
# … with 355 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-29-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>not_cancelled.groupby([<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>]).agg(</span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>  n_early <span class="op">=</span> (<span class="st">'dep_time'</span>, <span class="kw">lambda</span> x: <span class="bu">sum</span>(x <span class="op">&lt;</span> <span class="dv">500</span>))</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>).sort_values(<span class="st">'n_early'</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                n_early
year month day         
2013 6     28        32
     7     28        30
     4     10        30
     7     7         29
     3     18        29
     7     10        27
     6     27        25
           13        24
     7     22        22
     3     8         22
     8     8         22
     6     24        21
     9     12        21
     4     19        20
     5     23        15
     12    17        15
     5     8         14
     7     1         14
     2     11        14
     8     9         13
           1         13
     3     12        13
     7     8         12
     6     25        12
     4     22        12
     6     18        12
     7     23        11
     5     22        11
     6     2         10
     4     18        10
     7     19        10
     6     26        10
     7     12         9
     5     19         9
     6     30         9
     3     7          9
     7     2          9
     1     13         9
           31         9
     12    23         9
           5          9
     8     22         9
     9     2          9
     7     17         8
     4     17         8
     5     10         8
     4     23         8
     8     28         8
     5     11         8
     7     21         8
     10    7          7
     12    8          7
           14         7
     7     16         7
           18         7
     2     19         7
     4     12         7
     12    27         7
     6     10         7
           29         7
     3     17         6
     6     23         6
     5     20         6
     11    17         6
     3     24         6
     7     3          6
     4     24         6
     1     25         6
     12    16         6
     2     27         6
     7     11         6
     12    30         6
     2     15         6
     12    21         5
           12         5
     6     7          5
     8     11         5
     12    10         5
     6     17         5
     8     16         5
     5     2          5
     12    9          5
     7     13         5
           9          5
           6          5
     3     10         5
     2     23         5
     5     16         4
     12    22         4
     4     29         4
     8     5          4
     6     20         4
           21         4
           22         4
     11    21         4
     7     31         4
     9     20         4
           11         4
     8     26         4
           23         4
           21         4
     7     20         4
           25         4
     8     14         4
     7     27         4
     10    11         4
     12    31         4
     3     6          4
     1     3          4
     4     5          4
     3     19         4
           1          4
     2     26         4
           24         4
     3     26         4
     4     14         4
           11         4
     8     6          3
     12    13         3
     3     16         3
     1     11         3
     8     4          3
     3     21         3
           23         3
     6     14         3
     8     12         3
     3     25         3
           28         3
     8     3          3
     6     16         3
     8     10         3
     3     15         3
     7     15         3
     3     11         3
     7     26         3
     2     16         3
           17         3
           18         3
           20         3
     7     24         3
     2     22         3
     7     14         3
     12    7          3
           1          3
     1     16         3
     7     30         3
           4          3
     1     2          3
     8     17         3
     1     10         3
     2     14         3
     5     26         3
     1     4          3
     11    1          3
     4     3          3
     5     3          3
     12    26         3
           19         3
     1     24         3
     5     24         3
           25         3
     8     29         3
     1     5          3
     12    29         3
     4     25         3
     1     9          3
     4     13         3
     7     29         2
     9     19         2
     11    30         2
           4          2
     2     7          2
     8     20         2
     12    2          2
     1     22         2
     9     21         2
     10    25         2
           4          2
           18         2
           8          2
     11    5          2
     9     6          2
     1     23         2
     11    24         2
     1     30         2
           28         2
     2     13         2
     11    19         2
     8     15         2
     2     2          2
     4     15         2
     8     13         2
     11    18         2
           9          2
     8     27         2
     1     26         2
     2     6          2
     9     1          2
     11    15         2
           13         2
     8     19         2
           2          2
     11    22         2
     8     25         2
     2     21         2
     3     30         2
     5     31         2
     12    15         2
     5     28         2
     3     31         2
     4     2          2
     5     18         2
           17         2
           15         2
     1     7          2
     5     13         2
           12         2
     1     6          2
     5     9          2
     4     7          2
     5     7          2
     12    24         2
     5     1          2
     12    28         2
     4     26         2
           21         2
           20         2
     6     1          2
     4     4          2
     10    13         2
     2     28         2
     3     4          2
     12    6          2
     3     13         2
     6     3          2
     3     14         2
           20         2
           22         2
     6     19         2
     3     2          2
     7     5          2
     6     12         2
           5          2
     3     27         2
     10    19         1
           14         1
           15         1
           31         1
           12         1
           30         1
           16         1
           17         1
           29         1
           21         1
           28         1
           27         1
     12    4          1
     10    26         1
     12    25         1
     10    23         1
           22         1
           24         1
     1     17         1
     11    2          1
           16         1
     12    11         1
     11    20         1
     1     12         1
           14         1
           8          1
     12    20         1
     1     15         1
           18         1
     11    25         1
           6          1
     12    3          1
     11    26         1
           14         1
           27         1
           12         1
           11         1
           10         1
           8          1
           7          1
     4     16         1
     1     19         1
     8     24         1
     6     8          1
           9          1
           11         1
           15         1
     3     9          1
     2     25         1
           12         1
           10         1
           8          1
     8     7          1
     2     5          1
           4          1
           3          1
     10    10         1
     8     18         1
     3     29         1
     6     6          1
           4          1
     5     5          1
     4     27         1
           28         1
           9          1
           30         1
           8          1
     5     4          1
           6          1
           30         1
     4     6          1
     5     14         1
           21         1
     4     1          1
     5     27         1
           29         1
     1     29         1
     2     1          1
     9     14         1
           28         1
           26         1
           25         1
           24         1
           23         1
           30         1
     1     21         1
     9     18         1
     8     30         1
     9     17         1
           16         1
     10    1          1
           2          1
     9     27         1
           13         1
           10         1
     10    3          1
     9     9          1
     10    5          1
     9     7          1
           5          1
           4          1
     10    9          1
     9     3          1
     8     31         1
     10    20         0
           6          0
     1     20         0
     9     29         0
     1     27         0
     11    3          0
     12    18         0
     9     22         0
           15         0
     3     5          0
           3          0
     2     9          0
     11    29         0
           28         0
     9     8          0
     11    23         0
     1     1          0</code></pre>
</div>
</div>
</div>
<div id="tabset-29-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@pipe</span> not_cancelled <span class="op">|&gt;</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(_, [<span class="op">:</span>year, <span class="op">:</span>month, <span class="op">:</span>day]) <span class="op">|&gt;</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(_, <span class="op">:</span>dep_time <span class="op">=&gt;</span> (x <span class="op">-&gt;</span> <span class="fu">sum</span>(<span class="fu">skipmissing</span>(x <span class="op">.&lt;</span> <span class="fl">500</span>))) <span class="op">=&gt;</span> <span class="op">:</span>n_early) <span class="op">|&gt;</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(_, <span class="op">:</span>n_early, rev <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>365×4 DataFrame
 Row │ year   month  day    n_early
     │ Int64  Int64  Int64  Int64
─────┼──────────────────────────────
   1 │  2013      6     28       32
   2 │  2013      4     10       30
   3 │  2013      7     28       30
   4 │  2013      3     18       29
   5 │  2013      7      7       29
   6 │  2013      7     10       27
   7 │  2013      6     27       25
   8 │  2013      6     13       24
  ⋮  │   ⋮      ⋮      ⋮       ⋮
 359 │  2013     10      6        0
 360 │  2013     10     20        0
 361 │  2013     11      3        0
 362 │  2013     11     23        0
 363 │  2013     11     28        0
 364 │  2013     11     29        0
 365 │  2013     12     18        0
                    350 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Example: What proportion of flights are delayed by more than an hour?</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-30-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-1" role="tab" aria-controls="tabset-30-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-2" role="tab" aria-controls="tabset-30-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-3" role="tab" aria-controls="tabset-30-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-30-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-30-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">hour_perc =</span> <span class="fu">mean</span>(arr_delay <span class="sc">&gt;</span> <span class="dv">60</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(hour_perc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 4
# Groups:   year, month [12]
    year month   day hour_perc
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;
 1  2013     3     8     0.525
 2  2013     6    13     0.402
 3  2013     7     1     0.401
 4  2013     7    22     0.366
 5  2013     5    23     0.361
 6  2013     8     8     0.361
 7  2013     9    12     0.350
 8  2013    12    17     0.339
 9  2013     7    10     0.332
10  2013     6    24     0.323
# … with 355 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-30-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>not_cancelled.groupby([<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>]).agg(</span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>  hour_perc <span class="op">=</span> (<span class="st">'arr_delay'</span>, <span class="kw">lambda</span> x: np.mean(x <span class="op">&gt;</span> <span class="dv">60</span>))</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>).sort_values(<span class="st">'hour_perc'</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                hour_perc
year month day           
2013 3     8     0.525063
     6     13    0.401816
     7     1     0.401368
           22    0.365967
     5     23    0.361111
     8     8     0.360603
     9     12    0.350327
     12    17    0.338922
     7     10    0.332151
     6     24    0.322618
     7     28    0.311916
           23    0.311384
     8     9     0.309345
     6     28    0.298611
           30    0.293833
           25    0.292632
     9     2     0.286564
     7     7     0.285877
     10    7     0.285868
     6     27    0.279910
     12    5     0.276885
     4     19    0.272936
     8     28    0.270033
     5     8     0.269877
     12    10    0.269283
     7     9     0.263158
     4     22    0.259338
     12    9     0.257778
           14    0.254902
     6     18    0.245614
     4     10    0.243902
     12    8     0.242236
     3     18    0.241081
     2     11    0.240566
     4     18    0.239451
           12    0.237418
     7     8     0.233753
     8     1     0.233083
     6     10    0.227176
     2     27    0.224806
     6     17    0.224156
           2     0.218027
           26    0.217622
     1     31    0.216409
     8     22    0.214588
     1     30    0.203518
     12    23    0.200000
     4     25    0.197917
     5     19    0.195556
     6     7     0.193370
     1     16    0.191090
     5     22    0.188804
     3     19    0.182505
     5     24    0.180085
     3     12    0.179800
     5     11    0.176387
     8     13    0.174893
     1     25    0.174061
     6     3     0.170502
     12    22    0.167043
     7     12    0.164802
     4     11    0.163694
           23    0.161430
     10    11    0.157219
     4     24    0.156652
     7     3     0.153450
     12    29    0.148618
     4     26    0.148262
     1     13    0.147460
     7     18    0.147271
     6     14    0.145530
     11    17    0.145161
     3     7     0.144154
     7     2     0.137297
           25    0.133673
           13    0.131646
     2     8     0.125275
     3     25    0.122334
     7     21    0.121816
     9     11    0.121577
     7     11    0.119099
     12    6     0.118363
     1     24    0.114537
     12    15    0.112745
     10    10    0.109744
     6     29    0.108723
     11    27    0.108495
     7     19    0.107472
     3     6     0.107459
     2     23    0.105978
           19    0.102481
     11    1     0.100427
     3     24    0.100112
     9     13    0.099794
     12    20    0.099792
     7     24    0.098577
     4     1     0.098019
     6     23    0.097588
     5     10    0.097107
     7     20    0.096939
     12    21    0.096130
     1     22    0.094915
     11    7     0.092324
     1     28    0.092182
     3     23    0.090789
     7     29    0.088957
     5     20    0.088174
           9     0.088083
     1     2     0.085129
     9     19    0.084974
     2     10    0.083645
           22    0.081110
     4     17    0.080169
     2     4     0.077342
     12    26    0.076344
     6     11    0.075884
     2     9     0.075601
     7     17    0.075051
     5     3     0.074766
     7     26    0.074187
     8     14    0.073887
     11    12    0.072690
     12    30    0.072403
     1     1     0.072202
     10    25    0.071138
     11    24    0.071106
     2     1     0.070485
     5     30    0.070480
     8     2     0.070480
     1     23    0.069820
     4     2     0.068367
     3     16    0.068331
     12    19    0.067288
     8     3     0.066835
     10    3     0.066667
     11    22    0.066599
     1     21    0.066519
     3     14    0.066327
     4     16    0.066089
           9     0.065762
     8     7     0.065392
     5     16    0.064286
     3     15    0.063918
     7     16    0.063136
     10    17    0.062690
     3     22    0.061728
     4     14    0.061538
     12    11    0.060445
     1     20    0.058899
     2     21    0.058761
     8     10    0.058531
     4     20    0.058355
     3     1     0.058263
     1     3     0.056667
     5     21    0.055907
     1     27    0.055831
           17    0.055738
     2     20    0.055734
     3     21    0.055556
     12    16    0.055497
     4     4     0.055215
     2     25    0.054025
     3     10    0.053215
     6     8     0.053109
     12    27    0.053070
     8     11    0.053030
     2     26    0.052397
     8     4     0.052231
     7     14    0.051948
     5     15    0.051797
           4     0.051491
     12    18    0.051471
           2     0.051102
     5     28    0.050672
     8     12    0.050454
     3     31    0.050448
     4     21    0.050109
           5     0.050051
     7     27    0.049751
     5     25    0.049724
     3     17    0.048998
     6     21    0.048682
           19    0.048304
     2     17    0.048193
     9     20    0.047959
     1     6     0.047045
     3     20    0.047022
     4     13    0.046997
     2     5     0.046750
           15    0.046512
     3     2     0.046419
     10    18    0.046418
     5     17    0.045918
     11    26    0.045685
     5     31    0.045643
     4     15    0.044534
     2     14    0.044118
           3     0.044081
     4     29    0.044012
     3     9     0.043883
     8     16    0.043478
     12    31    0.043478
     8     15    0.043260
     11    10    0.042649
     2     7     0.042162
     8     5     0.042126
     2     16    0.042120
     12    7     0.042042
     7     30    0.041582
     8     29    0.041152
     3     4     0.040752
     12    12    0.040667
           3     0.040415
     2     6     0.040359
           24    0.040276
     3     11    0.040041
     1     4     0.039648
     11    28    0.039432
     2     18    0.039320
     6     16    0.039301
     9     3     0.039236
     12    4     0.039153
           1     0.038815
     8     18    0.038631
           6     0.038540
     3     13    0.038422
     10    31    0.038210
     12    28    0.038130
     5     6     0.037988
     10    15    0.037775
     12    25    0.037762
     9     21    0.037681
     5     2     0.037075
     10    26    0.036873
     6     12    0.036726
     3     3     0.036384
     7     31    0.036217
     6     22    0.036025
     5     13    0.036008
     1     26    0.035768
     8     30    0.035639
     6     4     0.035565
     11    18    0.035417
     6     15    0.035354
           6     0.035306
     1     18    0.035165
           5     0.034868
     8     23    0.034588
     10    27    0.034216
     2     12    0.033937
     3     28    0.033811
     9     22    0.033482
     7     6     0.033376
     1     7     0.033333
     5     29    0.033195
     7     5     0.033007
     2     2     0.032496
     11    23    0.032432
     9     10    0.032393
     1     29    0.032221
     3     5     0.032154
     10    4     0.031377
     6     5     0.031315
     8     31    0.031250
     2     13    0.031077
     6     9     0.030973
     8     17    0.030888
     11    11    0.030644
     5     14    0.030591
     10    22    0.030177
           13    0.030067
     4     28    0.029703
     11    8     0.029622
     9     23    0.029382
           29    0.027473
     1     15    0.027242
           14    0.027086
     12    13    0.026999
     10    12    0.026746
     5     5     0.026432
     7     15    0.026236
     2     28    0.026233
     11    19    0.025907
     5     12    0.025872
     9     18    0.025800
     10    23    0.025773
     11    3     0.025556
     10    28    0.025536
     8     20    0.025407
     10    24    0.025355
     9     1     0.025281
     10    20    0.025164
     1     11    0.025082
     5     27    0.024865
     10    5     0.024781
     4     3     0.024291
     10    8     0.023958
     11    4     0.023663
     4     6     0.023468
     8     24    0.023346
           25    0.023333
     4     7     0.023153
     8     27    0.022965
     11    6     0.022822
     5     18    0.022788
     8     26    0.022610
     12    24    0.022606
     11    16    0.022504
     9     15    0.022447
     11    25    0.022436
     10    6     0.021882
     5     1     0.021830
     10    9     0.021717
     1     8     0.021300
     9     27    0.021212
     4     27    0.021192
     1     19    0.020864
     3     26    0.020704
     11    2     0.020679
     10    30    0.020640
     4     8     0.020640
     3     29    0.020619
     9     14    0.020558
     11    20    0.020534
     3     27    0.020534
     7     4     0.020464
     11    14    0.020346
     1     9     0.020157
     11    30    0.019906
     3     30    0.019582
     8     19    0.019231
     9     26    0.019153
     11    21    0.019134
     4     30    0.018888
     9     8     0.018847
     10    29    0.018809
           14    0.018330
     1     10    0.018299
     11    13    0.017472
     9     16    0.017294
     10    21    0.017224
     9     25    0.016598
     10    19    0.016153
     11    5     0.015609
     9     30    0.015213
     6     20    0.015198
           1     0.014686
     9     5     0.014493
     10    16    0.014448
     8     21    0.014271
     11    15    0.014257
     9     9     0.014170
           4     0.013874
     5     7     0.013713
     11    29    0.013636
     5     26    0.010989
     9     28    0.010370
     1     12    0.010279
     9     7     0.010204
           17    0.009395
     10    1     0.009375
           2     0.009250
     9     6     0.008316
           24    0.007376
     11    9     0.007013</code></pre>
</div>
</div>
</div>
<div id="tabset-30-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@pipe</span> not_cancelled <span class="op">|&gt;</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(_, [<span class="op">:</span>year, <span class="op">:</span>month, <span class="op">:</span>day]) <span class="op">|&gt;</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(_, <span class="op">:</span>arr_delay <span class="op">=&gt;</span> (x <span class="op">-&gt;</span> <span class="fu">mean</span>(<span class="fu">skipmissing</span>(x <span class="op">.&gt;</span> <span class="fl">60</span>))) <span class="op">=&gt;</span> <span class="op">:</span>hour_perc) <span class="op">|&gt;</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(_, <span class="op">:</span>hour_perc, rev <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>365×4 DataFrame
 Row │ year   month  day    hour_perc
     │ Int64  Int64  Int64  Float64
─────┼─────────────────────────────────
   1 │  2013      3      8  0.525063
   2 │  2013      6     13  0.401816
   3 │  2013      7      1  0.401368
   4 │  2013      7     22  0.365967
   5 │  2013      5     23  0.361111
   6 │  2013      8      8  0.360603
   7 │  2013      9     12  0.350327
   8 │  2013     12     17  0.338922
  ⋮  │   ⋮      ⋮      ⋮        ⋮
 359 │  2013      9      7  0.0102041
 360 │  2013      9     17  0.00939457
 361 │  2013     10      1  0.009375
 362 │  2013     10      2  0.00924974
 363 │  2013      9      6  0.00831601
 364 │  2013      9     24  0.00737619
 365 │  2013     11      9  0.00701262
                       350 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="grouped-mutates-and-filters" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="grouped-mutates-and-filters"><span class="header-section-number">6</span> Grouped mutates (and filters)</h2>
<ul>
<li>Recall the <code>flights_sml</code> tibble created earlier:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-31-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-1" role="tab" aria-controls="tabset-31-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-2" role="tab" aria-controls="tabset-31-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-3" role="tab" aria-controls="tabset-31-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-31-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-31-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>flights_sml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 7
    year month   day dep_delay arr_delay distance air_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2013     1     1         2        11     1400      227
 2  2013     1     1         4        20     1416      227
 3  2013     1     1         2        33     1089      160
 4  2013     1     1        -1       -18     1576      183
 5  2013     1     1        -6       -25      762      116
 6  2013     1     1        -4        12      719      150
 7  2013     1     1        -5        19     1065      158
 8  2013     1     1        -3       -14      229       53
 9  2013     1     1        -3        -8      944      140
10  2013     1     1        -2         8      733      138
# … with 336,766 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-31-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>flights_sml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_delay  arr_delay  distance  air_time  gain  \
0       2013      1    1        2.0       11.0      1400     227.0   9.0   
1       2013      1    1        4.0       20.0      1416     227.0  16.0   
2       2013      1    1        2.0       33.0      1089     160.0  31.0   
3       2013      1    1       -1.0      -18.0      1576     183.0 -17.0   
4       2013      1    1       -6.0      -25.0       762     116.0 -19.0   
...      ...    ...  ...        ...        ...       ...       ...   ...   
336771  2013      9   30        NaN        NaN       213       NaN   NaN   
336772  2013      9   30        NaN        NaN       198       NaN   NaN   
336773  2013      9   30        NaN        NaN       764       NaN   NaN   
336774  2013      9   30        NaN        NaN       419       NaN   NaN   
336775  2013      9   30        NaN        NaN       431       NaN   NaN   

             speed  
0       370.044053  
1       374.273128  
2       408.375000  
3       516.721311  
4       394.137931  
...            ...  
336771         NaN  
336772         NaN  
336773         NaN  
336774         NaN  
336775         NaN  

[336776 rows x 9 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-31-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>flights_sml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×8 DataFrame
    Row │ year   month  day    dep_delay  arr_delay  distance  air_time   gain ⋯
        │ Int64  Int64  Int64  Float64?   Float64?   Float64   Float64?   Floa ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      1      1        2.0       11.0    1400.0      227.0       ⋯
      2 │  2013      1      1        4.0       20.0    1416.0      227.0
      3 │  2013      1      1        2.0       33.0    1089.0      160.0
      4 │  2013      1      1       -1.0      -18.0    1576.0      183.0
      5 │  2013      1      1       -6.0      -25.0     762.0      116.0       ⋯
      6 │  2013      1      1       -4.0       12.0     719.0      150.0
      7 │  2013      1      1       -5.0       19.0    1065.0      158.0
      8 │  2013      1      1       -3.0      -14.0     229.0       53.0
   ⋮    │   ⋮      ⋮      ⋮        ⋮          ⋮         ⋮          ⋮           ⋱
 336770 │  2013      9     30      -10.0      -25.0    1617.0      196.0       ⋯
 336771 │  2013      9     30  missing    missing       764.0  missing    miss
 336772 │  2013      9     30  missing    missing       213.0  missing    miss
 336773 │  2013      9     30  missing    missing       198.0  missing    miss
 336774 │  2013      9     30  missing    missing       764.0  missing    miss ⋯
 336775 │  2013      9     30  missing    missing       419.0  missing    miss
 336776 │  2013      9     30  missing    missing       431.0  missing    miss
                                                1 column and 336761 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Find the worst members of each group:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-32-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-1" role="tab" aria-controls="tabset-32-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-2" role="tab" aria-controls="tabset-32-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-3" role="tab" aria-controls="tabset-32-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-32-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-32-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>flights_sml <span class="sc">%&gt;%</span> </span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span></span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">rank</span>(<span class="fu">desc</span>(arr_delay)) <span class="sc">&lt;</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,306 × 7
# Groups:   year, month, day [365]
    year month   day dep_delay arr_delay distance air_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2013     1     1       853       851      184       41
 2  2013     1     1       290       338     1134      213
 3  2013     1     1       260       263      266       46
 4  2013     1     1       157       174      213       60
 5  2013     1     1       216       222      708      121
 6  2013     1     1       255       250      589      115
 7  2013     1     1       285       246     1085      146
 8  2013     1     1       192       191      199       44
 9  2013     1     1       379       456     1092      222
10  2013     1     2       224       207      550       94
# … with 3,296 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-32-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>flights_sml.groupby(</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>]</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>  )[<span class="st">'arr_delay'</span>].nlargest(</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>year  month  day        
2013  1      1    151       851.0
                  834       456.0
                  649       338.0
                  673       263.0
                  801       250.0
                            ...  
      12     31   111017    155.0
                  110962    142.0
                  110653    140.0
                  111217    136.0
                  111144    122.0
Name: arr_delay, Length: 3650, dtype: float64</code></pre>
</div>
</div>
</div>
<div id="tabset-32-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@pipe</span> flights_sml <span class="op">|&gt;</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dropmissing</span>(_, <span class="op">:</span>arr_delay) <span class="op">|&gt;</span></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(_, [<span class="op">:</span>year, <span class="op">:</span>month, <span class="op">:</span>day]) <span class="op">|&gt;</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(</span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>    _,</span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>arr_delay <span class="op">=&gt;</span> (x <span class="op">-&gt;</span> x[x <span class="op">.&gt;=</span> <span class="fu">partialsort</span>(x, <span class="fl">10</span>, rev <span class="op">=</span> <span class="cn">true</span>)])</span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3697×4 DataFrame
  Row │ year   month  day    arr_delay_function
      │ Int64  Int64  Int64  Float64
──────┼─────────────────────────────────────────
    1 │  2013      1      1               851.0
    2 │  2013      1      1               338.0
    3 │  2013      1      1               263.0
    4 │  2013      1      1               166.0
    5 │  2013      1      1               174.0
    6 │  2013      1      1               222.0
    7 │  2013      1      1               250.0
    8 │  2013      1      1               246.0
  ⋮   │   ⋮      ⋮      ⋮            ⋮
 3691 │  2013     12     31               155.0
 3692 │  2013     12     31               231.0
 3693 │  2013     12     31               122.0
 3694 │  2013     12     31               222.0
 3695 │  2013     12     31               188.0
 3696 │  2013     12     31               136.0
 3697 │  2013     12     31               195.0
                               3682 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Find all groups bigger than a threshold:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-33-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-1" role="tab" aria-controls="tabset-33-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-2" role="tab" aria-controls="tabset-33-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-3" role="tab" aria-controls="tabset-33-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-33-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-33-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>popular_dests <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dest) <span class="sc">%&gt;%</span> </span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">365</span>) <span class="sc">%&gt;%</span></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 332,577 × 19
# Groups:   dest [77]
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
   arr_delay carrier flight tailnum origin dest  air_time distance  hour minute
       &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1        11 UA        1545 N14228  EWR    IAH        227     1400     5     15
 2        20 UA        1714 N24211  LGA    IAH        227     1416     5     29
 3        33 AA        1141 N619AA  JFK    MIA        160     1089     5     40
 4       -18 B6         725 N804JB  JFK    BQN        183     1576     5     45
 5       -25 DL         461 N668DN  LGA    ATL        116      762     6      0
 6        12 UA        1696 N39463  EWR    ORD        150      719     5     58
 7        19 B6         507 N516JB  EWR    FLL        158     1065     6      0
 8       -14 EV        5708 N829AS  LGA    IAD         53      229     6      0
 9        -8 B6          79 N593JB  JFK    MCO        140      944     6      0
10         8 AA         301 N3ALAA  LGA    ORD        138      733     6      0
   time_hour          
   &lt;dttm&gt;             
 1 2013-01-01 05:00:00
 2 2013-01-01 05:00:00
 3 2013-01-01 05:00:00
 4 2013-01-01 05:00:00
 5 2013-01-01 06:00:00
 6 2013-01-01 05:00:00
 7 2013-01-01 06:00:00
 8 2013-01-01 06:00:00
 9 2013-01-01 06:00:00
10 2013-01-01 06:00:00
# … with 332,567 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-33-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-33-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>popular_dests <span class="op">=</span> flights.groupby(<span class="st">'dest'</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> x: <span class="bu">len</span>(x) <span class="op">&gt;</span> <span class="dv">365</span>)</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>popular_dests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
0       2013      1    1     517.0             515        2.0     830.0   
1       2013      1    1     533.0             529        4.0     850.0   
2       2013      1    1     542.0             540        2.0     923.0   
3       2013      1    1     544.0             545       -1.0    1004.0   
4       2013      1    1     554.0             600       -6.0     812.0   
...      ...    ...  ...       ...             ...        ...       ...   
336771  2013      9   30       NaN            1455        NaN       NaN   
336772  2013      9   30       NaN            2200        NaN       NaN   
336773  2013      9   30       NaN            1210        NaN       NaN   
336774  2013      9   30       NaN            1159        NaN       NaN   
336775  2013      9   30       NaN             840        NaN       NaN   

        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \
0                  819       11.0      UA    1545  N14228    EWR  IAH   
1                  830       20.0      UA    1714  N24211    LGA  IAH   
2                  850       33.0      AA    1141  N619AA    JFK  MIA   
3                 1022      -18.0      B6     725  N804JB    JFK  BQN   
4                  837      -25.0      DL     461  N668DN    LGA  ATL   
...                ...        ...     ...     ...     ...    ...  ...   
336771            1634        NaN      9E    3393     NaN    JFK  DCA   
336772            2312        NaN      9E    3525     NaN    LGA  SYR   
336773            1330        NaN      MQ    3461  N535MQ    LGA  BNA   
336774            1344        NaN      MQ    3572  N511MQ    LGA  CLE   
336775            1020        NaN      MQ    3531  N839MQ    LGA  RDU   

        air_time  distance  hour  minute                 time_hour  
0          227.0      1400     5      15 2013-01-01 10:00:00+00:00  
1          227.0      1416     5      29 2013-01-01 10:00:00+00:00  
2          160.0      1089     5      40 2013-01-01 10:00:00+00:00  
3          183.0      1576     5      45 2013-01-01 10:00:00+00:00  
4          116.0       762     6       0 2013-01-01 11:00:00+00:00  
...          ...       ...   ...     ...                       ...  
336771       NaN       213    14      55 2013-09-30 18:00:00+00:00  
336772       NaN       198    22       0 2013-10-01 02:00:00+00:00  
336773       NaN       764    12      10 2013-09-30 16:00:00+00:00  
336774       NaN       419    11      59 2013-09-30 15:00:00+00:00  
336775       NaN       431     8      40 2013-09-30 12:00:00+00:00  

[332577 rows x 19 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-33-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-33-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>popular_dests <span class="op">=</span> <span class="pp">@pipe</span> flights <span class="op">|&gt;</span> </span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(_, <span class="op">:</span>dest) <span class="op">|&gt;</span></span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(_) <span class="cf">do</span> sdf</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(sdf) <span class="op">&gt;</span> <span class="fl">365</span> ? sdf <span class="op">:</span> <span class="fu">DataFrame</span>()</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>332577×19 DataFrame
    Row │ dest    year   month  day    dep_time  sched_dep_time  dep_delay  ar ⋯
        │ String  Int64  Int64  Int64  Int64?    Int64           Float64?   In ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │ IAH      2013      1      1       517             515        2.0     ⋯
      2 │ IAH      2013      1      1       533             529        4.0
      3 │ IAH      2013      1      1       623             627       -4.0
      4 │ IAH      2013      1      1       728             732       -4.0
      5 │ IAH      2013      1      1       739             739        0.0     ⋯
      6 │ IAH      2013      1      1       908             908        0.0
      7 │ IAH      2013      1      1      1028            1026        2.0
      8 │ IAH      2013      1      1      1044            1045       -1.0
   ⋮    │   ⋮       ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋱
 332571 │ BGR      2013      9     27      2319            2205       74.0     ⋯
 332572 │ BGR      2013      9     28      1125            1130       -5.0
 332573 │ BGR      2013      9     28      1804            1810       -6.0
 332574 │ BGR      2013      9     29      1056            1100       -4.0
 332575 │ BGR      2013      9     29      2203            2205       -2.0     ⋯
 332576 │ BGR      2013      9     30      1057            1100       -3.0
 332577 │ BGR      2013      9     30      2203            2205       -2.0
                                              12 columns and 332562 rows omitted</code></pre>
</div>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>popular_dests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>332577×19 DataFrame
    Row │ dest    year   month  day    dep_time  sched_dep_time  dep_delay  ar ⋯
        │ String  Int64  Int64  Int64  Int64?    Int64           Float64?   In ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │ IAH      2013      1      1       517             515        2.0     ⋯
      2 │ IAH      2013      1      1       533             529        4.0
      3 │ IAH      2013      1      1       623             627       -4.0
      4 │ IAH      2013      1      1       728             732       -4.0
      5 │ IAH      2013      1      1       739             739        0.0     ⋯
      6 │ IAH      2013      1      1       908             908        0.0
      7 │ IAH      2013      1      1      1028            1026        2.0
      8 │ IAH      2013      1      1      1044            1045       -1.0
   ⋮    │   ⋮       ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋱
 332571 │ BGR      2013      9     27      2319            2205       74.0     ⋯
 332572 │ BGR      2013      9     28      1125            1130       -5.0
 332573 │ BGR      2013      9     28      1804            1810       -6.0
 332574 │ BGR      2013      9     29      1056            1100       -4.0
 332575 │ BGR      2013      9     29      2203            2205       -2.0     ⋯
 332576 │ BGR      2013      9     30      1057            1100       -3.0
 332577 │ BGR      2013      9     30      2203            2205       -2.0
                                              12 columns and 332562 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Standardise to compute per group metrics:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-34-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-1" role="tab" aria-controls="tabset-34-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-2" role="tab" aria-controls="tabset-34-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-3" role="tab" aria-controls="tabset-34-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-34-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-34-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>popular_dests <span class="ot">=</span> popular_dests <span class="sc">%&gt;%</span> </span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(arr_delay <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_delay =</span> arr_delay <span class="sc">/</span> <span class="fu">sum</span>(arr_delay)) <span class="sc">%&gt;%</span></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year<span class="sc">:</span>day, dest, arr_delay, prop_delay) <span class="sc">%&gt;%</span></span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 131,106 × 6
# Groups:   dest [77]
    year month   day dest  arr_delay prop_delay
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1  2013     1     1 IAH          11  0.000111 
 2  2013     1     1 IAH          20  0.000201 
 3  2013     1     1 MIA          33  0.000235 
 4  2013     1     1 ORD          12  0.0000424
 5  2013     1     1 FLL          19  0.0000938
 6  2013     1     1 ORD           8  0.0000283
 7  2013     1     1 LAX           7  0.0000344
 8  2013     1     1 DFW          31  0.000282 
 9  2013     1     1 ATL          12  0.0000400
10  2013     1     1 DTW          16  0.000116 
# … with 131,096 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-34-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>popular_dests[popular_dests[<span class="st">'arr_delay'</span>] <span class="op">&gt;</span> <span class="dv">0</span>].groupby(</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'dest'</span></span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>  ).<span class="bu">apply</span>(</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">lambda</span> x: x[<span class="st">'arr_delay'</span>] <span class="op">/</span> x[<span class="st">'arr_delay'</span>].<span class="bu">sum</span>()</span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dest        
ALB   569       0.004175
      784       0.004593
      1536      0.007411
      1757      0.008559
      2425      0.004175
                  ...   
XNA   325031    0.006818
      326901    0.001737
      330832    0.000386
      332101    0.007204
      335551    0.000257
Name: arr_delay, Length: 131106, dtype: float64</code></pre>
</div>
</div>
</div>
<div id="tabset-34-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@pipe</span> popular_dests <span class="op">|&gt;</span> </span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dropmissing</span>(_, <span class="op">:</span>arr_delay) <span class="op">|&gt;</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(_, <span class="op">:</span>arr_delay <span class="op">=&gt;</span> x <span class="op">-&gt;</span> x <span class="op">.&gt;</span> <span class="fl">0</span> ) <span class="op">|&gt;</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(_, <span class="op">:</span>dest) <span class="op">|&gt;</span></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(_, <span class="op">:</span>arr_delay <span class="op">=&gt;</span> (x <span class="op">-&gt;</span> x <span class="op">./</span> <span class="fu">sum</span>(x)) <span class="op">=&gt;</span> <span class="op">:</span>prop_delay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>131106×2 DataFrame
    Row │ dest    prop_delay
        │ String  Float64
────────┼─────────────────────
      1 │ IAH     0.000110674
      2 │ IAH     0.000201225
      3 │ IAH     1.00613e-5
      4 │ IAH     3.01838e-5
      5 │ IAH     0.000261593
      6 │ IAH     9.05515e-5
      7 │ IAH     0.000110674
      8 │ IAH     1.00613e-5
   ⋮    │   ⋮          ⋮
 131100 │ BGR     0.000432277
 131101 │ BGR     0.0054755
 131102 │ BGR     0.00273775
 131103 │ BGR     0.00345821
 131104 │ BGR     0.00907781
 131105 │ BGR     0.0018732
 131106 │ BGR     0.00115274
           131091 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="combine-tables" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="combine-tables"><span class="header-section-number">7</span> Combine tables</h2>
<p>nycflights13 package has &gt;1 tables:</p>
<ul>
<li>We already know a lot about flights:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-35-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-1" role="tab" aria-controls="tabset-35-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-2" role="tab" aria-controls="tabset-35-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-3" role="tab" aria-controls="tabset-35-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-35-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-35-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
   arr_delay carrier flight tailnum origin dest  air_time distance  hour minute
       &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1        11 UA        1545 N14228  EWR    IAH        227     1400     5     15
 2        20 UA        1714 N24211  LGA    IAH        227     1416     5     29
 3        33 AA        1141 N619AA  JFK    MIA        160     1089     5     40
 4       -18 B6         725 N804JB  JFK    BQN        183     1576     5     45
 5       -25 DL         461 N668DN  LGA    ATL        116      762     6      0
 6        12 UA        1696 N39463  EWR    ORD        150      719     5     58
 7        19 B6         507 N516JB  EWR    FLL        158     1065     6      0
 8       -14 EV        5708 N829AS  LGA    IAD         53      229     6      0
 9        -8 B6          79 N593JB  JFK    MCO        140      944     6      0
10         8 AA         301 N3ALAA  LGA    ORD        138      733     6      0
   time_hour          
   &lt;dttm&gt;             
 1 2013-01-01 05:00:00
 2 2013-01-01 05:00:00
 3 2013-01-01 05:00:00
 4 2013-01-01 05:00:00
 5 2013-01-01 06:00:00
 6 2013-01-01 05:00:00
 7 2013-01-01 06:00:00
 8 2013-01-01 06:00:00
 9 2013-01-01 06:00:00
10 2013-01-01 06:00:00
# … with 336,766 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-35-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-35-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>flights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
0       2013      1    1     517.0             515        2.0     830.0   
1       2013      1    1     533.0             529        4.0     850.0   
2       2013      1    1     542.0             540        2.0     923.0   
3       2013      1    1     544.0             545       -1.0    1004.0   
4       2013      1    1     554.0             600       -6.0     812.0   
...      ...    ...  ...       ...             ...        ...       ...   
336771  2013      9   30       NaN            1455        NaN       NaN   
336772  2013      9   30       NaN            2200        NaN       NaN   
336773  2013      9   30       NaN            1210        NaN       NaN   
336774  2013      9   30       NaN            1159        NaN       NaN   
336775  2013      9   30       NaN             840        NaN       NaN   

        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \
0                  819       11.0      UA    1545  N14228    EWR  IAH   
1                  830       20.0      UA    1714  N24211    LGA  IAH   
2                  850       33.0      AA    1141  N619AA    JFK  MIA   
3                 1022      -18.0      B6     725  N804JB    JFK  BQN   
4                  837      -25.0      DL     461  N668DN    LGA  ATL   
...                ...        ...     ...     ...     ...    ...  ...   
336771            1634        NaN      9E    3393     NaN    JFK  DCA   
336772            2312        NaN      9E    3525     NaN    LGA  SYR   
336773            1330        NaN      MQ    3461  N535MQ    LGA  BNA   
336774            1344        NaN      MQ    3572  N511MQ    LGA  CLE   
336775            1020        NaN      MQ    3531  N839MQ    LGA  RDU   

        air_time  distance  hour  minute                 time_hour  
0          227.0      1400     5      15 2013-01-01 10:00:00+00:00  
1          227.0      1416     5      29 2013-01-01 10:00:00+00:00  
2          160.0      1089     5      40 2013-01-01 10:00:00+00:00  
3          183.0      1576     5      45 2013-01-01 10:00:00+00:00  
4          116.0       762     6       0 2013-01-01 11:00:00+00:00  
...          ...       ...   ...     ...                       ...  
336771       NaN       213    14      55 2013-09-30 18:00:00+00:00  
336772       NaN       198    22       0 2013-10-01 02:00:00+00:00  
336773       NaN       764    12      10 2013-09-30 16:00:00+00:00  
336774       NaN       419    11      59 2013-09-30 15:00:00+00:00  
336775       NaN       431     8      40 2013-09-30 12:00:00+00:00  

[336776 rows x 19 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-35-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-35-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>flights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×19 DataFrame
    Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time   ⋯
        │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?     ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      1      1       517             515        2.0       830   ⋯
      2 │  2013      1      1       533             529        4.0       850
      3 │  2013      1      1       542             540        2.0       923
      4 │  2013      1      1       544             545       -1.0      1004
      5 │  2013      1      1       554             600       -6.0       812   ⋯
      6 │  2013      1      1       554             558       -4.0       740
      7 │  2013      1      1       555             600       -5.0       913
      8 │  2013      1      1       557             600       -3.0       709
   ⋮    │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮       ⋱
 336770 │  2013      9     30      2349            2359      -10.0       325   ⋯
 336771 │  2013      9     30   missing            1842  missing     missing
 336772 │  2013      9     30   missing            1455  missing     missing
 336773 │  2013      9     30   missing            2200  missing     missing
 336774 │  2013      9     30   missing            1210  missing     missing   ⋯
 336775 │  2013      9     30   missing            1159  missing     missing
 336776 │  2013      9     30   missing             840  missing     missing
                                              12 columns and 336761 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>airlines:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-36-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-1" role="tab" aria-controls="tabset-36-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-2" role="tab" aria-controls="tabset-36-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-3" role="tab" aria-controls="tabset-36-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-36-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-36-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>airlines</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 2
   carrier name                       
   &lt;chr&gt;   &lt;chr&gt;                      
 1 9E      Endeavor Air Inc.          
 2 AA      American Airlines Inc.     
 3 AS      Alaska Airlines Inc.       
 4 B6      JetBlue Airways            
 5 DL      Delta Air Lines Inc.       
 6 EV      ExpressJet Airlines Inc.   
 7 F9      Frontier Airlines Inc.     
 8 FL      AirTran Airways Corporation
 9 HA      Hawaiian Airlines Inc.     
10 MQ      Envoy Air                  
11 OO      SkyWest Airlines Inc.      
12 UA      United Air Lines Inc.      
13 US      US Airways Inc.            
14 VX      Virgin America             
15 WN      Southwest Airlines Co.     
16 YV      Mesa Airlines Inc.         </code></pre>
</div>
</div>
</div>
<div id="tabset-36-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-36-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nycflights13 <span class="im">import</span> airlines</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>airlines</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   carrier                         name
0       9E            Endeavor Air Inc.
1       AA       American Airlines Inc.
2       AS         Alaska Airlines Inc.
3       B6              JetBlue Airways
4       DL         Delta Air Lines Inc.
5       EV     ExpressJet Airlines Inc.
6       F9       Frontier Airlines Inc.
7       FL  AirTran Airways Corporation
8       HA       Hawaiian Airlines Inc.
9       MQ                    Envoy Air
10      OO        SkyWest Airlines Inc.
11      UA        United Air Lines Inc.
12      US              US Airways Inc.
13      VX               Virgin America
14      WN       Southwest Airlines Co.
15      YV           Mesa Airlines Inc.</code></pre>
</div>
</div>
</div>
<div id="tabset-36-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-36-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>airlines <span class="op">=</span> <span class="fu">rcopy</span>(R<span class="st">"airlines"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>16×2 DataFrame
 Row │ carrier  name
     │ String   String
─────┼──────────────────────────────────────
   1 │ 9E       Endeavor Air Inc.
   2 │ AA       American Airlines Inc.
   3 │ AS       Alaska Airlines Inc.
   4 │ B6       JetBlue Airways
   5 │ DL       Delta Air Lines Inc.
   6 │ EV       ExpressJet Airlines Inc.
   7 │ F9       Frontier Airlines Inc.
   8 │ FL       AirTran Airways Corporation
   9 │ HA       Hawaiian Airlines Inc.
  10 │ MQ       Envoy Air
  11 │ OO       SkyWest Airlines Inc.
  12 │ UA       United Air Lines Inc.
  13 │ US       US Airways Inc.
  14 │ VX       Virgin America
  15 │ WN       Southwest Airlines Co.
  16 │ YV       Mesa Airlines Inc.</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>airports:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-37-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-1" role="tab" aria-controls="tabset-37-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-37-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-2" role="tab" aria-controls="tabset-37-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-37-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-3" role="tab" aria-controls="tabset-37-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-37-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-37-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>airports</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,458 × 8
   faa   name                             lat    lon   alt    tz dst   tzone    
   &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    
 1 04G   Lansdowne Airport               41.1  -80.6  1044    -5 A     America/…
 2 06A   Moton Field Municipal Airport   32.5  -85.7   264    -6 A     America/…
 3 06C   Schaumburg Regional             42.0  -88.1   801    -6 A     America/…
 4 06N   Randall Airport                 41.4  -74.4   523    -5 A     America/…
 5 09J   Jekyll Island Airport           31.1  -81.4    11    -5 A     America/…
 6 0A9   Elizabethton Municipal Airport  36.4  -82.2  1593    -5 A     America/…
 7 0G6   Williams County Airport         41.5  -84.5   730    -5 A     America/…
 8 0G7   Finger Lakes Regional Airport   42.9  -76.8   492    -5 A     America/…
 9 0P2   Shoestring Aviation Airfield    39.8  -76.6  1000    -5 U     America/…
10 0S9   Jefferson County Intl           48.1 -123.    108    -8 A     America/…
# … with 1,448 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-37-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-37-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nycflights13 <span class="im">import</span> airports</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>airports</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      faa                           name        lat         lon   alt  tz dst  \
0     04G              Lansdowne Airport  41.130472  -80.619583  1044  -5   A   
1     06A  Moton Field Municipal Airport  32.460572  -85.680028   264  -6   A   
2     06C            Schaumburg Regional  41.989341  -88.101243   801  -6   A   
3     06N                Randall Airport  41.431912  -74.391561   523  -5   A   
4     09J          Jekyll Island Airport  31.074472  -81.427778    11  -5   A   
...   ...                            ...        ...         ...   ...  ..  ..   
1453  ZUN                     Black Rock  35.083228 -108.791778  6454  -7   A   
1454  ZVE         New Haven Rail Station  41.298669  -72.925992     7  -5   A   
1455  ZWI      Wilmington Amtrak Station  39.736667  -75.551667     0  -5   A   
1456  ZWU       Washington Union Station  38.897460  -77.006430    76  -5   A   
1457  ZYP                   Penn Station  40.750500  -73.993500    35  -5   A   

                 tzone  
0     America/New_York  
1      America/Chicago  
2      America/Chicago  
3     America/New_York  
4     America/New_York  
...                ...  
1453    America/Denver  
1454  America/New_York  
1455  America/New_York  
1456  America/New_York  
1457  America/New_York  

[1458 rows x 8 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-37-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-37-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>airports <span class="op">=</span> <span class="fu">rcopy</span>(R<span class="st">"airports"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1458×8 DataFrame
  Row │ faa     name                            lat      lon        alt      t ⋯
      │ String  String                          Float64  Float64    Float64  F ⋯
──────┼─────────────────────────────────────────────────────────────────────────
    1 │ 04G     Lansdowne Airport               41.1305   -80.6196   1044.0    ⋯
    2 │ 06A     Moton Field Municipal Airport   32.4606   -85.68      264.0
    3 │ 06C     Schaumburg Regional             41.9893   -88.1012    801.0
    4 │ 06N     Randall Airport                 41.4319   -74.3916    523.0
    5 │ 09J     Jekyll Island Airport           31.0745   -81.4278     11.0    ⋯
    6 │ 0A9     Elizabethton Municipal Airport  36.3712   -82.1734   1593.0
    7 │ 0G6     Williams County Airport         41.4673   -84.5068    730.0
    8 │ 0G7     Finger Lakes Regional Airport   42.8836   -76.7812    492.0
  ⋮   │   ⋮                   ⋮                    ⋮         ⋮         ⋮       ⋱
 1452 │ ZTF     Stamford Amtrak Station         41.0469   -73.5415      0.0    ⋯
 1453 │ ZTY     Boston Back Bay Station         42.3478   -71.075      20.0
 1454 │ ZUN     Black Rock                      35.0832  -108.792    6454.0
 1455 │ ZVE     New Haven Rail Station          41.2987   -72.926       7.0
 1456 │ ZWI     Wilmington Amtrak Station       39.7367   -75.5517      0.0    ⋯
 1457 │ ZWU     Washington Union Station        38.8975   -77.0064     76.0
 1458 │ ZYP     Penn Station                    40.7505   -73.9935     35.0
                                                 3 columns and 1443 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>planes:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-38-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-1" role="tab" aria-controls="tabset-38-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-38-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-2" role="tab" aria-controls="tabset-38-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-38-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-3" role="tab" aria-controls="tabset-38-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-38-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-38-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>planes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,322 × 9
   tailnum  year type                   manuf…¹ model engines seats speed engine
   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;                  &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
 1 N10156   2004 Fixed wing multi engi… EMBRAER EMB-…       2    55    NA Turbo…
 2 N102UW   1998 Fixed wing multi engi… AIRBUS… A320…       2   182    NA Turbo…
 3 N103US   1999 Fixed wing multi engi… AIRBUS… A320…       2   182    NA Turbo…
 4 N104UW   1999 Fixed wing multi engi… AIRBUS… A320…       2   182    NA Turbo…
 5 N10575   2002 Fixed wing multi engi… EMBRAER EMB-…       2    55    NA Turbo…
 6 N105UW   1999 Fixed wing multi engi… AIRBUS… A320…       2   182    NA Turbo…
 7 N107US   1999 Fixed wing multi engi… AIRBUS… A320…       2   182    NA Turbo…
 8 N108UW   1999 Fixed wing multi engi… AIRBUS… A320…       2   182    NA Turbo…
 9 N109UW   1999 Fixed wing multi engi… AIRBUS… A320…       2   182    NA Turbo…
10 N110UW   1999 Fixed wing multi engi… AIRBUS… A320…       2   182    NA Turbo…
# … with 3,312 more rows, and abbreviated variable name ¹​manufacturer</code></pre>
</div>
</div>
</div>
<div id="tabset-38-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-38-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nycflights13 <span class="im">import</span> planes</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>planes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     tailnum    year                     type                   manufacturer  \
0     N10156  2004.0  Fixed wing multi engine                        EMBRAER   
1     N102UW  1998.0  Fixed wing multi engine               AIRBUS INDUSTRIE   
2     N103US  1999.0  Fixed wing multi engine               AIRBUS INDUSTRIE   
3     N104UW  1999.0  Fixed wing multi engine               AIRBUS INDUSTRIE   
4     N10575  2002.0  Fixed wing multi engine                        EMBRAER   
...      ...     ...                      ...                            ...   
3317  N997AT  2002.0  Fixed wing multi engine                         BOEING   
3318  N997DL  1992.0  Fixed wing multi engine  MCDONNELL DOUGLAS AIRCRAFT CO   
3319  N998AT  2002.0  Fixed wing multi engine                         BOEING   
3320  N998DL  1992.0  Fixed wing multi engine  MCDONNELL DOUGLAS CORPORATION   
3321  N999DN  1992.0  Fixed wing multi engine  MCDONNELL DOUGLAS CORPORATION   

          model  engines  seats  speed     engine  
0     EMB-145XR        2     55    NaN  Turbo-fan  
1      A320-214        2    182    NaN  Turbo-fan  
2      A320-214        2    182    NaN  Turbo-fan  
3      A320-214        2    182    NaN  Turbo-fan  
4     EMB-145LR        2     55    NaN  Turbo-fan  
...         ...      ...    ...    ...        ...  
3317    717-200        2    100    NaN  Turbo-fan  
3318      MD-88        2    142    NaN  Turbo-fan  
3319    717-200        2    100    NaN  Turbo-fan  
3320      MD-88        2    142    NaN  Turbo-jet  
3321      MD-88        2    142    NaN  Turbo-jet  

[3322 rows x 9 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-38-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-38-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>planes <span class="op">=</span> <span class="fu">rcopy</span>(R<span class="st">"planes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3322×9 DataFrame
  Row │ tailnum  year    type                     manufacturer                 ⋯
      │ String   Int64?  String                   String                       ⋯
──────┼─────────────────────────────────────────────────────────────────────────
    1 │ N10156     2004  Fixed wing multi engine  EMBRAER                      ⋯
    2 │ N102UW     1998  Fixed wing multi engine  AIRBUS INDUSTRIE
    3 │ N103US     1999  Fixed wing multi engine  AIRBUS INDUSTRIE
    4 │ N104UW     1999  Fixed wing multi engine  AIRBUS INDUSTRIE
    5 │ N10575     2002  Fixed wing multi engine  EMBRAER                      ⋯
    6 │ N105UW     1999  Fixed wing multi engine  AIRBUS INDUSTRIE
    7 │ N107US     1999  Fixed wing multi engine  AIRBUS INDUSTRIE
    8 │ N108UW     1999  Fixed wing multi engine  AIRBUS INDUSTRIE
  ⋮   │    ⋮       ⋮                ⋮                           ⋮              ⋱
 3316 │ N996AT     2002  Fixed wing multi engine  BOEING                       ⋯
 3317 │ N996DL     1991  Fixed wing multi engine  MCDONNELL DOUGLAS AIRCRAFT C
 3318 │ N997AT     2002  Fixed wing multi engine  BOEING
 3319 │ N997DL     1992  Fixed wing multi engine  MCDONNELL DOUGLAS AIRCRAFT C
 3320 │ N998AT     2002  Fixed wing multi engine  BOEING                       ⋯
 3321 │ N998DL     1992  Fixed wing multi engine  MCDONNELL DOUGLAS CORPORATIO
 3322 │ N999DN     1992  Fixed wing multi engine  MCDONNELL DOUGLAS CORPORATIO
                                                 6 columns and 3307 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Weather:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-39-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-1" role="tab" aria-controls="tabset-39-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-2" role="tab" aria-controls="tabset-39-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-3" role="tab" aria-controls="tabset-39-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-39-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-39-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>weather <span class="sc">%&gt;%</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 26,115 × 15
   origin  year month   day  hour  temp  dewp humid wind_dir wind_speed
   &lt;chr&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
 1 EWR     2013     1     1     1  39.0  26.1  59.4      270      10.4 
 2 EWR     2013     1     1     2  39.0  27.0  61.6      250       8.06
 3 EWR     2013     1     1     3  39.0  28.0  64.4      240      11.5 
 4 EWR     2013     1     1     4  39.9  28.0  62.2      250      12.7 
 5 EWR     2013     1     1     5  39.0  28.0  64.4      260      12.7 
 6 EWR     2013     1     1     6  37.9  28.0  67.2      240      11.5 
 7 EWR     2013     1     1     7  39.0  28.0  64.4      240      15.0 
 8 EWR     2013     1     1     8  39.9  28.0  62.2      250      10.4 
 9 EWR     2013     1     1     9  39.9  28.0  62.2      260      15.0 
10 EWR     2013     1     1    10  41    28.0  59.6      260      13.8 
   wind_gust precip pressure visib time_hour          
       &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dttm&gt;             
 1        NA      0    1012     10 2013-01-01 01:00:00
 2        NA      0    1012.    10 2013-01-01 02:00:00
 3        NA      0    1012.    10 2013-01-01 03:00:00
 4        NA      0    1012.    10 2013-01-01 04:00:00
 5        NA      0    1012.    10 2013-01-01 05:00:00
 6        NA      0    1012.    10 2013-01-01 06:00:00
 7        NA      0    1012.    10 2013-01-01 07:00:00
 8        NA      0    1012.    10 2013-01-01 08:00:00
 9        NA      0    1013.    10 2013-01-01 09:00:00
10        NA      0    1012.    10 2013-01-01 10:00:00
# … with 26,105 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-39-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nycflights13 <span class="im">import</span> weather</span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>weather</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      origin  year  month  day  hour   temp   dewp  humid  wind_dir  \
0        EWR  2013      1    1     1  39.02  26.06  59.37     270.0   
1        EWR  2013      1    1     2  39.02  26.96  61.63     250.0   
2        EWR  2013      1    1     3  39.02  28.04  64.43     240.0   
3        EWR  2013      1    1     4  39.92  28.04  62.21     250.0   
4        EWR  2013      1    1     5  39.02  28.04  64.43     260.0   
...      ...   ...    ...  ...   ...    ...    ...    ...       ...   
26110    LGA  2013     12   30    14  35.96  19.94  51.78     340.0   
26111    LGA  2013     12   30    15  33.98  17.06  49.51     330.0   
26112    LGA  2013     12   30    16  32.00  15.08  49.19     340.0   
26113    LGA  2013     12   30    17  30.92  12.92  46.74     320.0   
26114    LGA  2013     12   30    18  28.94  10.94  46.41     330.0   

       wind_speed  wind_gust  precip  pressure  visib             time_hour  
0        10.35702        NaN     0.0    1012.0   10.0  2013-01-01T06:00:00Z  
1         8.05546        NaN     0.0    1012.3   10.0  2013-01-01T07:00:00Z  
2        11.50780        NaN     0.0    1012.5   10.0  2013-01-01T08:00:00Z  
3        12.65858        NaN     0.0    1012.2   10.0  2013-01-01T09:00:00Z  
4        12.65858        NaN     0.0    1011.9   10.0  2013-01-01T10:00:00Z  
...           ...        ...     ...       ...    ...                   ...  
26110    13.80936   21.86482     0.0    1017.1   10.0  2013-12-30T19:00:00Z  
26111    17.26170   21.86482     0.0    1018.8   10.0  2013-12-30T20:00:00Z  
26112    14.96014   23.01560     0.0    1019.5   10.0  2013-12-30T21:00:00Z  
26113    17.26170        NaN     0.0    1019.9   10.0  2013-12-30T22:00:00Z  
26114    18.41248        NaN     0.0    1020.9   10.0  2013-12-30T23:00:00Z  

[26115 rows x 15 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-39-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>weather <span class="op">=</span> <span class="fu">rcopy</span>(R<span class="st">"weather"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>26115×15 DataFrame
   Row │ origin  year   month  day    hour   temp      dewp      humid     win ⋯
       │ String  Int64  Int64  Int64  Int64  Float64?  Float64?  Float64?  Flo ⋯
───────┼────────────────────────────────────────────────────────────────────────
     1 │ EWR      2013      1      1      1     39.02     26.06     59.37      ⋯
     2 │ EWR      2013      1      1      2     39.02     26.96     61.63
     3 │ EWR      2013      1      1      3     39.02     28.04     64.43
     4 │ EWR      2013      1      1      4     39.92     28.04     62.21
     5 │ EWR      2013      1      1      5     39.02     28.04     64.43      ⋯
     6 │ EWR      2013      1      1      6     37.94     28.04     67.21
     7 │ EWR      2013      1      1      7     39.02     28.04     64.43
     8 │ EWR      2013      1      1      8     39.92     28.04     62.21
   ⋮   │   ⋮       ⋮      ⋮      ⋮      ⋮       ⋮         ⋮         ⋮          ⋱
 26109 │ LGA      2013     12     30     12     37.94     23.0      54.51      ⋯
 26110 │ LGA      2013     12     30     13     37.04     21.92     53.97
 26111 │ LGA      2013     12     30     14     35.96     19.94     51.78
 26112 │ LGA      2013     12     30     15     33.98     17.06     49.51
 26113 │ LGA      2013     12     30     16     32.0      15.08     49.19      ⋯
 26114 │ LGA      2013     12     30     17     30.92     12.92     46.74
 26115 │ LGA      2013     12     30     18     28.94     10.94     46.41
                                                7 columns and 26100 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="relational-data" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="relational-data"><span class="header-section-number">8</span> Relational data</h2>
<p align="center">
<img src="./relational-nycflights.png" height="375">
</p>
<p>For the MIMIC-III data, the relation structure can be explored at <a href="https://mit-lcp.github.io/mimic-schema-spy/relationships.html" class="uri">https://mit-lcp.github.io/mimic-schema-spy/relationships.html</a>.</p>
<section id="keys" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="keys"><span class="header-section-number">8.1</span> Keys</h3>
<ul>
<li><p>A <strong>primary key</strong> uniquely identifies an observation in its own table.</p></li>
<li><p>A <strong>foreign key</strong> uniquely identifies an observation in another table.</p></li>
</ul>
</section>
</section>
<section id="combine-variables-columns" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="combine-variables-columns"><span class="header-section-number">9</span> Combine variables (columns)</h2>
<section id="demo-tables" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="demo-tables"><span class="header-section-number">9.1</span> Demo tables</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-40-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-1" role="tab" aria-controls="tabset-40-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-2" role="tab" aria-controls="tabset-40-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-3" role="tab" aria-controls="tabset-40-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-40-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-40-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>(x <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>key, <span class="sc">~</span>val_x,</span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="st">"x1"</span>,</span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>, <span class="st">"x2"</span>,</span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span>, <span class="st">"x3"</span></span>
<span id="cb302-6"><a href="#cb302-6" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
    key val_x
  &lt;dbl&gt; &lt;chr&gt;
1     1 x1   
2     2 x2   
3     3 x3   </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>(y <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>key, <span class="sc">~</span>val_y,</span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="st">"y1"</span>,</span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>, <span class="st">"y2"</span>,</span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">4</span>, <span class="st">"y3"</span></span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
    key val_y
  &lt;dbl&gt; &lt;chr&gt;
1     1 y1   
2     2 y2   
3     4 y3   </code></pre>
</div>
</div>
</div>
<div id="tabset-40-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> pd.DataFrame({</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'key'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>],</span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'val_x'</span>: [<span class="st">'x1'</span>, <span class="st">'x2'</span>, <span class="st">'x3'</span>]</span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   key val_x
0    1    x1
1    2    x2
2    4    x3</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> pd.DataFrame({</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'key'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'val_y'</span>: [<span class="st">'y1'</span>, <span class="st">'y2'</span>, <span class="st">'y3'</span>]</span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   key val_x
0    1    x1
1    2    x2
2    4    x3</code></pre>
</div>
</div>
</div>
<div id="tabset-40-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>  key <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>  val_x <span class="op">=</span> [<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>]</span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3×2 DataFrame
 Row │ key    val_x
     │ Int64  String
─────┼───────────────
   1 │     1  x1
   2 │     2  x2
   3 │     3  x3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>  key <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>],</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a>  val_y <span class="op">=</span> [<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>]</span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3×2 DataFrame
 Row │ key    val_y
     │ Int64  String
─────┼───────────────
   1 │     1  y1
   2 │     2  y2
   3 │     4  y3</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="inner-join" class="level3" data-number="9.2">
<h3 data-number="9.2" class="anchored" data-anchor-id="inner-join"><span class="header-section-number">9.2</span> Inner join</h3>
<ul>
<li>An <strong>inner join</strong> matches pairs of observations whenever their keys are equal:</li>
</ul>
<p align="center">
<img src="./join-inner.png" height="150">
</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-41-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-1" role="tab" aria-controls="tabset-41-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-41-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-2" role="tab" aria-controls="tabset-41-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-41-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-3" role="tab" aria-controls="tabset-41-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-41-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-41-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inner_join</span>(x, y, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   </code></pre>
</div>
</div>
<p>Same as</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(y, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-41-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-41-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>x.join(y.set_index(<span class="st">'key'</span>), on <span class="op">=</span> <span class="st">'key'</span>, how <span class="op">=</span> <span class="st">'inner'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   key val_x val_y
0    1    x1    y1
1    2    x2    y2</code></pre>
</div>
</div>
</div>
<div id="tabset-41-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-41-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">innerjoin</span>(x, y, on <span class="op">=</span> <span class="op">:</span>key)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2×3 DataFrame
 Row │ key    val_x   val_y
     │ Int64  String  String
─────┼───────────────────────
   1 │     1  x1      y1
   2 │     2  x2      y2</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="outer-join" class="level3" data-number="9.3">
<h3 data-number="9.3" class="anchored" data-anchor-id="outer-join"><span class="header-section-number">9.3</span> Outer join</h3>
<ul>
<li><p>An <strong>outer join</strong> keeps observations that appear in at least one of the tables.</p></li>
<li><p>Three types of outer joins:</p>
<ul>
<li>A <strong>left join</strong> keeps all observations in <code>x</code>.</li>
</ul></li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-42-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-1" role="tab" aria-controls="tabset-42-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-42-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-2" role="tab" aria-controls="tabset-42-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-42-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-3" role="tab" aria-controls="tabset-42-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-42-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-42-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(x, y, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>
</div>
</div>
</div>
<div id="tabset-42-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-42-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>x.join(y.set_index(<span class="st">'key'</span>), on <span class="op">=</span> <span class="st">'key'</span>, how <span class="op">=</span> <span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   key val_x val_y
0    1    x1    y1
1    2    x2    y2
2    4    x3   NaN</code></pre>
</div>
</div>
</div>
<div id="tabset-42-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-42-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leftjoin</span>(x, y, on <span class="op">=</span> <span class="op">:</span>key)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3×3 DataFrame
 Row │ key    val_x   val_y
     │ Int64  String  String?
─────┼────────────────────────
   1 │     1  x1      y1
   2 │     2  x2      y2
   3 │     3  x3      missing</code></pre>
</div>
</div>
</div>
</div>
</div>
<pre><code>- A **right join** keeps all observations in `y`.</code></pre>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-43-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-1" role="tab" aria-controls="tabset-43-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-43-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-2" role="tab" aria-controls="tabset-43-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-43-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-3" role="tab" aria-controls="tabset-43-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-43-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-43-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">right_join</span>(x, y, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div>
<div id="tabset-43-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-43-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>x.join(y.set_index(<span class="st">'key'</span>), on <span class="op">=</span> <span class="st">'key'</span>, how <span class="op">=</span> <span class="st">'right'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     key val_x val_y
0.0    1    x1    y1
1.0    2    x2    y2
NaN    3   NaN    y3</code></pre>
</div>
</div>
</div>
<div id="tabset-43-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-43-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rightjoin</span>(x, y, on <span class="op">=</span> <span class="op">:</span>key)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3×3 DataFrame
 Row │ key    val_x    val_y
     │ Int64  String?  String
─────┼────────────────────────
   1 │     1  x1       y1
   2 │     2  x2       y2
   3 │     4  missing  y3</code></pre>
</div>
</div>
</div>
</div>
</div>
<pre><code>- A **full join** keeps all observations in `x` or `y`.</code></pre>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-44-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-1" role="tab" aria-controls="tabset-44-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-44-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-2" role="tab" aria-controls="tabset-44-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-44-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-3" role="tab" aria-controls="tabset-44-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-44-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-44-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">full_join</span>(x, y, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; 
4     4 &lt;NA&gt;  y3   </code></pre>
</div>
</div>
</div>
<div id="tabset-44-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-44-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>x.join(y.set_index(<span class="st">'key'</span>), on <span class="op">=</span> <span class="st">'key'</span>, how <span class="op">=</span> <span class="st">'outer'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     key val_x val_y
0.0    1    x1    y1
1.0    2    x2    y2
2.0    4    x3   NaN
NaN    3   NaN    y3</code></pre>
</div>
</div>
</div>
<div id="tabset-44-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-44-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">outerjoin</span>(x, y, on <span class="op">=</span> <span class="op">:</span>key)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4×3 DataFrame
 Row │ key    val_x    val_y
     │ Int64  String?  String?
─────┼─────────────────────────
   1 │     1  x1       y1
   2 │     2  x2       y2
   3 │     3  x3       missing
   4 │     4  missing  y3</code></pre>
</div>
</div>
</div>
</div>
</div>
<p align="center">
<img src="./join-outer.png" height="275">
</p>
</section>
<section id="duplicate-keys" class="level3" data-number="9.4">
<h3 data-number="9.4" class="anchored" data-anchor-id="duplicate-keys"><span class="header-section-number">9.4</span> Duplicate keys</h3>
<ul>
<li><p>One table has duplicate keys.</p>
<p align="center">
</p><p><img src="./join-one-to-many.png" height="200"></p>
<p></p></li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-45-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-1" role="tab" aria-controls="tabset-45-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-45-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-2" role="tab" aria-controls="tabset-45-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-45-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-3" role="tab" aria-controls="tabset-45-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-45-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-45-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>key, <span class="sc">~</span>val_x,</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="st">"x1"</span>,</span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>, <span class="st">"x2"</span>,</span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>, <span class="st">"x3"</span>,</span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="st">"x4"</span></span>
<span id="cb341-7"><a href="#cb341-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb341-8"><a href="#cb341-8" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
    key val_x
  &lt;dbl&gt; &lt;chr&gt;
1     1 x1   
2     2 x2   
3     2 x3   
4     1 x4   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>key, <span class="sc">~</span>val_y,</span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="st">"y1"</span>,</span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>, <span class="st">"y2"</span></span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb343-6"><a href="#cb343-6" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
    key val_y
  &lt;dbl&gt; &lt;chr&gt;
1     1 y1   
2     2 y2   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(x, y, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     2 x3    y2   
4     1 x4    y1   </code></pre>
</div>
</div>
</div>
<div id="tabset-45-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-45-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> pd.DataFrame({</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'key'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>],</span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'val_x'</span>: [<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>]</span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   key val_x
0    1    x1
1    2    x2
2    2    x3
3    1    x4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> pd.DataFrame({</span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'key'</span>: [<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'val_y'</span>: [<span class="st">"y1"</span>, <span class="st">"y2"</span>]</span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   key val_y
0    1    y1
1    2    y2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a>x.join(y.set_index(<span class="st">'key'</span>), on <span class="op">=</span> <span class="st">'key'</span>, how <span class="op">=</span> <span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   key val_x val_y
0    1    x1    y1
1    2    x2    y2
2    2    x3    y2
3    1    x4    y1</code></pre>
</div>
</div>
</div>
<div id="tabset-45-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-45-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a>  key <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>],</span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a>  val_x <span class="op">=</span> [<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>]</span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4×2 DataFrame
 Row │ key    val_x
     │ Int64  String
─────┼───────────────
   1 │     1  x1
   2 │     2  x2
   3 │     2  x3
   4 │     1  x4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>  key <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">2</span>],</span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>  val_y <span class="op">=</span> [<span class="st">"y1"</span>, <span class="st">"y2"</span>]</span>
<span id="cb355-4"><a href="#cb355-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2×2 DataFrame
 Row │ key    val_y
     │ Int64  String
─────┼───────────────
   1 │     1  y1
   2 │     2  y2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leftjoin</span>(x, y, on <span class="op">=</span> <span class="op">:</span>key)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4×3 DataFrame
 Row │ key    val_x   val_y
     │ Int64  String  String?
─────┼────────────────────────
   1 │     1  x1      y1
   2 │     2  x2      y2
   3 │     2  x3      y2
   4 │     1  x4      y1</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li><p>Both tables have duplicate keys. You get all possible combinations, the Cartesian product:</p>
<p align="center">
</p><p><img src="./join-many-to-many.png" height="250"></p>
<p></p></li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-46-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-1" role="tab" aria-controls="tabset-46-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-46-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-2" role="tab" aria-controls="tabset-46-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-46-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-3" role="tab" aria-controls="tabset-46-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-46-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-46-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>key, <span class="sc">~</span>val_x,</span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="st">"x1"</span>,</span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>, <span class="st">"x2"</span>,</span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>, <span class="st">"x3"</span>,</span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span>, <span class="st">"x4"</span></span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb359-9"><a href="#cb359-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>key, <span class="sc">~</span>val_y,</span>
<span id="cb359-10"><a href="#cb359-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="st">"y1"</span>,</span>
<span id="cb359-11"><a href="#cb359-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>, <span class="st">"y2"</span>,</span>
<span id="cb359-12"><a href="#cb359-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>, <span class="st">"y3"</span>,</span>
<span id="cb359-13"><a href="#cb359-13" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span>, <span class="st">"y4"</span></span>
<span id="cb359-14"><a href="#cb359-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb359-15"><a href="#cb359-15" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(x, y, <span class="at">by =</span> <span class="st">"key"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     2 x2    y3   
4     2 x3    y2   
5     2 x3    y3   
6     3 x4    y4   </code></pre>
</div>
</div>
</div>
<div id="tabset-46-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-46-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> pd.DataFrame({</span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'key'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'val_x'</span>: [<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>]</span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   key val_x
0    1    x1
1    2    x2
2    2    x3
3    3    x4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> pd.DataFrame({</span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'key'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'val_y'</span>: [<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>]</span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   key val_y
0    1    y1
1    2    y2
2    2    y3
3    3    y4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>x.join(y.set_index(<span class="st">'key'</span>), on <span class="op">=</span> <span class="st">'key'</span>, how <span class="op">=</span> <span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   key val_x val_y
0    1    x1    y1
1    2    x2    y2
1    2    x2    y3
2    2    x3    y2
2    2    x3    y3
3    3    x4    y4</code></pre>
</div>
</div>
</div>
<div id="tabset-46-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-46-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>  key <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>],</span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>  val_x <span class="op">=</span> [<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>]</span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4×2 DataFrame
 Row │ key    val_x
     │ Int64  String
─────┼───────────────
   1 │     1  x1
   2 │     2  x2
   3 │     2  x3
   4 │     3  x4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>  key <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>],</span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a>  val_y <span class="op">=</span> [<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>]</span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4×2 DataFrame
 Row │ key    val_y
     │ Int64  String
─────┼───────────────
   1 │     1  y1
   2 │     2  y2
   3 │     2  y3
   4 │     3  y4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leftjoin</span>(x, y, on <span class="op">=</span> <span class="op">:</span>key)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6×3 DataFrame
 Row │ key    val_x   val_y
     │ Int64  String  String?
─────┼────────────────────────
   1 │     1  x1      y1
   2 │     2  x2      y2
   3 │     2  x3      y2
   4 │     2  x2      y3
   5 │     2  x3      y3
   6 │     3  x4      y4</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Let’s create a narrower table from the flights data:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-47-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-1" role="tab" aria-controls="tabset-47-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-47-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-2" role="tab" aria-controls="tabset-47-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-47-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-3" role="tab" aria-controls="tabset-47-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-47-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-47-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year<span class="sc">:</span>day, hour, origin, dest, tailnum, carrier) <span class="sc">%&gt;%</span></span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 8
    year month   day  hour origin dest  tailnum carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  
 1  2013     1     1     5 EWR    IAH   N14228  UA     
 2  2013     1     1     5 LGA    IAH   N24211  UA     
 3  2013     1     1     5 JFK    MIA   N619AA  AA     
 4  2013     1     1     5 JFK    BQN   N804JB  B6     
 5  2013     1     1     6 LGA    ATL   N668DN  DL     
 6  2013     1     1     5 EWR    ORD   N39463  UA     
 7  2013     1     1     6 EWR    FLL   N516JB  B6     
 8  2013     1     1     6 LGA    IAD   N829AS  EV     
 9  2013     1     1     6 JFK    MCO   N593JB  B6     
10  2013     1     1     6 LGA    ORD   N3ALAA  AA     
# … with 336,766 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-47-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-47-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="op">=</span> flights[[<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>, <span class="st">'hour'</span>, <span class="st">'origin'</span>, <span class="st">'dest'</span>, <span class="st">'tailnum'</span>, <span class="st">'carrier'</span>]]</span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>flights2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  hour origin dest tailnum carrier
0       2013      1    1     5    EWR  IAH  N14228      UA
1       2013      1    1     5    LGA  IAH  N24211      UA
2       2013      1    1     5    JFK  MIA  N619AA      AA
3       2013      1    1     5    JFK  BQN  N804JB      B6
4       2013      1    1     6    LGA  ATL  N668DN      DL
...      ...    ...  ...   ...    ...  ...     ...     ...
336771  2013      9   30    14    JFK  DCA     NaN      9E
336772  2013      9   30    22    LGA  SYR     NaN      9E
336773  2013      9   30    12    LGA  BNA  N535MQ      MQ
336774  2013      9   30    11    LGA  CLE  N511MQ      MQ
336775  2013      9   30     8    LGA  RDU  N839MQ      MQ

[336776 rows x 8 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-47-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-47-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="op">=</span> <span class="fu">select</span>(</span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a>  flights, </span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Between</span>(<span class="op">:</span>year, <span class="op">:</span>day), </span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">:</span>hour, </span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">:</span>origin, </span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">:</span>dest, </span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">:</span>tailnum, </span>
<span id="cb377-8"><a href="#cb377-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">:</span>carrier</span>
<span id="cb377-9"><a href="#cb377-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×8 DataFrame
    Row │ year   month  day    hour     origin  dest    tailnum  carrier
        │ Int64  Int64  Int64  Float64  String  String  String?  String
────────┼────────────────────────────────────────────────────────────────
      1 │  2013      1      1      5.0  EWR     IAH     N14228   UA
      2 │  2013      1      1      5.0  LGA     IAH     N24211   UA
      3 │  2013      1      1      5.0  JFK     MIA     N619AA   AA
      4 │  2013      1      1      5.0  JFK     BQN     N804JB   B6
      5 │  2013      1      1      6.0  LGA     ATL     N668DN   DL
      6 │  2013      1      1      5.0  EWR     ORD     N39463   UA
      7 │  2013      1      1      6.0  EWR     FLL     N516JB   B6
      8 │  2013      1      1      6.0  LGA     IAD     N829AS   EV
   ⋮    │   ⋮      ⋮      ⋮       ⋮       ⋮       ⋮        ⋮        ⋮
 336770 │  2013      9     30     23.0  JFK     PSE     N516JB   B6
 336771 │  2013      9     30     18.0  LGA     BNA     N740EV   EV
 336772 │  2013      9     30     14.0  JFK     DCA     missing  9E
 336773 │  2013      9     30     22.0  LGA     SYR     missing  9E
 336774 │  2013      9     30     12.0  LGA     BNA     N535MQ   MQ
 336775 │  2013      9     30     11.0  LGA     CLE     N511MQ   MQ
 336776 │  2013      9     30      8.0  LGA     RDU     N839MQ   MQ
                                                      336761 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>We want to merge with the <code>weather</code> table:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-48-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-1" role="tab" aria-controls="tabset-48-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-48-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-2" role="tab" aria-controls="tabset-48-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-48-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-3" role="tab" aria-controls="tabset-48-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-48-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-48-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a>weather</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 26,115 × 15
   origin  year month   day  hour  temp  dewp humid wind_dir wind_speed wind_g…¹
   &lt;chr&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;
 1 EWR     2013     1     1     1  39.0  26.1  59.4      270      10.4        NA
 2 EWR     2013     1     1     2  39.0  27.0  61.6      250       8.06       NA
 3 EWR     2013     1     1     3  39.0  28.0  64.4      240      11.5        NA
 4 EWR     2013     1     1     4  39.9  28.0  62.2      250      12.7        NA
 5 EWR     2013     1     1     5  39.0  28.0  64.4      260      12.7        NA
 6 EWR     2013     1     1     6  37.9  28.0  67.2      240      11.5        NA
 7 EWR     2013     1     1     7  39.0  28.0  64.4      240      15.0        NA
 8 EWR     2013     1     1     8  39.9  28.0  62.2      250      10.4        NA
 9 EWR     2013     1     1     9  39.9  28.0  62.2      260      15.0        NA
10 EWR     2013     1     1    10  41    28.0  59.6      260      13.8        NA
# … with 26,105 more rows, 4 more variables: precip &lt;dbl&gt;, pressure &lt;dbl&gt;,
#   visib &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable name ¹​wind_gust</code></pre>
</div>
</div>
</div>
<div id="tabset-48-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-48-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>weather</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      origin  year  month  day  hour   temp   dewp  humid  wind_dir  \
0        EWR  2013      1    1     1  39.02  26.06  59.37     270.0   
1        EWR  2013      1    1     2  39.02  26.96  61.63     250.0   
2        EWR  2013      1    1     3  39.02  28.04  64.43     240.0   
3        EWR  2013      1    1     4  39.92  28.04  62.21     250.0   
4        EWR  2013      1    1     5  39.02  28.04  64.43     260.0   
...      ...   ...    ...  ...   ...    ...    ...    ...       ...   
26110    LGA  2013     12   30    14  35.96  19.94  51.78     340.0   
26111    LGA  2013     12   30    15  33.98  17.06  49.51     330.0   
26112    LGA  2013     12   30    16  32.00  15.08  49.19     340.0   
26113    LGA  2013     12   30    17  30.92  12.92  46.74     320.0   
26114    LGA  2013     12   30    18  28.94  10.94  46.41     330.0   

       wind_speed  wind_gust  precip  pressure  visib             time_hour  
0        10.35702        NaN     0.0    1012.0   10.0  2013-01-01T06:00:00Z  
1         8.05546        NaN     0.0    1012.3   10.0  2013-01-01T07:00:00Z  
2        11.50780        NaN     0.0    1012.5   10.0  2013-01-01T08:00:00Z  
3        12.65858        NaN     0.0    1012.2   10.0  2013-01-01T09:00:00Z  
4        12.65858        NaN     0.0    1011.9   10.0  2013-01-01T10:00:00Z  
...           ...        ...     ...       ...    ...                   ...  
26110    13.80936   21.86482     0.0    1017.1   10.0  2013-12-30T19:00:00Z  
26111    17.26170   21.86482     0.0    1018.8   10.0  2013-12-30T20:00:00Z  
26112    14.96014   23.01560     0.0    1019.5   10.0  2013-12-30T21:00:00Z  
26113    17.26170        NaN     0.0    1019.9   10.0  2013-12-30T22:00:00Z  
26114    18.41248        NaN     0.0    1020.9   10.0  2013-12-30T23:00:00Z  

[26115 rows x 15 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-48-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-48-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>weather</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>26115×15 DataFrame
   Row │ origin  year   month  day    hour   temp      dewp      humid     win ⋯
       │ String  Int64  Int64  Int64  Int64  Float64?  Float64?  Float64?  Flo ⋯
───────┼────────────────────────────────────────────────────────────────────────
     1 │ EWR      2013      1      1      1     39.02     26.06     59.37      ⋯
     2 │ EWR      2013      1      1      2     39.02     26.96     61.63
     3 │ EWR      2013      1      1      3     39.02     28.04     64.43
     4 │ EWR      2013      1      1      4     39.92     28.04     62.21
     5 │ EWR      2013      1      1      5     39.02     28.04     64.43      ⋯
     6 │ EWR      2013      1      1      6     37.94     28.04     67.21
     7 │ EWR      2013      1      1      7     39.02     28.04     64.43
     8 │ EWR      2013      1      1      8     39.92     28.04     62.21
   ⋮   │   ⋮       ⋮      ⋮      ⋮      ⋮       ⋮         ⋮         ⋮          ⋱
 26109 │ LGA      2013     12     30     12     37.94     23.0      54.51      ⋯
 26110 │ LGA      2013     12     30     13     37.04     21.92     53.97
 26111 │ LGA      2013     12     30     14     35.96     19.94     51.78
 26112 │ LGA      2013     12     30     15     33.98     17.06     49.51
 26113 │ LGA      2013     12     30     16     32.0      15.08     49.19      ⋯
 26114 │ LGA      2013     12     30     17     30.92     12.92     46.74
 26115 │ LGA      2013     12     30     18     28.94     10.94     46.41
                                                7 columns and 26100 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="defining-the-key-columns" class="level3" data-number="9.5">
<h3 data-number="9.5" class="anchored" data-anchor-id="defining-the-key-columns"><span class="header-section-number">9.5</span> Defining the key columns</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-49-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-1" role="tab" aria-controls="tabset-49-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-49-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-2" role="tab" aria-controls="tabset-49-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-49-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-3" role="tab" aria-controls="tabset-49-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-49-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-49-1-tab">
<ul>
<li><code>by = NULL</code> (default): use all variables that appear in both tables:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same as: flights2 %&gt;% left_join(weather)</span></span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(flights2, weather)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 18
    year month   day  hour origin dest  tailnum carrier  temp  dewp humid
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  2013     1     1     5 EWR    IAH   N14228  UA       39.0  28.0  64.4
 2  2013     1     1     5 LGA    IAH   N24211  UA       39.9  25.0  54.8
 3  2013     1     1     5 JFK    MIA   N619AA  AA       39.0  27.0  61.6
 4  2013     1     1     5 JFK    BQN   N804JB  B6       39.0  27.0  61.6
 5  2013     1     1     6 LGA    ATL   N668DN  DL       39.9  25.0  54.8
 6  2013     1     1     5 EWR    ORD   N39463  UA       39.0  28.0  64.4
 7  2013     1     1     6 EWR    FLL   N516JB  B6       37.9  28.0  67.2
 8  2013     1     1     6 LGA    IAD   N829AS  EV       39.9  25.0  54.8
 9  2013     1     1     6 JFK    MCO   N593JB  B6       37.9  27.0  64.3
10  2013     1     1     6 LGA    ORD   N3ALAA  AA       39.9  25.0  54.8
# … with 336,766 more rows, and 7 more variables: wind_dir &lt;dbl&gt;,
#   wind_speed &lt;dbl&gt;, wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;, pressure &lt;dbl&gt;,
#   visib &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
<ul>
<li><code>by = "x"</code>: use the common variable <code>x</code>:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same as: flights2 %&gt;% left_join(weather)</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(flights2, planes, <span class="at">by =</span> <span class="st">"tailnum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 16
   year.x month   day  hour origin dest  tailnum carrier year.y type     manuf…¹
    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;  
 1   2013     1     1     5 EWR    IAH   N14228  UA        1999 Fixed w… BOEING 
 2   2013     1     1     5 LGA    IAH   N24211  UA        1998 Fixed w… BOEING 
 3   2013     1     1     5 JFK    MIA   N619AA  AA        1990 Fixed w… BOEING 
 4   2013     1     1     5 JFK    BQN   N804JB  B6        2012 Fixed w… AIRBUS 
 5   2013     1     1     6 LGA    ATL   N668DN  DL        1991 Fixed w… BOEING 
 6   2013     1     1     5 EWR    ORD   N39463  UA        2012 Fixed w… BOEING 
 7   2013     1     1     6 EWR    FLL   N516JB  B6        2000 Fixed w… AIRBUS…
 8   2013     1     1     6 LGA    IAD   N829AS  EV        1998 Fixed w… CANADA…
 9   2013     1     1     6 JFK    MCO   N593JB  B6        2004 Fixed w… AIRBUS 
10   2013     1     1     6 LGA    ORD   N3ALAA  AA          NA &lt;NA&gt;     &lt;NA&gt;   
# … with 336,766 more rows, 5 more variables: model &lt;chr&gt;, engines &lt;int&gt;,
#   seats &lt;int&gt;, speed &lt;int&gt;, engine &lt;chr&gt;, and abbreviated variable name
#   ¹​manufacturer</code></pre>
</div>
</div>
<ul>
<li><code>by = c("a" = "b")</code>: match variable <code>a</code> in table <code>x</code> to the variable <code>b</code> in table <code>y</code>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same as: flights2 %&gt;% left_join(weather)</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(flights2, airports, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"dest"</span> <span class="ot">=</span> <span class="st">"faa"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 15
    year month   day  hour origin dest  tailnum carrier name     lat   lon   alt
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  2013     1     1     5 EWR    IAH   N14228  UA      Georg…  30.0 -95.3    97
 2  2013     1     1     5 LGA    IAH   N24211  UA      Georg…  30.0 -95.3    97
 3  2013     1     1     5 JFK    MIA   N619AA  AA      Miami…  25.8 -80.3     8
 4  2013     1     1     5 JFK    BQN   N804JB  B6      &lt;NA&gt;    NA    NA      NA
 5  2013     1     1     6 LGA    ATL   N668DN  DL      Harts…  33.6 -84.4  1026
 6  2013     1     1     5 EWR    ORD   N39463  UA      Chica…  42.0 -87.9   668
 7  2013     1     1     6 EWR    FLL   N516JB  B6      Fort …  26.1 -80.2     9
 8  2013     1     1     6 LGA    IAD   N829AS  EV      Washi…  38.9 -77.5   313
 9  2013     1     1     6 JFK    MCO   N593JB  B6      Orlan…  28.4 -81.3    96
10  2013     1     1     6 LGA    ORD   N3ALAA  AA      Chica…  42.0 -87.9   668
# … with 336,766 more rows, and 3 more variables: tz &lt;dbl&gt;, dst &lt;chr&gt;,
#   tzone &lt;chr&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-49-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-49-2-tab">
<ul>
<li>Match multiple keys using multi-index:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a>keys <span class="op">=</span> [<span class="st">'origin'</span>, <span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>, <span class="st">'hour'</span>]</span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a>flights2.join(</span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a>  weather.set_index(keys),</span>
<span id="cb391-4"><a href="#cb391-4" aria-hidden="true" tabindex="-1"></a>  on <span class="op">=</span> keys,</span>
<span id="cb391-5"><a href="#cb391-5" aria-hidden="true" tabindex="-1"></a>  how <span class="op">=</span> <span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  hour origin dest tailnum carrier   temp   dewp  \
0       2013      1    1     5    EWR  IAH  N14228      UA  39.02  28.04   
1       2013      1    1     5    LGA  IAH  N24211      UA  39.92  24.98   
2       2013      1    1     5    JFK  MIA  N619AA      AA  39.02  26.96   
3       2013      1    1     5    JFK  BQN  N804JB      B6  39.02  26.96   
4       2013      1    1     6    LGA  ATL  N668DN      DL  39.92  24.98   
...      ...    ...  ...   ...    ...  ...     ...     ...    ...    ...   
336771  2013      9   30    14    JFK  DCA     NaN      9E  68.00  55.04   
336772  2013      9   30    22    LGA  SYR     NaN      9E  64.94  53.06   
336773  2013      9   30    12    LGA  BNA  N535MQ      MQ  69.08  48.02   
336774  2013      9   30    11    LGA  CLE  N511MQ      MQ  66.92  48.92   
336775  2013      9   30     8    LGA  RDU  N839MQ      MQ  60.98  51.08   

        humid  wind_dir  wind_speed  wind_gust  precip  pressure  visib  \
0       64.43     260.0    12.65858        NaN     0.0    1011.9   10.0   
1       54.81     250.0    14.96014   21.86482     0.0    1011.4   10.0   
2       61.63     260.0    14.96014        NaN     0.0    1012.1   10.0   
3       61.63     260.0    14.96014        NaN     0.0    1012.1   10.0   
4       54.81     260.0    16.11092   23.01560     0.0    1011.7   10.0   
...       ...       ...         ...        ...     ...       ...    ...   
336771  63.21     190.0    11.50780        NaN     0.0    1016.6   10.0   
336772  65.37     200.0     6.90468        NaN     0.0    1015.8   10.0   
336773  46.99      70.0     5.75390        NaN     0.0    1016.7   10.0   
336774  52.35      70.0     8.05546        NaN     0.0    1017.5   10.0   
336775  69.86       NaN     5.75390        NaN     0.0    1018.6   10.0   

                   time_hour  
0       2013-01-01T10:00:00Z  
1       2013-01-01T10:00:00Z  
2       2013-01-01T10:00:00Z  
3       2013-01-01T10:00:00Z  
4       2013-01-01T11:00:00Z  
...                      ...  
336771  2013-09-30T18:00:00Z  
336772  2013-10-01T02:00:00Z  
336773  2013-09-30T16:00:00Z  
336774  2013-09-30T15:00:00Z  
336775  2013-09-30T12:00:00Z  

[336776 rows x 18 columns]</code></pre>
</div>
</div>
<ul>
<li>Match the common variable <code>tailnum</code>:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a>flights2.join(</span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a>  planes.set_index(<span class="st">'tailnum'</span>), </span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a>  on <span class="op">=</span> <span class="st">'tailnum'</span>, </span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true" tabindex="-1"></a>  how <span class="op">=</span> <span class="st">'left'</span>,</span>
<span id="cb393-5"><a href="#cb393-5" aria-hidden="true" tabindex="-1"></a>  lsuffix <span class="op">=</span> <span class="st">'_x'</span>,</span>
<span id="cb393-6"><a href="#cb393-6" aria-hidden="true" tabindex="-1"></a>  rsuffix <span class="op">=</span> <span class="st">'_y'</span></span>
<span id="cb393-7"><a href="#cb393-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year_x  month  day  hour origin dest tailnum carrier  year_y  \
0         2013      1    1     5    EWR  IAH  N14228      UA  1999.0   
1         2013      1    1     5    LGA  IAH  N24211      UA  1998.0   
2         2013      1    1     5    JFK  MIA  N619AA      AA  1990.0   
3         2013      1    1     5    JFK  BQN  N804JB      B6  2012.0   
4         2013      1    1     6    LGA  ATL  N668DN      DL  1991.0   
...        ...    ...  ...   ...    ...  ...     ...     ...     ...   
336771    2013      9   30    14    JFK  DCA     NaN      9E     NaN   
336772    2013      9   30    22    LGA  SYR     NaN      9E     NaN   
336773    2013      9   30    12    LGA  BNA  N535MQ      MQ     NaN   
336774    2013      9   30    11    LGA  CLE  N511MQ      MQ     NaN   
336775    2013      9   30     8    LGA  RDU  N839MQ      MQ     NaN   

                           type manufacturer     model  engines  seats  speed  \
0       Fixed wing multi engine       BOEING   737-824      2.0  149.0    NaN   
1       Fixed wing multi engine       BOEING   737-824      2.0  149.0    NaN   
2       Fixed wing multi engine       BOEING   757-223      2.0  178.0    NaN   
3       Fixed wing multi engine       AIRBUS  A320-232      2.0  200.0    NaN   
4       Fixed wing multi engine       BOEING   757-232      2.0  178.0    NaN   
...                         ...          ...       ...      ...    ...    ...   
336771                      NaN          NaN       NaN      NaN    NaN    NaN   
336772                      NaN          NaN       NaN      NaN    NaN    NaN   
336773                      NaN          NaN       NaN      NaN    NaN    NaN   
336774                      NaN          NaN       NaN      NaN    NaN    NaN   
336775                      NaN          NaN       NaN      NaN    NaN    NaN   

           engine  
0       Turbo-fan  
1       Turbo-fan  
2       Turbo-fan  
3       Turbo-fan  
4       Turbo-fan  
...           ...  
336771        NaN  
336772        NaN  
336773        NaN  
336774        NaN  
336775        NaN  

[336776 rows x 16 columns]</code></pre>
</div>
</div>
<ul>
<li>Match variable <code>a</code> in table <code>x</code> to the variable <code>b</code> in table <code>y</code>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>flights2.set_index(</span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'dest'</span></span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a>  ).join(</span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a>    airports.set_index(<span class="st">'faa'</span>), </span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true" tabindex="-1"></a>    how <span class="op">=</span> <span class="st">'left'</span></span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     year  month  day  hour origin tailnum carrier  \
ABQ  2013     10    1    20    JFK  N554JB      B6   
ABQ  2013     10    2    20    JFK  N607JB      B6   
ABQ  2013     10    3    20    JFK  N591JB      B6   
ABQ  2013     10    4    20    JFK  N662JB      B6   
ABQ  2013     10    5    19    JFK  N580JB      B6   
..    ...    ...  ...   ...    ...     ...     ...   
XNA  2013      9   29    17    LGA  N725MQ      MQ   
XNA  2013      9   30     7    LGA  N735MQ      MQ   
XNA  2013      9   30     8    EWR  N14117      EV   
XNA  2013      9   30    15    LGA  N725MQ      MQ   
XNA  2013      9   30    17    LGA  N720MQ      MQ   

                                  name        lat         lon     alt   tz  \
ABQ  Albuquerque International Sunport  35.040222 -106.609194  5355.0 -7.0   
ABQ  Albuquerque International Sunport  35.040222 -106.609194  5355.0 -7.0   
ABQ  Albuquerque International Sunport  35.040222 -106.609194  5355.0 -7.0   
ABQ  Albuquerque International Sunport  35.040222 -106.609194  5355.0 -7.0   
ABQ  Albuquerque International Sunport  35.040222 -106.609194  5355.0 -7.0   
..                                 ...        ...         ...     ...  ...   
XNA               NW Arkansas Regional  36.281869  -94.306811  1287.0 -6.0   
XNA               NW Arkansas Regional  36.281869  -94.306811  1287.0 -6.0   
XNA               NW Arkansas Regional  36.281869  -94.306811  1287.0 -6.0   
XNA               NW Arkansas Regional  36.281869  -94.306811  1287.0 -6.0   
XNA               NW Arkansas Regional  36.281869  -94.306811  1287.0 -6.0   

    dst            tzone  
ABQ   A   America/Denver  
ABQ   A   America/Denver  
ABQ   A   America/Denver  
ABQ   A   America/Denver  
ABQ   A   America/Denver  
..   ..              ...  
XNA   A  America/Chicago  
XNA   A  America/Chicago  
XNA   A  America/Chicago  
XNA   A  America/Chicago  
XNA   A  America/Chicago  

[336776 rows x 14 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-49-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-49-3-tab">
<ul>
<li>Match multiple variables:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leftjoin</span>(</span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a>  flights2, </span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a>  weather, </span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a>  on <span class="op">=</span> [<span class="op">:</span>year, <span class="op">:</span>month, <span class="op">:</span>day, <span class="op">:</span>hour, <span class="op">:</span>origin]</span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×18 DataFrame
    Row │ year   month  day    hour     origin  dest    tailnum  carrier  temp ⋯
        │ Int64  Int64  Int64  Float64  String  String  String?  String   Floa ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      1      1      5.0  EWR     IAH     N14228   UA            ⋯
      2 │  2013      1      1      5.0  LGA     IAH     N24211   UA
      3 │  2013      1      1      5.0  JFK     MIA     N619AA   AA
      4 │  2013      1      1      5.0  JFK     BQN     N804JB   B6
      5 │  2013      1      1      6.0  LGA     ATL     N668DN   DL            ⋯
      6 │  2013      1      1      5.0  EWR     ORD     N39463   UA
      7 │  2013      1      1      6.0  EWR     FLL     N516JB   B6
      8 │  2013      1      1      6.0  LGA     IAD     N829AS   EV
   ⋮    │   ⋮      ⋮      ⋮       ⋮       ⋮       ⋮        ⋮        ⋮          ⋱
 336770 │  2013      9      2     16.0  EWR     CVG     N14573   EV       miss ⋯
 336771 │  2013      9      2     16.0  EWR     SAV     N11547   EV       miss
 336772 │  2013      9      2     16.0  EWR     ROC     N11548   EV       miss
 336773 │  2013      9      2     16.0  EWR     GSO     N13978   EV       miss
 336774 │  2013      9      2     16.0  EWR     ATL     N13202   EV       miss ⋯
 336775 │  2013      9      2     16.0  EWR     CVG     missing  9E       miss
 336776 │  2013      9      2     16.0  EWR     PHX     missing  US       miss
                                              10 columns and 336761 rows omitted</code></pre>
</div>
</div>
<ul>
<li>Match the common variable <code>tailnum</code>:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leftjoin</span>(</span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a>  flights2, </span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a>  planes, </span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a>  on <span class="op">=</span> <span class="op">:</span>tailnum,</span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true" tabindex="-1"></a>  makeunique <span class="op">=</span> <span class="cn">true</span>,</span>
<span id="cb399-6"><a href="#cb399-6" aria-hidden="true" tabindex="-1"></a>  matchmissing <span class="op">=</span> <span class="op">:</span>notequal</span>
<span id="cb399-7"><a href="#cb399-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×16 DataFrame
    Row │ year   month  day    hour     origin  dest    tailnum  carrier  year ⋯
        │ Int64  Int64  Int64  Float64  String  String  String?  String   Int6 ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      1      1      5.0  EWR     IAH     N14228   UA          1 ⋯
      2 │  2013      1      1      5.0  LGA     IAH     N24211   UA          1
      3 │  2013      1      1      5.0  JFK     MIA     N619AA   AA          1
      4 │  2013      1      1      5.0  JFK     BQN     N804JB   B6          2
      5 │  2013      1      1      6.0  LGA     ATL     N668DN   DL          1 ⋯
      6 │  2013      1      1      5.0  EWR     ORD     N39463   UA          2
      7 │  2013      1      1      6.0  EWR     FLL     N516JB   B6          2
      8 │  2013      1      1      6.0  LGA     IAD     N829AS   EV          1
   ⋮    │   ⋮      ⋮      ⋮       ⋮       ⋮       ⋮        ⋮        ⋮        ⋮ ⋱
 336770 │  2013      9     30     21.0  JFK     DCA     N807MQ   MQ       miss ⋯
 336771 │  2013      9     30     21.0  LGA     BNA     N532MQ   MQ       miss
 336772 │  2013      9     30     14.0  JFK     DCA     missing  9E       miss
 336773 │  2013      9     30     22.0  LGA     SYR     missing  9E       miss
 336774 │  2013      9     30     12.0  LGA     BNA     N535MQ   MQ       miss ⋯
 336775 │  2013      9     30     11.0  LGA     CLE     N511MQ   MQ       miss
 336776 │  2013      9     30      8.0  LGA     RDU     N839MQ   MQ       miss
                                               8 columns and 336761 rows omitted</code></pre>
</div>
</div>
<ul>
<li>Match variable <code>a</code> in table <code>x</code> to the variable <code>b</code> in table <code>y</code>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leftjoin</span>(</span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a>  flights2,</span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a>  airports,</span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true" tabindex="-1"></a>  on <span class="op">=</span> <span class="op">:</span>dest <span class="op">=&gt;</span> <span class="op">:</span>faa</span>
<span id="cb401-5"><a href="#cb401-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>336776×15 DataFrame
    Row │ year   month  day    hour     origin  dest    tailnum  carrier  name ⋯
        │ Int64  Int64  Int64  Float64  String  String  String?  String   Stri ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      1      1      5.0  EWR     IAH     N14228   UA       Geor ⋯
      2 │  2013      1      1      5.0  LGA     IAH     N24211   UA       Geor
      3 │  2013      1      1      5.0  JFK     MIA     N619AA   AA       Miam
      4 │  2013      1      1      6.0  LGA     ATL     N668DN   DL       Hart
      5 │  2013      1      1      5.0  EWR     ORD     N39463   UA       Chic ⋯
      6 │  2013      1      1      6.0  EWR     FLL     N516JB   B6       Fort
      7 │  2013      1      1      6.0  LGA     IAD     N829AS   EV       Wash
      8 │  2013      1      1      6.0  JFK     MCO     N593JB   B6       Orla
   ⋮    │   ⋮      ⋮      ⋮       ⋮       ⋮       ⋮        ⋮        ⋮          ⋱
 336770 │  2013      9     30      8.0  JFK     SJU     N3772H   DL       miss ⋯
 336771 │  2013      9     30     14.0  JFK     SJU     N652JB   B6       miss
 336772 │  2013      9     30     15.0  JFK     SJU     N5FTAA   AA       miss
 336773 │  2013      9     30     15.0  JFK     SJU     N3756    DL       miss
 336774 │  2013      9     30     20.0  JFK     SJU     N396DA   DL       miss ⋯
 336775 │  2013      9     30     21.0  JFK     SJU     N633JB   B6       miss
 336776 │  2013      9     30     23.0  JFK     PSE     N516JB   B6       miss
                                               7 columns and 336761 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="combine-cases-rows" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="combine-cases-rows"><span class="header-section-number">10</span> Combine cases (rows)</h2>
<ul>
<li>Top 10 most popular destinations:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-50-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-50-1" role="tab" aria-controls="tabset-50-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-50-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-50-2" role="tab" aria-controls="tabset-50-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-50-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-50-3" role="tab" aria-controls="tabset-50-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-50-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-50-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>top_dest <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(dest, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb403-4"><a href="#cb403-4" aria-hidden="true" tabindex="-1"></a>top_dest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   dest      n
   &lt;chr&gt; &lt;int&gt;
 1 ORD   17283
 2 ATL   17215
 3 LAX   16174
 4 BOS   15508
 5 MCO   14082
 6 CLT   14064
 7 SFO   13331
 8 FLL   12055
 9 MIA   11728
10 DCA    9705</code></pre>
</div>
</div>
</div>
<div id="tabset-50-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-50-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>top_dest <span class="op">=</span> flights.groupby(<span class="st">'dest'</span>)[<span class="st">'dest'</span>].count(</span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a>  ).to_frame(</span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> <span class="st">'n'</span></span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true" tabindex="-1"></a>    ).reset_index(</span>
<span id="cb405-5"><a href="#cb405-5" aria-hidden="true" tabindex="-1"></a>      ).sort_values(</span>
<span id="cb405-6"><a href="#cb405-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'n'</span>, </span>
<span id="cb405-7"><a href="#cb405-7" aria-hidden="true" tabindex="-1"></a>        ascending <span class="op">=</span> <span class="va">False</span></span>
<span id="cb405-8"><a href="#cb405-8" aria-hidden="true" tabindex="-1"></a>        ).head(<span class="dv">10</span>)</span>
<span id="cb405-9"><a href="#cb405-9" aria-hidden="true" tabindex="-1"></a>top_dest      </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dest      n
69  ORD  17283
4   ATL  17215
49  LAX  16174
11  BOS  15508
54  MCO  14082
23  CLT  14064
90  SFO  13331
35  FLL  12055
58  MIA  11728
28  DCA   9705</code></pre>
</div>
</div>
</div>
<div id="tabset-50-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-50-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a>top_dest <span class="op">=</span> <span class="pp">@pipe</span> flights <span class="op">|&gt;</span> </span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(_, <span class="op">:</span>dest) <span class="op">|&gt;</span></span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(_, nrow) <span class="op">|&gt;</span></span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(_, <span class="op">:</span>nrow, rev <span class="op">=</span> <span class="cn">true</span>) <span class="op">|&gt;</span></span>
<span id="cb407-5"><a href="#cb407-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">first</span>(_, <span class="fl">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10×2 DataFrame
 Row │ dest    nrow
     │ String  Int64
─────┼───────────────
   1 │ ORD     17283
   2 │ ATL     17215
   3 │ LAX     16174
   4 │ BOS     15508
   5 │ MCO     14082
   6 │ CLT     14064
   7 │ SFO     13331
   8 │ FLL     12055
   9 │ MIA     11728
  10 │ DCA      9705</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>How to filter the cases that fly to these destinations?</li>
</ul>
<section id="semi-join" class="level3" data-number="10.1">
<h3 data-number="10.1" class="anchored" data-anchor-id="semi-join"><span class="header-section-number">10.1</span> Semi-join</h3>
<ul>
<li><p><code>semi_join(x, y)</code> keeps the rows in <code>x</code> that have a match in <code>y</code>.</p>
<p align="center">
</p><p><img src="./join-semi.png" height="200"></p>
<p></p></li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-51-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-51-1" role="tab" aria-controls="tabset-51-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-51-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-51-2" role="tab" aria-controls="tabset-51-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-51-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-51-3" role="tab" aria-controls="tabset-51-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-51-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-51-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semi_join</span>(flights, top_dest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 141,145 × 19
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1      542        540       2     923     850      33 AA     
 2  2013     1     1      554        600      -6     812     837     -25 DL     
 3  2013     1     1      554        558      -4     740     728      12 UA     
 4  2013     1     1      555        600      -5     913     854      19 B6     
 5  2013     1     1      557        600      -3     838     846      -8 B6     
 6  2013     1     1      558        600      -2     753     745       8 AA     
 7  2013     1     1      558        600      -2     924     917       7 UA     
 8  2013     1     1      558        600      -2     923     937     -14 UA     
 9  2013     1     1      559        559       0     702     706      -4 B6     
10  2013     1     1      600        600       0     851     858      -7 B6     
# … with 141,135 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
</div>
<div id="tabset-51-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-51-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb411"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a>flights.loc[flights[<span class="st">'dest'</span>].isin(top_dest[<span class="st">'dest'</span>])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
2       2013      1    1     542.0             540        2.0     923.0   
4       2013      1    1     554.0             600       -6.0     812.0   
5       2013      1    1     554.0             558       -4.0     740.0   
6       2013      1    1     555.0             600       -5.0     913.0   
8       2013      1    1     557.0             600       -3.0     838.0   
...      ...    ...  ...       ...             ...        ...       ...   
336755  2013      9   30    2149.0            2156       -7.0    2245.0   
336762  2013      9   30    2233.0            2113       80.0     112.0   
336763  2013      9   30    2235.0            2001      154.0      59.0   
336768  2013      9   30    2307.0            2255       12.0    2359.0   
336771  2013      9   30       NaN            1455        NaN       NaN   

        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \
2                  850       33.0      AA    1141  N619AA    JFK  MIA   
4                  837      -25.0      DL     461  N668DN    LGA  ATL   
5                  728       12.0      UA    1696  N39463    EWR  ORD   
6                  854       19.0      B6     507  N516JB    EWR  FLL   
8                  846       -8.0      B6      79  N593JB    JFK  MCO   
...                ...        ...     ...     ...     ...    ...  ...   
336755            2308      -23.0      UA     523  N813UA    EWR  BOS   
336762              30       42.0      UA     471  N578UA    EWR  SFO   
336763            2249      130.0      B6    1083  N804JB    JFK  MCO   
336768            2358        1.0      B6     718  N565JB    JFK  BOS   
336771            1634        NaN      9E    3393     NaN    JFK  DCA   

        air_time  distance  hour  minute                 time_hour  
2          160.0      1089     5      40 2013-01-01 10:00:00+00:00  
4          116.0       762     6       0 2013-01-01 11:00:00+00:00  
5          150.0       719     5      58 2013-01-01 10:00:00+00:00  
6          158.0      1065     6       0 2013-01-01 11:00:00+00:00  
8          140.0       944     6       0 2013-01-01 11:00:00+00:00  
...          ...       ...   ...     ...                       ...  
336755      37.0       200    21      56 2013-10-01 01:00:00+00:00  
336762     318.0      2565    21      13 2013-10-01 01:00:00+00:00  
336763     123.0       944    20       1 2013-10-01 00:00:00+00:00  
336768      33.0       187    22      55 2013-10-01 02:00:00+00:00  
336771       NaN       213    14      55 2013-09-30 18:00:00+00:00  

[141145 rows x 19 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-51-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-51-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semijoin</span>(flights, top_dest, on <span class="op">=</span> <span class="op">:</span>dest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>141145×19 DataFrame
    Row │ year   month  day    dep_time  sched_dep_time  dep_delay  arr_time   ⋯
        │ Int64  Int64  Int64  Int64?    Int64           Float64?   Int64?     ⋯
────────┼───────────────────────────────────────────────────────────────────────
      1 │  2013      1      1       542             540        2.0       923   ⋯
      2 │  2013      1      1       554             600       -6.0       812
      3 │  2013      1      1       554             558       -4.0       740
      4 │  2013      1      1       555             600       -5.0       913
      5 │  2013      1      1       557             600       -3.0       838   ⋯
      6 │  2013      1      1       558             600       -2.0       753
      7 │  2013      1      1       558             600       -2.0       924
      8 │  2013      1      1       558             600       -2.0       923
   ⋮    │   ⋮      ⋮      ⋮       ⋮            ⋮             ⋮         ⋮       ⋱
 141139 │  2013      9     30      2140            2140        0.0        10   ⋯
 141140 │  2013      9     30      2147            2137       10.0        30
 141141 │  2013      9     30      2149            2156       -7.0      2245
 141142 │  2013      9     30      2233            2113       80.0       112
 141143 │  2013      9     30      2235            2001      154.0        59   ⋯
 141144 │  2013      9     30      2307            2255       12.0      2359
 141145 │  2013      9     30   missing            1455  missing     missing
                                              12 columns and 141130 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="anti-join" class="level3" data-number="10.2">
<h3 data-number="10.2" class="anchored" data-anchor-id="anti-join"><span class="header-section-number">10.2</span> Anti-join</h3>
<ul>
<li><p><code>anti_join(x, y)</code> keeps the rows that don’t have a match.</p>
<p align="center">
</p><p><img src="./join-anti.png" height="200"></p>
<p></p></li>
<li><p>Useful to see what will not be joined.</p></li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-52-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-52-1" role="tab" aria-controls="tabset-52-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-52-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-52-2" role="tab" aria-controls="tabset-52-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-52-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-52-3" role="tab" aria-controls="tabset-52-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-52-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-52-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Planes that are not in planes table</span></span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(planes, <span class="at">by =</span> <span class="st">"tailnum"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb415-4"><a href="#cb415-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(tailnum, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 722 × 2
   tailnum     n
   &lt;chr&gt;   &lt;int&gt;
 1 &lt;NA&gt;     2512
 2 N725MQ    575
 3 N722MQ    513
 4 N723MQ    507
 5 N713MQ    483
 6 N735MQ    396
 7 N0EGMQ    371
 8 N534MQ    364
 9 N542MQ    363
10 N531MQ    349
# … with 712 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-52-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-52-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a>flights.loc[<span class="op">-</span>flights[<span class="st">'tailnum'</span>].isin(planes[<span class="st">'tailnum'</span>])].groupby(<span class="st">'tailnum'</span>)[<span class="st">'tailnum'</span>].count().sort_values(ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tailnum
N725MQ    575
N722MQ    513
N723MQ    507
N713MQ    483
N735MQ    396
         ... 
N7ASAA      1
N3LFAA      1
N7ALAA      1
N7AEAA      1
N5ERAA      1
Name: tailnum, Length: 721, dtype: int64</code></pre>
</div>
</div>
</div>
<div id="tabset-52-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-52-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@pipe</span> <span class="fu">antijoin</span>(</span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a>  flights, </span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true" tabindex="-1"></a>  planes, </span>
<span id="cb419-4"><a href="#cb419-4" aria-hidden="true" tabindex="-1"></a>  on <span class="op">=</span> <span class="op">:</span>tailnum, </span>
<span id="cb419-5"><a href="#cb419-5" aria-hidden="true" tabindex="-1"></a>  matchmissing <span class="op">=</span> <span class="op">:</span>notequal</span>
<span id="cb419-6"><a href="#cb419-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="op">|&gt;</span></span>
<span id="cb419-7"><a href="#cb419-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(_, <span class="op">:</span>tailnum) <span class="op">|&gt;</span></span>
<span id="cb419-8"><a href="#cb419-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(_, nrow) <span class="op">|&gt;</span></span>
<span id="cb419-9"><a href="#cb419-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(_, <span class="op">:</span>nrow, rev <span class="op">=</span> <span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>722×2 DataFrame
 Row │ tailnum  nrow
     │ String?  Int64
─────┼────────────────
   1 │ missing   2512
   2 │ N725MQ     575
   3 │ N722MQ     513
   4 │ N723MQ     507
   5 │ N713MQ     483
   6 │ N735MQ     396
   7 │ N0EGMQ     371
   8 │ N534MQ     364
  ⋮  │    ⋮       ⋮
 716 │ N502SW       1
 717 │ N451UW       1
 718 │ N7BKAA       1
 719 │ N7CAAA       1
 720 │ N5FCAA       1
 721 │ N5ERAA       1
 722 │ N647MQ       1
      707 rows omitted</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="set-operations" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="set-operations"><span class="header-section-number">11</span> Set operations</h2>
<ul>
<li>Generate two tables:</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-53-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-53-1" role="tab" aria-controls="tabset-53-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-53-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-53-2" role="tab" aria-controls="tabset-53-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-53-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-53-3" role="tab" aria-controls="tabset-53-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-53-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-53-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a>(df1 <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>x, <span class="sc">~</span>y,</span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>,  <span class="dv">1</span>,</span>
<span id="cb421-4"><a href="#cb421-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>,  <span class="dv">1</span></span>
<span id="cb421-5"><a href="#cb421-5" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
      x     y
  &lt;dbl&gt; &lt;dbl&gt;
1     1     1
2     2     1</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a>(df2 <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>x, <span class="sc">~</span>y,</span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>,  <span class="dv">1</span>,</span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>,  <span class="dv">2</span></span>
<span id="cb423-5"><a href="#cb423-5" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
      x     y
  &lt;dbl&gt; &lt;dbl&gt;
1     1     1
2     1     2</code></pre>
</div>
</div>
</div>
<div id="tabset-53-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-53-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb425"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame({</span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'x'</span>: [<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'y'</span>: [<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb425-4"><a href="#cb425-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb425-5"><a href="#cb425-5" aria-hidden="true" tabindex="-1"></a>df1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   x  y
0  1  1
1  2  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb427"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame({</span>
<span id="cb427-2"><a href="#cb427-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'x'</span>: [<span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb427-3"><a href="#cb427-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'y'</span>: [<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb427-4"><a href="#cb427-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb427-5"><a href="#cb427-5" aria-hidden="true" tabindex="-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   x  y
0  1  1
1  1  2</code></pre>
</div>
</div>
</div>
<div id="tabset-53-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-53-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb429"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb429-2"><a href="#cb429-2" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">2</span>],</span>
<span id="cb429-3"><a href="#cb429-3" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">1</span>]</span>
<span id="cb429-4"><a href="#cb429-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2×2 DataFrame
 Row │ x      y
     │ Int64  Int64
─────┼──────────────
   1 │     1      1
   2 │     2      1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb431"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> <span class="fu">DataFrame</span>(</span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">1</span>],</span>
<span id="cb431-3"><a href="#cb431-3" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">2</span>]</span>
<span id="cb431-4"><a href="#cb431-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2×2 DataFrame
 Row │ x      y
     │ Int64  Int64
─────┼──────────────
   1 │     1      1
   2 │     1      2</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li><code>bind_rows(x, y)</code> stacks table <code>x</code> one on top of <code>y</code>.</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-54-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-54-1" role="tab" aria-controls="tabset-54-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-54-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-54-2" role="tab" aria-controls="tabset-54-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-54-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-54-3" role="tab" aria-controls="tabset-54-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-54-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-54-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb433"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(df1, df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
      x     y
  &lt;dbl&gt; &lt;dbl&gt;
1     1     1
2     2     1
3     1     1
4     1     2</code></pre>
</div>
</div>
</div>
<div id="tabset-54-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-54-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb435"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a>pd.concat([df1, df2], axis <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   x  y
0  1  1
1  2  1
0  1  1
1  1  2</code></pre>
</div>
</div>
</div>
<div id="tabset-54-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-54-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb437"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vcat</span>(df1, df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4×2 DataFrame
 Row │ x      y
     │ Int64  Int64
─────┼──────────────
   1 │     1      1
   2 │     2      1
   3 │     1      1
   4 │     1      2</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li><code>intersect(x, y)</code> returns rows that appear in both <code>x</code> and <code>y</code>.</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-55-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-55-1" role="tab" aria-controls="tabset-55-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-55-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-55-2" role="tab" aria-controls="tabset-55-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-55-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-55-3" role="tab" aria-controls="tabset-55-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-55-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-55-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb439"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span>(df1, df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
      x     y
  &lt;dbl&gt; &lt;dbl&gt;
1     1     1</code></pre>
</div>
</div>
</div>
<div id="tabset-55-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-55-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb441"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a>pd.merge(df1, df2, how <span class="op">=</span> <span class="st">'inner'</span>, on <span class="op">=</span> [<span class="st">'x'</span>, <span class="st">'y'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   x  y
0  1  1</code></pre>
</div>
</div>
</div>
<div id="tabset-55-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-55-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb443"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DataFrame</span>(<span class="fu">intersect</span>(<span class="fu">eachrow</span>(df1), <span class="fu">eachrow</span>(df2)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1×2 DataFrame
 Row │ x      y
     │ Int64  Int64
─────┼──────────────
   1 │     1      1</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li><code>union(x, y)</code> returns unique observations in <code>x</code> and <code>y</code>.</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-56-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-56-1" role="tab" aria-controls="tabset-56-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-56-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-56-2" role="tab" aria-controls="tabset-56-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-56-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-56-3" role="tab" aria-controls="tabset-56-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-56-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-56-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">union</span>(df1, df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
      x     y
  &lt;dbl&gt; &lt;dbl&gt;
1     1     1
2     2     1
3     1     2</code></pre>
</div>
</div>
</div>
<div id="tabset-56-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-56-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb447"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a>pd.merge(df1, df2, how <span class="op">=</span> <span class="st">'outer'</span>, on <span class="op">=</span> [<span class="st">'x'</span>, <span class="st">'y'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   x  y
0  1  1
1  2  1
2  1  2</code></pre>
</div>
</div>
</div>
<div id="tabset-56-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-56-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DataFrame</span>(<span class="fu">union</span>(<span class="fu">eachrow</span>(df1), <span class="fu">eachrow</span>(df2)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3×2 DataFrame
 Row │ x      y
     │ Int64  Int64
─────┼──────────────
   1 │     1      1
   2 │     2      1
   3 │     1      2</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li><code>setdiff(x, y)</code> returns rows that appear in <code>x</code> but not in <code>y</code>.</li>
</ul>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-57-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-57-1" role="tab" aria-controls="tabset-57-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-57-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-57-2" role="tab" aria-controls="tabset-57-2" aria-selected="false" href="">Python (???)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-57-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-57-3" role="tab" aria-controls="tabset-57-3" aria-selected="false" href="">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-57-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-57-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb451"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(df1, df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
      x     y
  &lt;dbl&gt; &lt;dbl&gt;
1     2     1</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb453"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(df2, df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
      x     y
  &lt;dbl&gt; &lt;dbl&gt;
1     1     2</code></pre>
</div>
</div>
</div>
<div id="tabset-57-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-57-2-tab">
<p>Not sure how to do this elegantly.</p>
</div>
<div id="tabset-57-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-57-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb455"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DataFrame</span>(<span class="fu">setdiff</span>(<span class="fu">eachrow</span>(df1), <span class="fu">eachrow</span>(df2)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1×2 DataFrame
 Row │ x      y
     │ Int64  Int64
─────┼──────────────
   1 │     2      1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb457"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DataFrame</span>(<span class="fu">setdiff</span>(<span class="fu">eachrow</span>(df2), <span class="fu">eachrow</span>(df1)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1×2 DataFrame
 Row │ x      y
     │ Int64  Int64
─────┼──────────────
   1 │     1      2</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="cheat-sheet" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="cheat-sheet"><span class="header-section-number">12</span> Cheat sheet</h2>
<p><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/master/data-transformation.pdf">RStudio cheat sheet</a> is extremely helpful.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>